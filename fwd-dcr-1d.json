{"kind":"Notebook","sha256":"bb570679354f478c1b166a5910fa426ef39cbed76719a181ebf194832cdcdbbf","slug":"fwd-dcr-1d","location":"/notebooks/05-dcr/fwd_dcr_1d.ipynb","dependencies":[],"frontmatter":{"title":"1D Forward Simulation for a Single Sounding","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","affiliations":["University of British Columbia"],"id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","affiliations":["University of British Columbia"],"id":"contributors-myst-generated-uid-1"}],"license":{"content":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"github":"https://github.com/simpeg/user-tutorials","subject":"SimPEG User Tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"University of British Columbia","name":"University of British Columbia"}],"exports":[{"format":"ipynb","filename":"fwd_dcr_1d.ipynb","url":"/user-tutorials/build/fwd_dcr_1d-dc81815d35c2192b5c1dc3db7f633d4b.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"admonition","class":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Introductory notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SAGkWfdXTb"}],"key":"U8Ebn8HCKn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial teaches basic functionality within SimPEG and is a good entry point for new users.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dS9W9ooZ31"}],"key":"udAINTjTmF"}],"key":"WfTYN3vEFD"}],"key":"IX7SgTRp0b"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"admonition","class":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Light-weight notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s1aZT9vzQz"}],"key":"Jb9TuLw8cu"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZQGJnEtDn7"}],"key":"YdQcrbrBbl"}],"key":"HJPIpyLDX6"}],"key":"MlNO8mQ7zT"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ki7VZkviz9"}],"key":"P5xr8wGKNt"},{"type":"text","value":" Devin C. Cowan","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hcVh8QvS4b"}],"key":"kEqIUigzOf"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Keywords:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rKiorihIWH"}],"key":"ilo81hGvNZ"},{"type":"text","value":" DC resistivity, forward simulation, apparent resistivity, 1D sounding, wires mapping.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CXesqnbZAC"}],"key":"YRFMSHezK6"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Summary:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"X7EMP1zRcs"}],"key":"ONFx2szndR"},{"type":"text","value":" Here we use the module ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rZo6uAqUAS"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.electromagnetics.static.resistivity.html#module-simpeg.electromagnetics.static.resistivity","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"simpeg​.electromagnetics​.static​.resistivity","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TtZ2cxblU6"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.static.resistivity","internal":false,"protocol":"xref:sphinx","key":"aXHE654UT3"},{"type":"text","value":" to simulate 1D apparent resistivity data for a 1D Wenner array. The ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sb2O6q85HX"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.static.resistivity.Simulation1DLayers.html#simpeg.electromagnetics.static.resistivity.Simulation1DLayers","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Simulation1DLayers","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"V7qLLb4xNy"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.static.resistivity.simulation_1d.Simulation1DLayers","internal":false,"protocol":"xref:sphinx","key":"N6BbbnIb3n"},{"type":"text","value":" class is used to solve the problem via a semi-analytic Hankel transform solution.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"a5m6P2ujP7"}],"key":"NoDYuXzued"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Learning Objectives:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZruzXmIrUX"}],"key":"LdcYCZhgbz"}],"key":"BornDYrqze"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Introduce the fundamentals of simulating DC resistivity data with SimPEG.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Z2n2fxHnJU"}],"key":"PgYTDqAW7u"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Introduce the basics of defining DC resistivity surveys in SimPEG.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Brtw5JIpSJ"}],"key":"BhvQZQHRzc"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Demonstrate various approaches for defining a 1D layered Earth model.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Eqa7r5Oah2"}],"key":"O85pnsB1oD"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Demonstrate how the Earth’s electrical properties can be defined according to conductivity OR resistivity.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Bs7YBLuWFD"}],"key":"BV0Na8QVk8"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"How to simulate the data as normalize voltages OR apparent resistivities.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"hlexJNszAx"}],"key":"uoTmq3y8yz"}],"key":"zCDWNgytg3"}],"key":"sOlvcV8NFO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Modules","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RGAyNDKaU2"}],"identifier":"import-modules","label":"Import Modules","html_id":"import-modules","implicit":true,"key":"S7Z99C1CaF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here, we import all of the functionality required to run the notebook for the tutorial exercise. All of the functionality specific to DC resistivity is imported from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EoMEghunQO"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.electromagnetics.static.resistivity.html#module-simpeg.electromagnetics.static.resistivity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simpeg​.electromagnetics​.static​.resistivity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X0WLrA5Wle"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.static.resistivity","internal":false,"protocol":"xref:sphinx","key":"pX4Xh942aL"},{"type":"text","value":".\nWe also import some useful utility functions from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FoJdbIU0Lt"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.utils.html#module-simpeg.utils","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simpeg.utils","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wEZ4uKNw00"}],"urlSource":"myst:simpeg#simpeg.utils","internal":false,"protocol":"xref:sphinx","key":"poZB38vCt1"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wCReBbyGki"}],"key":"Yfl64VJJvY"}],"key":"YaS4gvyieK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:27.150925Z","iopub.status.busy":"2024-07-17T17:49:27.150423Z","iopub.status.idle":"2024-07-17T17:49:29.256284Z","shell.execute_reply":"2024-07-17T17:49:29.255176Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# SimPEG functionality\nfrom simpeg.electromagnetics.static import resistivity as dc\nfrom simpeg import maps\nfrom simpeg.utils import plot_1d_layer_model\n\n# Common Python functionality\nimport os\nimport numpy as np\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\n\nmpl.rcParams.update({\"font.size\": 16})\n\nwrite_output = False","key":"Kv0VFGHl1O"},{"type":"output","id":"3WmdyeHnjzV4FdAybrMYj","data":[],"key":"KAYiBC0Hes"}],"key":"kr8CIkRb3b"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Survey","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bGfKww2g5a"}],"identifier":"define-the-survey","label":"Define the Survey","html_id":"define-the-survey","implicit":true,"key":"ZBZc0NtRr0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"DC resistivity surveys within SimPEG require the user to create and connect three types of objects:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fFpZdTRNMT"}],"key":"WLnOvUGM4G"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.static.resistivity.receivers.BaseRx.html#simpeg.electromagnetics.static.resistivity.receivers.baserx","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"receivers","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"C0PulMT4nK"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.static.resistivity.receivers.BaseRx","internal":false,"protocol":"xref:sphinx","key":"d7LaNuKvpQ"},{"type":"text","value":": which defines the locations of the potential (or MN) electrodes and the type of data; e.g. ‘volt’ for normalized voltage in V/A or ‘apparent_resistivity’ for apparent resistivity in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KHzfG7VlIW"},{"type":"inlineMath","value":"\\Omega m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Ω</mi><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">\\Omega m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Ω</span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"qEMAlQNJ04"},{"type":"text","value":". ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"esnc6Kk5PE"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note only M electrode locations are needed to define pole receivers","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BGgHU5vn03"}],"key":"qr3E14wJgI"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uYlhJlqNIZ"}],"key":"ggzvZOv6Q4"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.static.resistivity.sources.BaseSrc.html#simpeg.electromagnetics.static.resistivity.sources.basesrc","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sources","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"R1RNmeDXwk"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.static.resistivity.sources.BaseSrc","internal":false,"protocol":"xref:sphinx","key":"HblWfcuced"},{"type":"text","value":": which defines the locations of the current (or AB) electrodes, and their associated receivers. ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jVRGNZrmwx"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Note only A electrode locations are needed to define pole sources","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EM7OLpsFhg"}],"key":"Cldpyz4l6u"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xFE96WXiYv"}],"key":"HdhMKFNlkN"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.static.resistivity.Survey.html#simpeg.electromagnetics.static.resistivity.survey","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"survey","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SDBEhgKHHp"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.static.resistivity.Survey","internal":false,"protocol":"xref:sphinx","key":"QF2bttTgil"},{"type":"text","value":": the object which stores and organizes all of the sources and receivers.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gNK8ue0lWS"}],"key":"akD7nCNmK9"}],"key":"UAPClS4kn4"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Each datum corresponds to a unique pair of current and potential electrodes. When running the 1D forward simulation, the horizontal position is taken into account and we assume the electrodes are placed at the Earth’s surface. Therefore electrode locations can be defined by an xyz location, but the vertical position is ignored.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"pj4bbPrNoS"}],"key":"hAC1ahlYIR"}],"key":"nZIAzk0YlF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.261683Z","iopub.status.busy":"2024-07-17T17:49:29.261066Z","iopub.status.idle":"2024-07-17T17:49:29.274708Z","shell.execute_reply":"2024-07-17T17:49:29.274062Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the 'a' spacings for Wenner array and number of soundings\na_min = 20.0\na_max = 500.0\nn_stations = 25\nelectrode_separations = np.linspace(a_min, a_max, n_stations)\n\nsource_list = []  # create empty array for sources to live\nfor ii in range(0, len(electrode_separations)):\n    # Extract separation parameter for sources and receivers\n    a = electrode_separations[ii]\n\n    # AB electrode locations for source. Each is a (1, 3) numpy array\n    A_location = np.r_[-1.5 * a, 0.0, 0.0]\n    B_location = np.r_[1.5 * a, 0.0, 0.0]\n\n    # MN electrode locations for receivers. Each is an (N, 3) numpy array\n    M_location = np.r_[-0.5 * a, 0.0, 0.0]\n    N_location = np.r_[0.5 * a, 0.0, 0.0]\n\n    # Create receivers list. Define as pole or dipole.\n    receiver_list = dc.receivers.Dipole(\n        M_location, N_location, data_type=\"apparent_resistivity\"\n    )\n    receiver_list = [receiver_list]\n\n    # Define the source properties and associated receivers\n    source_list.append(dc.sources.Dipole(receiver_list, A_location, B_location))\n\n# Define survey\nsurvey = dc.Survey(source_list)","key":"UhPDL83VGo"},{"type":"output","id":"lmRTvty73-pYceU3k2bJi","data":[],"key":"GMK63i8aBH"}],"key":"eRzy4Wgkk0"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can extract various objects and properties from the objects used to generate the survey. As we can see, all receivers associated with each source are defined within a single object.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ISzNFKGIeA"}],"key":"DchF6GqOC7"}],"key":"H5Cjyemuzt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.279104Z","iopub.status.busy":"2024-07-17T17:49:29.278850Z","iopub.status.idle":"2024-07-17T17:49:29.284534Z","shell.execute_reply":"2024-07-17T17:49:29.283829Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"# of locations: {}\".format(survey.nSrc))  # number of sources\nprint(\"# of data: {}\".format(survey.nD))  # number of data that will be simulated\nprint(survey.source_list[3])  # the 3rd source object\nprint(survey.source_list[3].receiver_list[0])  # Its receiver","key":"wWEGUzMUNT"},{"type":"output","id":"nwXcUzhh1AZo4AmLot3yA","data":[{"name":"stdout","output_type":"stream","text":"# of locations: 25\n# of data: 25\nDipole(a: [-120.    0.    0.]; b: [120.   0.   0.])\nDipole(m: [-40.   0.   0.]; n: [40.  0.  0.])\n"}],"key":"rJ8PwV0BNl"}],"key":"GGgAVOvpl6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define a 1D Layered Earth Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m2XFLp3ekM"}],"identifier":"define-a-1d-layered-earth-model","label":"Define a 1D Layered Earth Model","html_id":"define-a-1d-layered-earth-model","implicit":true,"key":"a8VShRZH05"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, a 1D layered Earth is defined by the set of layer thicknesses and the physical properties for each layer. Thicknesses and physical property values are defined from the top layer down. If we have N layers, we define N physical property values and N-1 layer thicknesses. The lowest layer is assumed to extend to infinity. In the case of a halfspace, the layer thicknesses would be an empty array.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XIeCMk17mw"}],"key":"wQrNwqL1SO"}],"key":"d4f22uSuZb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.289160Z","iopub.status.busy":"2024-07-17T17:49:29.288871Z","iopub.status.idle":"2024-07-17T17:49:29.293286Z","shell.execute_reply":"2024-07-17T17:49:29.292686Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define layer thicknesses.\nlayer_thicknesses = np.r_[100.0, 100.0]\n\n# Define layer resistivities.\nlayer_resistivities = np.r_[1e3, 4e3, 2e2]","key":"oSlfHSJZKD"},{"type":"output","id":"SHiqlh8krV542FpQIGcq5","data":[],"key":"RFEd0HMHhS"}],"key":"G6PJc29ZGd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.297388Z","iopub.status.busy":"2024-07-17T17:49:29.296992Z","iopub.status.idle":"2024-07-17T17:49:29.696840Z","shell.execute_reply":"2024-07-17T17:49:29.696070Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ax = plot_1d_layer_model(layer_thicknesses, layer_resistivities)\nax.grid(which=\"both\")\nax.set_xlabel(r\"Resistivity ($\\Omega m$)\")\nplt.show()","key":"LldYXkmClE"},{"type":"output","id":"oOswXu73vCG-wdXUMi6mJ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a79a336365288301a5cc5a3c3de266d4","path":"/user-tutorials/build/a79a336365288301a5cc5a3c3de266d4.png"},"text/plain":{"content":"<Figure size 600x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"W8aI2p8BjU"}],"key":"S3akImG17N"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define a Model and Mapping","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bXtUUnBfJc"}],"identifier":"define-a-model-and-mapping","label":"Define a Model and Mapping","html_id":"define-a-model-and-mapping","implicit":true,"key":"D6EiXly6x3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, the term ‘model’ is not necessarily synonymous with a set of physical property values. For example, the model may be defined as the logarithms of the physical property values, or be the parameters defining a layered Earth geometry. Models in SimPEG are 1D ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w2WqxbWm5Z"},{"type":"link","url":"https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"numpy.ndarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oT2pu4IwQR"}],"urlSource":"myst:numpy#numpy.ndarray","internal":false,"protocol":"xref:sphinx","key":"L1rq7d4FHf"},{"type":"text","value":" whose lengths are equal to the number of model parameters.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hNDEwX4N9y"}],"key":"MhKILRq0EV"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Classes within the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eob5cuyZxs"},{"type":"inlineCode","value":"simpeg.maps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"l2ueluny2z"},{"type":"text","value":" module are used to define the mapping that connects the model to the parameters required to run the DC resistivity simulation; i.e. layer thicknesses and layer conductivities/resistivities. Here, we demonstrate two types of mappings and models that may be used for 1D DC resistivity simulation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ftD53YFX1o"}],"key":"iLoXRHqskI"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"1. Resistivity model:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vCFKi6rVri"}],"key":"uKT0IsWfcX"},{"type":"text","value":" For forward simulation, the easiest approach is to define the model as the layer resistivities and hard-code the layer thicknesses into simulation. In this case, the mapping from the model to the resistivities is defined using the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IGvxiLGss1"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.IdentityMap.html#simpeg.maps.identitymap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"simpeg​.maps​.IdentityMap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jrLkugN00i"}],"urlSource":"myst:simpeg#simpeg.maps.IdentityMap","internal":false,"protocol":"xref:sphinx","key":"ywb6MXuLX0"},{"type":"text","value":" class.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"b7wPoNBIy0"}],"key":"zKZXe1nKVd"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"2. Parametric layered Earth model:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PFezrUgCYX"}],"key":"vxxYhb8uRf"},{"type":"text","value":" In this case, the model defines the layer thicknesses and log-conductivities. We therefore need a mapping that extracts layer thicknesses from the model, and a mapping that extracts log-conductivities from the model and converts them into conductivities. For this, we require the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RIi2lfJWlL"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.Wires.html#simpeg.maps.wires","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"simpeg.maps.Wires","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZGNN3ZMtzV"}],"urlSource":"myst:simpeg#simpeg.maps.Wires","internal":false,"protocol":"xref:sphinx","key":"rMLOIyBmxp"},{"type":"text","value":" mapping and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rj1JNwxIXD"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.ExpMap.html#simpeg.maps.expmap","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"simpeg.maps.ExpMap","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hQUleijNQF"}],"urlSource":"myst:simpeg#simpeg.maps.ExpMap","internal":false,"protocol":"xref:sphinx","key":"vNvVlKORai"},{"type":"text","value":" mapping classes. Note that successive mappings can be chained together using the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cIGJSOG09Q"},{"type":"inlineMath","value":"*","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∗</mo></mrow><annotation encoding=\"application/x-tex\">*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord\">∗</span></span></span></span>","key":"BQDpZqt1WN"},{"type":"text","value":" operator.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nBjyR0Tvu1"}],"key":"pZIYjpvnTW"}],"key":"w0xNXiboqe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.701986Z","iopub.status.busy":"2024-07-17T17:49:29.701743Z","iopub.status.idle":"2024-07-17T17:49:29.707493Z","shell.execute_reply":"2024-07-17T17:49:29.706891Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define mapping for a resistivity model.\nresistivity_model = layer_resistivities.copy()\nresistivity_map = maps.IdentityMap(nP=len(layer_resistivities))\n\n# Define mappings for parametric model with log-resistivities\nparametric_model = np.r_[layer_thicknesses, np.log(1 / layer_resistivities)]\nwire_map = maps.Wires(\n    (\"thicknesses\", len(layer_thicknesses)),\n    (\"log_conductivity\", len(layer_resistivities)),\n)\nthicknesses_map = wire_map.thicknesses\nlog_conductivity_map = maps.ExpMap() * wire_map.log_conductivity","key":"j0agwMDqkv"},{"type":"output","id":"aZraAzEU8zA6LjIL5DUTN","data":[],"key":"Ia3eHDX0Ll"}],"key":"Ta7W5cve5f"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Forward Simulation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nmnCyNb43e"}],"identifier":"define-the-forward-simulation","label":"Define the Forward Simulation","html_id":"define-the-forward-simulation","implicit":true,"key":"gF3b7CqcOW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, the physics of the forward simulation is defined by creating an instance of an appropriate simulation class. Here, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ykc5u33TIG"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.static.resistivity.Simulation1DLayers.html#simpeg.electromagnetics.static.resistivity.simulation1dlayers","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Simulation1DLayers","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HNKys9IAX3"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.static.resistivity.Simulation1DLayers","internal":false,"protocol":"xref:sphinx","key":"n2NJaqhHNJ"},{"type":"text","value":" which simulates the data according to a 1D Hankel transform solution. To fully define the forward simulation, we need to connect the simulation object to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M4WrHuf23w"}],"key":"U5BqY7Gna2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"the survey","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PJYvx7AbZu"}],"key":"FFFKo7Q0nj"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"the layer thicknesses","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TjQJcXhSHE"}],"key":"GUZvd8skn9"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"the layer conductivities/resistivities","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HYDZSAAfkc"}],"key":"JxsrtFvJt4"}],"key":"LGU8GLcRSi"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This is accomplished by setting each one of the aforementioned items as a property of the simulation object. Here, we define two simulation objects.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wOsDW4NK63"}],"key":"PXQLql7hRH"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"1. Resistivity model simulation:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"aBrCerfZDI"}],"key":"Ccz4Ydy2y0"},{"type":"text","value":" Here, the model parameters are the layer resistivities. ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WMvph1DDNi"},{"type":"inlineCode","value":"rhoMap","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"lPw2zYGBjY"},{"type":"text","value":" is used to define the mapping from the model to the layer resistivities. And ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qTGYIzUwrZ"},{"type":"inlineCode","value":"thicknessess","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"g0NoBbRhu9"},{"type":"text","value":" is used to set the layer thicknesses as static parameters of the simulation.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YGqf6PBSqM"}],"key":"pMNJPqhYZG"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2. Parametric model simulation:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"olkqJsosFH"}],"key":"Sg6OJpSoU3"},{"type":"text","value":" Here we are working with conductivities as opposed to resistivities, and the model contains layer thicknesses and log-conductivities. In this case, ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"HiDhiH6fEf"},{"type":"inlineCode","value":"sigmaMap","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xcvtpDZDgv"},{"type":"text","value":" is used to define the mapping from the model to the layer conductivities. And ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dkqjaH213b"},{"type":"inlineCode","value":"thicknessesMap","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"y8mdUOrrBr"},{"type":"text","value":" is used to define the mapping from the model to the layer thicknesses.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mri12ujNRT"}],"key":"IPG31InyRF"}],"key":"tW7ynvapCV"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.710696Z","iopub.status.busy":"2024-07-17T17:49:29.710466Z","iopub.status.idle":"2024-07-17T17:49:29.731492Z","shell.execute_reply":"2024-07-17T17:49:29.730424Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation_resistivity = dc.simulation_1d.Simulation1DLayers(\n    survey=survey,\n    rhoMap=resistivity_map,\n    thicknesses=layer_thicknesses,\n)","key":"dNQ7t8x7XK"},{"type":"output","id":"qteUCZ_buv3WEsW1Ol2wn","data":[],"key":"ikw8lwxcrx"}],"key":"Poz141KSLC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.735226Z","iopub.status.busy":"2024-07-17T17:49:29.734712Z","iopub.status.idle":"2024-07-17T17:49:29.739408Z","shell.execute_reply":"2024-07-17T17:49:29.738796Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation_parametric = dc.simulation_1d.Simulation1DLayers(\n    survey=survey,\n    sigmaMap=log_conductivity_map,\n    thicknessesMap=thicknesses_map,\n)","key":"zOvaBGw2qX"},{"type":"output","id":"_b0fzcv6G9WadpPnHbLDS","data":[],"key":"mQmnKXfM4O"}],"key":"KAOSfvDPqM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Predict DC Resistivity Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eJBVDQNfmI"}],"identifier":"predict-dc-resistivity-data","label":"Predict DC Resistivity Data","html_id":"predict-dc-resistivity-data","implicit":true,"key":"aW6jbs0IJJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Once any simulation within SimPEG has been properly constructed, simulated data for a given model vector can be computed using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JTWIfEyAEk"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.simulation.BaseSimulation.dpred.html#simpeg.simulation.basesimulation.dpred","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"dpred","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K4h2UqFGre"}],"urlSource":"myst:simpeg#simpeg.simulation.BaseSimulation.dpred","internal":false,"protocol":"xref:sphinx","key":"Mpqklpnuzg"},{"type":"text","value":" method. Note that despite the difference in how we defined the model, the data predicted by both simulations is equivalent because data are being modeled for the same 1D layered Earth.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"spcqBaeCKJ"}],"key":"fLNmYuZ1b7"}],"key":"YGYjstxrjU"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.743058Z","iopub.status.busy":"2024-07-17T17:49:29.742738Z","iopub.status.idle":"2024-07-17T17:49:29.830587Z","shell.execute_reply":"2024-07-17T17:49:29.829862Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dpred_resistivity = simulation_resistivity.dpred(resistivity_model)\ndpred_parametric = simulation_parametric.dpred(parametric_model)","key":"ig9SRbNwfH"},{"type":"output","id":"SM9CPN8ILb93KfvnqY399","data":[],"key":"muUGHo0tAO"}],"key":"l4GZyCSilt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:29.834531Z","iopub.status.busy":"2024-07-17T17:49:29.834179Z","iopub.status.idle":"2024-07-17T17:49:30.126742Z","shell.execute_reply":"2024-07-17T17:49:30.125674Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(9, 5))\nax1 = fig.add_axes([0.1, 0.1, 0.75, 0.85])\nax1.semilogy(1.5 * electrode_separations, dpred_resistivity, \"b\")\nax1.semilogy(1.5 * electrode_separations, dpred_parametric, \"r*\")\nax1.grid(True, which=\"both\")\nax1.set_xlabel(\"AB/2 (m)\")\nax1.set_ylabel(r\"$\\Omega m$\")\nax1.set_title(\"Sounding Curve\")\nax1.legend([\"Resistivity Model\", \"Parametric Model\"])\nplt.show()","key":"K2OSJCUAKS"},{"type":"output","id":"Neo7VbFMbk5xWQtQ9PVRI","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"72922a0d8f6144f2dbe974d6b04aa29f","path":"/user-tutorials/build/72922a0d8f6144f2dbe974d6b04aa29f.png"},"text/plain":{"content":"<Figure size 900x500 with 1 Axes>","content_type":"text/plain"}}}],"key":"yK9JBpW8vj"}],"key":"gZk6gUXbsg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Optional:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GmDYq8hGWA"}],"key":"CMwJpIgBNb"},{"type":"text","value":" Export Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jx0m60biMJ"}],"key":"VuwoNpbIVl"}],"key":"GEpam77dZZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T17:49:30.132479Z","iopub.status.busy":"2024-07-17T17:49:30.131855Z","iopub.status.idle":"2024-07-17T17:49:30.141329Z","shell.execute_reply":"2024-07-17T17:49:30.140060Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"if write_output:\n    dir_path = os.path.sep.join([\".\", \"fwd_dcr_1d_outputs\"]) + os.path.sep\n    if not os.path.exists(dir_path):\n        os.mkdir(dir_path)\n\n    np.random.seed(145)\n    noise = 0.025 * dpred_resistivity * np.random.normal(size=len(dpred_resistivity))\n\n    data_array = np.c_[\n        survey.locations_a,\n        survey.locations_b,\n        survey.locations_m,\n        survey.locations_n,\n        dpred_resistivity + noise,\n    ]\n\n    fname = dir_path + \"app_res_1d_data.dobs\"\n    np.savetxt(fname, data_array, fmt=\"%.4e\")","key":"FdfNfaWh7J"},{"type":"output","id":"x4hOPkLlkH0PubcKgSn9J","data":[],"key":"f1BqmeR2cq"}],"key":"rYH2JYga6u"}],"key":"lh3uCv5bjd"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Direct Current Resistivity","url":"/dcr-index","group":"SimPEG User Tutorials"},"next":{"title":"2.5D Forward Simulation","url":"/fwd-dcr-2d","group":"SimPEG User Tutorials"}}},"domain":"http://localhost:3000"}