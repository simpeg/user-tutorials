<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information - SimPEG User Tutorials</title><meta property="og:title" content="Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information - SimPEG User Tutorials"/><meta name="generator" content="mystmd"/><meta name="description" content="SimPEG user tutorials"/><meta property="og:description" content="SimPEG user tutorials"/><meta name="keywords" content="geophysics, inversions, python, open-source"/><meta name="image" content="/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png"/><meta property="og:image" content="/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png"/><link rel="stylesheet" href="/user-tutorials/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/user-tutorials/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script defer="" data-domain="simpeg.xyz" src="https://plausible.io/js/plausible.js"></script><link rel="icon" href="/user-tutorials/favicon.ico"/><link rel="stylesheet" href="/user-tutorials/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/user-tutorials/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png" class="h-9" alt="User Tutorials" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5">User Tutorials</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0" data-headlessui-state=""><div class="inline-block"><button class="inline-flex items-center justify-center w-full py-1 mx-2 font-medium rounded-md text-md text-stone-900 dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" id="headlessui-menu-button-:R1j4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span>SimPEG</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="ml-2 -mr-1 text-violet-200 hover:text-violet-100"><path fill-rule="evenodd" d="M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://mystmd.org/guide" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Learn More</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a class="py-2 grow" href="/">SimPEG</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rap8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rap8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="SimPEG User Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/user-tutorials/">SimPEG User Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Gravity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/gravity-index">Gravity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Magnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/magnetics-index">Magnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Direct Current Resistivity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/dcr-index">Direct Current Resistivity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Induced Polarization" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/ip-index">Induced Polarization</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Frequency-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/fdem-index">Frequency-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Time-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/tdem-index">Time-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1up8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1up8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Joint Inversion" class="block break-words rounded py-2 grow cursor-pointer">Joint Inversion</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="PGI Inversion" class="block break-words rounded py-2 grow cursor-pointer">PGI Inversion</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Contributing to User Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/contributing-index">Contributing to User Tutorials</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">SimPEG User Tutorials</div><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" title="Code License: MIT License (MIT)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://github.com/simpeg/user-tutorials" title="GitHub Repository: simpeg/user-tutorials" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/simpeg/user-tutorials/edit/main/notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information</h1><header class="mt-4 not-prose"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div><span class="font-semibold text-sm"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R2t8top:" data-state="closed">Devin Cowan</button><a class="ml-1" href="https://orcid.org/0000-0002-0089-402X" title="ORCID: 0000-0002-0089-402X" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 -translate-y-[0.1em] hover:text-[#A9C751]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia<!-- --> <a class="ml-1" href="https://ror.org/03rmrcq20" target="_blank" rel="noopener noreferrer" title="Research Organization Registry"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block"><path d="M10 4.2L8.3 6.8 6.6 4.2H10zM17.1 4.2l-1.7 2.6-1.7-2.6h3.4zM6.6 19.8l1.7-2.6 1.7 2.6H6.6zM13.7 19.8l1.7-2.6 1.7 2.6h-3.4zM20.8 12.5c.6-.1 1.1-.4 1.4-.8.3-.4.5-.9.5-1.5 0-.5-.1-.9-.3-1.2-.2-.3-.4-.6-.7-.8-.3-.2-.6-.3-1-.4-.4-.1-.8-.1-1.2-.1h-3.3v2.6c0-.1-.1-.2-.1-.2-.2-.6-.6-1-1-1.4-.4-.4-.9-.7-1.5-.9-.6-.2-1.2-.3-1.9-.3s-1.3.1-1.9.3c-.5.1-1 .4-1.4.8-.3.4-.6.8-.9 1.3 0-.3-.1-.6-.2-.9-.2-.4-.4-.6-.7-.8-.3-.2-.6-.3-1-.4s-.8-.2-1.3-.2H1v8.5h1.9v-3.4h.9l1.8 3.4h2.3l-2.2-3.6c.6-.1 1.1-.4 1.4-.8v-.1.2c0 .7.1 1.3.3 1.8.2.6.6 1 1 1.4.4.4.9.7 1.5.9.6.2 1.2.3 1.9.3s1.3-.1 1.9-.3c.6-.2 1.1-.5 1.5-.9.4-.4.7-.9 1-1.4 0-.1.1-.2.1-.2V16H18v-3.4h.9l1.8 3.4H23l-2.2-3.5zM5.4 10.7c-.1.2-.2.3-.3.3-.2.1-.3.1-.5.1H2.9V9.2h1.7c.2 0 .3.1.5.1.1.1.3.2.3.3.1.1.1.3.1.5.1.3 0 .5-.1.6zm8.8 2.3c-.1.3-.3.6-.5.9-.2.2-.5.4-.8.6-.3.1-.7.2-1.1.2-.4 0-.8-.1-1.1-.2-.3-.1-.6-.3-.8-.6-.2-.2-.4-.5-.5-.9-.1-.3-.2-.7-.2-1.1 0-.4.1-.8.2-1.1s.3-.6.5-.9c.2-.2.5-.4.8-.6.3-.1.7-.2 1.1-.2.4 0 .8.1 1.1.2.3.1.6.3.8.6.2.2.4.5.5.9.1.3.2.7.2 1.1 0 .4 0 .7-.2 1.1zm6.4-2.3c-.1.1-.2.2-.4.3-.2.1-.3.1-.5.1H18V9.2h1.7c.2 0 .3.1.5.1.1.1.3.2.3.3.1.1.1.3.1.5.1.3.1.5 0 .6z"></path></svg></a></div></div></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="tJZGEpSrfr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%matplotlib inline</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nYeJxwUY1aG1bJbkYqvhX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VMIBX9AUsk" class="relative group/block"><p>This tutorial shows through a joint inversion of Gravity and Magnetic data on an
Octree mesh how to use the PGI framework introduced in Astic &amp; Oldenburg (2019)
and Astic et al. (2021) to make geologic assumptions and learn a suitable
petrophysical distribution when no quantitative petrophysical information is
available.</p><p>Thibaut Astic, Douglas W. Oldenburg,
A framework for petrophysically and geologically guided geophysical inversion
using a dynamic Gaussian mixture model prior, Geophysical Journal International,
Volume 219, Issue 3, December 2019, Pages 1989–2012, DOI:
<code>10.1093/gji/ggz389 &lt;https://doi.org/10.1093/gji/ggz389&gt;</code>_.</p><p>Thibaut Astic, Lindsey J. Heagy, Douglas W Oldenburg,
Petrophysically and geologically guided multi-physics inversion using a dynamic
Gaussian mixture model, Geophysical Journal International,
Volume 224, Issue 1, January 2021, Pages 40-68, DOI: <code>10.1093/gji/ggaa378 &lt;https://doi.org/10.1093/gji/ggaa378&gt;</code>_.</p></div><div id="qBr2xkgrWp" class="relative group/block"><h2 id="import-modules" class="relative group"><span class="heading-text">Import modules</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#import-modules" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="M5FaSuViPv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from discretize import TreeMesh
from discretize.utils import active_from_xyz
import matplotlib.pyplot as plt
import numpy as np
import simpeg.potential_fields as pf
from simpeg import (
    data_misfit,
    directives,
    inverse_problem,
    inversion,
    maps,
    optimization,
    regularization,
    utils,
)
from simpeg.utils import io_utils</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="i1arZufQ0oh0G6UIsuY-S" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="I5LSm0UW9p" class="relative group/block"><h2 id="setup" class="relative group"><span class="heading-text">Setup</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#setup" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="YrHWHibKzs" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load Mesh
mesh_file = io_utils.download(
    &quot;https://storage.googleapis.com/simpeg/pgi_tutorial_assets/mesh_tutorial.ubc&quot;
)
mesh = TreeMesh.read_UBC(mesh_file)

# Load True geological model for comparison with inversion result
true_geology_file = io_utils.download(
    &quot;https://storage.googleapis.com/simpeg/pgi_tutorial_assets/geology_true.mod&quot;
)
true_geology = mesh.read_model_UBC(true_geology_file)

# Plot true geology model
fig, ax = plt.subplots(1, 4, figsize=(20, 4))
ticksize, labelsize = 14, 16
for _, axx in enumerate(ax):
    axx.set_aspect(1)
    axx.tick_params(labelsize=ticksize)
mesh.plot_slice(
    true_geology,
    normal=&quot;X&quot;,
    ax=ax[0],
    ind=-17,
    clim=[0, 2],
    pcolor_opts={&quot;cmap&quot;: &quot;inferno_r&quot;},
    grid=True,
)
mesh.plot_slice(
    true_geology,
    normal=&quot;Y&quot;,
    ax=ax[1],
    clim=[0, 2],
    pcolor_opts={&quot;cmap&quot;: &quot;inferno_r&quot;},
    grid=True,
)
geoplot = mesh.plot_slice(
    true_geology,
    normal=&quot;Z&quot;,
    ax=ax[2],
    clim=[0, 2],
    ind=-10,
    pcolor_opts={&quot;cmap&quot;: &quot;inferno_r&quot;},
    grid=True,
)
geocb = plt.colorbar(geoplot[0], cax=ax[3], ticks=[0, 1, 2])
geocb.set_label(
    &quot;True geology model\n(classification/density/mag. susc.)&quot;, fontsize=labelsize
)
geocb.set_ticklabels(
    [&quot;BCKGRD (0 g/cc; 0 SI)&quot;, &quot;PK (-0.8 g/cc; 5e-3 SI)&quot;, &quot;VK (-0.2 g/cc; 2e-2 SI)&quot;]
)
geocb.ax.tick_params(labelsize=ticksize)
ax[3].set_aspect(10)
plt.show()

# Load geophysical data
data_grav_file = io_utils.download(
    &quot;https://storage.googleapis.com/simpeg/pgi_tutorial_assets/gravity_data.obs&quot;
)
data_grav = io_utils.read_grav3d_ubc(data_grav_file)
data_mag_file = io_utils.download(
    &quot;https://storage.googleapis.com/simpeg/pgi_tutorial_assets/magnetic_data.obs&quot;
)
data_mag = io_utils.read_mag3d_ubc(data_mag_file)

# plot data and mesh
fig, ax = plt.subplots(2, 2, figsize=(15, 10))
ax = ax.reshape(-1)
plt.gca().set_aspect(&quot;equal&quot;)
plt.gca().set_xlim(
    [
        data_mag.survey.receiver_locations[:, 0].min(),
        data_mag.survey.receiver_locations[:, 0].max(),
    ],
)
plt.gca().set_ylim(
    [
        data_mag.survey.receiver_locations[:, 1].min(),
        data_mag.survey.receiver_locations[:, 1].max(),
    ]
)
mesh.plot_slice(
    np.ones(mesh.nC),
    normal=&quot;Z&quot;,
    ind=int(-10),
    grid=True,
    pcolor_opts={&quot;cmap&quot;: &quot;Greys&quot;},
    ax=ax[0],
)
mm = utils.plot2Ddata(
    data_grav.survey.receiver_locations,
    -data_grav.dobs,
    ax=ax[0],
    level=True,
    nx=20,
    ny=20,
    dataloc=True,
    ncontour=12,
    shade=True,
    contourOpts={&quot;cmap&quot;: &quot;Blues_r&quot;, &quot;alpha&quot;: 0.8},
    levelOpts={&quot;colors&quot;: &quot;k&quot;, &quot;linewidths&quot;: 0.5, &quot;linestyles&quot;: &quot;dashed&quot;},
)
ax[0].set_aspect(1)
ax[0].set_title(
    &quot;Gravity data values and locations,\nwith mesh and geology overlays&quot;, fontsize=16
)
plt.colorbar(mm[0], cax=ax[2], orientation=&quot;horizontal&quot;)
ax[2].set_aspect(0.05)
ax[2].set_title(&quot;mGal&quot;, fontsize=16)
mesh.plot_slice(
    np.ones(mesh.nC),
    normal=&quot;Z&quot;,
    ind=int(-10),
    grid=True,
    pcolor_opts={&quot;cmap&quot;: &quot;Greys&quot;},
    ax=ax[1],
)
mm = utils.plot2Ddata(
    data_mag.survey.receiver_locations,
    data_mag.dobs,
    ax=ax[1],
    level=True,
    nx=20,
    ny=20,
    dataloc=True,
    ncontour=11,
    shade=True,
    contourOpts={&quot;cmap&quot;: &quot;Reds&quot;, &quot;alpha&quot;: 0.8},
    levelOpts={&quot;colors&quot;: &quot;k&quot;, &quot;linewidths&quot;: 0.5, &quot;linestyles&quot;: &quot;dashed&quot;},
)
ax[1].set_aspect(1)
ax[1].set_title(
    &quot;Magnetic data values and locations,\nwith mesh and geology overlays&quot;, fontsize=16
)
plt.colorbar(mm[0], cax=ax[3], orientation=&quot;horizontal&quot;)
ax[3].set_aspect(0.05)
ax[3].set_title(&quot;nT&quot;, fontsize=16)
# overlay true geology model for comparison
indz = -9
indslicezplot = mesh.gridCC[:, 2] == mesh.cell_centers_z[indz]
for i in range(2):
    utils.plot2Ddata(
        mesh.gridCC[indslicezplot][:, [0, 1]],
        true_geology[indslicezplot],
        nx=200,
        ny=200,
        contourOpts={&quot;alpha&quot;: 0},
        clim=[0, 2],
        ax=ax[i],
        level=True,
        ncontour=2,
        levelOpts={&quot;colors&quot;: &quot;k&quot;, &quot;linewidths&quot;: 2, &quot;linestyles&quot;: &quot;--&quot;},
        method=&quot;nearest&quot;,
    )
plt.subplots_adjust(hspace=-0.25, wspace=0.1)
plt.show()

# Load Topo
topo_file = io_utils.download(
    &quot;https://storage.googleapis.com/simpeg/pgi_tutorial_assets/CDED_Lake_warp.xyz&quot;
)
topo = np.genfromtxt(topo_file, skip_header=1)
# find the active cells
actv = active_from_xyz(mesh, topo, &quot;CC&quot;)
# Create active map to go from reduce set to full
ndv = np.nan
actvMap = maps.InjectActiveCells(mesh, actv, ndv)
nactv = int(actv.sum())

# Create simulations and data misfits
# Wires mapping
wires = maps.Wires((&quot;den&quot;, actvMap.nP), (&quot;sus&quot;, actvMap.nP))
gravmap = actvMap * wires.den
magmap = actvMap * wires.sus
idenMap = maps.IdentityMap(nP=nactv)
# Grav problem
simulation_grav = pf.gravity.simulation.Simulation3DIntegral(
    survey=data_grav.survey,
    mesh=mesh,
    rhoMap=wires.den,
    active_cells=actv,
    engine=&quot;choclo&quot;,
)
dmis_grav = data_misfit.L2DataMisfit(data=data_grav, simulation=simulation_grav)
# Mag problem
simulation_mag = pf.magnetics.simulation.Simulation3DIntegral(
    survey=data_mag.survey,
    mesh=mesh,
    chiMap=wires.sus,
    active_cells=actv,
    engine=&quot;choclo&quot;,
)
dmis_mag = data_misfit.L2DataMisfit(data=data_mag, simulation=simulation_mag)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RzHCKOqNyRkHz1W32KfAc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/mesh_tutorial.ubc
Downloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/mesh_tutorial.ubc
   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/mesh_tutorial.ubc
Download completed!
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/geology_true.mod
Downloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/geology_true.mod
   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/geology_true.mod
Download completed!
</span></code></pre></div><img src="/user-tutorials/build/c1d5e0d84d41f1406075fadfee3ee34f.png" alt="&lt;Figure size 2000x400 with 4 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/gravity_data.obs
Downloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/gravity_data.obs
   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/gravity_data.obs
Download completed!
file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/magnetic_data.obs
Downloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/magnetic_data.obs
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/magnetic_data.obs
Download completed!
</span></code></pre></div><img src="/user-tutorials/build/a42c757f04992a5e8eb0e43c4f2ef7c4.png" alt="&lt;Figure size 1500x1000 with 4 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/CDED_Lake_warp.xyz
Downloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/CDED_Lake_warp.xyz
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/CDED_Lake_warp.xyz
Download completed!
</span></code></pre></div></div></div><div id="DGtE0Bhbi7" class="relative group/block"><p>Create a joint Data Misfit</p></div><div id="R8ZH8Jt8rv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Joint data misfit
dmis = 0.5 * dmis_grav + 0.5 * dmis_mag

# initial model
m0 = np.r_[-1e-4 * np.ones(actvMap.nP), 1e-4 * np.ones(actvMap.nP)]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nrAsxynKUOgU4UcJQ3Ywy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="d6Cq1nd4eN" class="relative group/block"><h2 id="inversion-with-no-petrophysical-information-about-the-means" class="relative group"><span class="heading-text">Inversion with no petrophysical information about the means</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inversion-with-no-petrophysical-information-about-the-means" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this scenario, we do not know the true petrophysical signature of each rock
unit. We thus make geologic assumptions to design a coupling term and perform
a multi-physics inversion. in addition to a neutral background, we assume that
one rock unit is only less dense, and the third one is only magnetic. As we
do not know their mean petrophysical values. We start with an initial guess
(-1 g/cc) for the updatable mean density-contrast value of the less dense unit
(with a fixed susceptibility of 0 SI). The magnetic-contrasting unit’s updatable
susceptibility is initialized at a value of 0.1 SI (with a fixed 0 g/cc density
contrast). We then let the algorithm learn a suitable set of means under the set
constrained (fixed or updatable value), through the kappa argument, denoting our
confidences in each initial mean value (high confidence: fixed value; low
confidence: updatable value).</p></div><div id="ogH5hdtUtR" class="relative group/block"><h2 id="create-a-petrophysical-gmm-initial-guess" class="relative group"><span class="heading-text">Create a petrophysical GMM initial guess</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-a-petrophysical-gmm-initial-guess" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The GMM is our representation of the petrophysical and geological information.
Here, we focus on the petrophysical aspect, with the means and covariances of
the physical properties of each rock unit.
To generate the data above, the PK unit was populated with a density contrast
of -0.8 g/cc and a magnetic susceptibility of 0.005 SI. The properties of the
HK unit were set at -0.2 g/cc and 0.02 SI. But here, we assume we
do not have this information. Thus, we start with initial guess for the means
and confidences kappa such that one unit is only less dense and one unit is only
magnetic, both embedded in a neutral background. The covariances matrices are set
so that we assume petrophysical noise levels of around 0.05 g/cc and 0.001 SI
for both unit. The background unit is set at a fixed null contrasts (0 g/cc
0 SI) with a petrophysical noise level of half of the above.</p></div><div id="cc55va3wk2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">gmmref = utils.WeightedGaussianMixture(
    n_components=3,  # number of rock units: bckgrd, PK, HK
    mesh=mesh,  # inversion mesh
    actv=actv,  # actv cells
    covariance_type=&quot;diag&quot;,  # diagonal covariances
)
# required: initialization with fit
# fake random samples, size of the mesh
# number of physical properties: 2 (density and mag.susc)
rng = np.random.default_rng(seed=518936)
gmmref.fit(rng.normal(size=(nactv, 2)))
# set parameters manually
# set phys. prop means for each unit
gmmref.means_ = np.c_[
    [0.0, 0.0],  # BCKGRD density contrast and mag. susc
    [-1, 0.0],  # PK
    [0, 0.1],  # HK
].T
# set phys. prop covariances for each unit
gmmref.covariances_ = np.array(
    [[6e-04, 3.175e-07], [2.4e-03, 1.5e-06], [2.4e-03, 1.5e-06]]
)
# important after setting cov. manually: compute precision matrices and cholesky
gmmref.compute_clusters_precisions()
# set global proportions; low-impact as long as not 0 or 1 (total=1)
gmmref.weights_ = np.r_[0.9, 0.075, 0.025]

# Plot the 2D GMM
ax = gmmref.plot_pdf(flag2d=True, plotting_precision=250)
ax[0].set_xlabel(&quot;Density contrast [g/cc]&quot;)
ax[0].set_ylim([0, 5])
ax[2].set_ylabel(&quot;magnetic Susceptibility [SI]&quot;)
ax[2].set_xlim([0, 100])
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SAyCIhciwaD60mT-6PaTn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/1270df2167da2cf7757c52bbf6bafd8f.png" alt="&lt;Figure size 1000x1000 with 4 Axes&gt;"/></div></div><div id="nRoUAHBpSE" class="relative group/block"><h2 id="inverse-problem-with-no-mean-information" class="relative group"><span class="heading-text">Inverse problem with no mean information</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inverse-problem-with-no-mean-information" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="iWqus5zyeo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create PGI regularization
# Sensitivity weighting
wr_grav = np.sum(simulation_grav.G**2.0, axis=0) ** 0.5 / (mesh.cell_volumes[actv])
wr_grav = wr_grav / np.max(wr_grav)

wr_mag = np.sum(simulation_mag.G**2.0, axis=0) ** 0.5 / (mesh.cell_volumes[actv])
wr_mag = wr_mag / np.max(wr_mag)

# create joint PGI regularization with smoothness
reg = regularization.PGI(
    gmmref=gmmref,
    mesh=mesh,
    wiresmap=wires,
    maplist=[idenMap, idenMap],
    active_cells=actv,
    alpha_pgi=1.0,
    alpha_x=1.0,
    alpha_y=1.0,
    alpha_z=1.0,
    alpha_xx=0.0,
    alpha_yy=0.0,
    alpha_zz=0.0,
    # use the classification of the initial model (here, all background unit)
    # as initial reference model
    reference_model=utils.mkvc(
        gmmref.means_[gmmref.predict(m0.reshape(actvMap.nP, -1))]
    ),
    weights_list=[wr_grav, wr_mag],  # weights each phys. prop. by correct sensW
)

# Directives
# Add directives to the inversion
# ratio to use for each phys prop. smoothness in each direction:
# roughly the ratio of range of each phys. prop.
alpha0_ratio = np.r_[
    1e-2 * np.ones(len(reg.objfcts[1].objfcts[1:])),
    1e-2 * 100.0 * np.ones(len(reg.objfcts[2].objfcts[1:])),
]
Alphas = directives.AlphasSmoothEstimate_ByEig(alpha0_ratio=alpha0_ratio, verbose=True)
# initialize beta and beta/alpha_s schedule
beta = directives.BetaEstimate_ByEig(beta0_ratio=1e-4)
betaIt = directives.PGI_BetaAlphaSchedule(
    verbose=True,
    coolingFactor=2.0,
    tolerance=0.2,
    progress=0.2,
)
# geophy. and petro. target misfits
targets = directives.MultiTargetMisfits(
    verbose=True,
    chiSmall=0.5,  # ask for twice as much clustering (target value is /2)
)
# add learned mref in smooth once stable
MrefInSmooth = directives.PGI_AddMrefInSmooth(
    wait_till_stable=True,
    verbose=True,
)
# update the parameters in smallness (L2-approx of PGI)
update_smallness = directives.PGI_UpdateParameters(
    update_gmm=True,  # update the GMM each iteration
    kappa=np.c_[  # confidences in each mean phys. prop. of each cluster
        1e10
        * np.ones(
            2
        ),  # fixed background at 0 density, 0 mag. susc. (high confidences of 1e10)
        [
            0,
            1e10,
        ],  # density-contrasting cluster: updatable density mean, fixed mag. susc.
        [
            1e10,
            0,
        ],  # magnetic-contrasting cluster: fixed density mean, updatable mag. susc.
    ].T,
)
# pre-conditioner
update_Jacobi = directives.UpdatePreconditioner()
# iteratively balance the scaling of the data misfits
scaling_init = directives.ScalingMultipleDataMisfits_ByEig(chi0_ratio=[1.0, 100.0])
scale_schedule = directives.JointScalingSchedule(verbose=True)

# Create inverse problem
# Optimization
# set lower and upper bounds
lowerbound = np.r_[-2.0 * np.ones(actvMap.nP), 0.0 * np.ones(actvMap.nP)]
upperbound = np.r_[0.0 * np.ones(actvMap.nP), 1e-1 * np.ones(actvMap.nP)]
opt = optimization.ProjectedGNCG(
    maxIter=30,
    lower=lowerbound,
    upper=upperbound,
    maxIterLS=20,
    maxIterCG=100,
    tolCG=1e-4,
)
# create inverse problem
invProb = inverse_problem.BaseInvProblem(dmis, reg, opt)
inv = inversion.BaseInversion(
    invProb,
    # directives: evaluate alphas (and data misfits scales) before beta
    directiveList=[
        Alphas,
        scaling_init,
        beta,
        update_smallness,
        targets,
        scale_schedule,
        betaIt,
        MrefInSmooth,
        update_Jacobi,
    ],
)
# Invert
pgi_model_no_info = inv.run(m0)


# Plot the result with full petrophysical information
density_model_no_info = gravmap * pgi_model_no_info
magsus_model_no_info = magmap * pgi_model_no_info
learned_gmm = reg.objfcts[0].gmm
quasi_geology_model_no_info = actvMap * reg.objfcts[0].compute_quasi_geology_model()

fig, ax = plt.subplots(3, 4, figsize=(15, 10))
for _, axx in enumerate(ax):
    for _, axxx in enumerate(axx):
        axxx.set_aspect(1)
        axxx.tick_params(labelsize=ticksize)

indx = 15
indy = 17
indz = -9
# geology model
mesh.plot_slice(
    quasi_geology_model_no_info,
    normal=&quot;X&quot;,
    ax=ax[0, 0],
    clim=[0, 2],
    ind=indx,
    pcolor_opts={&quot;cmap&quot;: &quot;inferno_r&quot;},
)
mesh.plot_slice(
    quasi_geology_model_no_info,
    normal=&quot;Y&quot;,
    ax=ax[0, 1],
    clim=[0, 2],
    ind=indy,
    pcolor_opts={&quot;cmap&quot;: &quot;inferno_r&quot;},
)
geoplot = mesh.plot_slice(
    quasi_geology_model_no_info,
    normal=&quot;Z&quot;,
    ax=ax[0, 2],
    clim=[0, 2],
    ind=indz,
    pcolor_opts={&quot;cmap&quot;: &quot;inferno_r&quot;},
)
geocb = plt.colorbar(geoplot[0], cax=ax[0, 3], ticks=[0, 1, 2])
geocb.set_ticklabels([&quot;BCK&quot;, &quot;PK&quot;, &quot;VK&quot;])
geocb.set_label(&quot;Quasi-Geology model\n(Rock units classification)&quot;, fontsize=16)
ax[0, 3].set_aspect(10)

# gravity model
mesh.plot_slice(
    density_model_no_info,
    normal=&quot;X&quot;,
    ax=ax[1, 0],
    clim=[-1, 0],
    ind=indx,
    pcolor_opts={&quot;cmap&quot;: &quot;Blues_r&quot;},
)
mesh.plot_slice(
    density_model_no_info,
    normal=&quot;Y&quot;,
    ax=ax[1, 1],
    clim=[-1, 0],
    ind=indy,
    pcolor_opts={&quot;cmap&quot;: &quot;Blues_r&quot;},
)
denplot = mesh.plot_slice(
    density_model_no_info,
    normal=&quot;Z&quot;,
    ax=ax[1, 2],
    clim=[-1, 0],
    ind=indz,
    pcolor_opts={&quot;cmap&quot;: &quot;Blues_r&quot;},
)
dencb = plt.colorbar(denplot[0], cax=ax[1, 3])
dencb.set_label(&quot;Density contrast\nmodel (g/cc)&quot;, fontsize=16)
ax[1, 3].set_aspect(10)

# magnetic model
mesh.plot_slice(
    magsus_model_no_info,
    normal=&quot;X&quot;,
    ax=ax[2, 0],
    clim=[0, 0.025],
    ind=indx,
    pcolor_opts={&quot;cmap&quot;: &quot;Reds&quot;},
)
mesh.plot_slice(
    magsus_model_no_info,
    normal=&quot;Y&quot;,
    ax=ax[2, 1],
    clim=[0, 0.025],
    ind=indy,
    pcolor_opts={&quot;cmap&quot;: &quot;Reds&quot;},
)
susplot = mesh.plot_slice(
    magsus_model_no_info,
    normal=&quot;Z&quot;,
    ax=ax[2, 2],
    clim=[0, 0.025],
    ind=indz,
    pcolor_opts={&quot;cmap&quot;: &quot;Reds&quot;},
)
suscb = plt.colorbar(susplot[0], cax=ax[2, 3])
suscb.set_label(&quot;Magnetic susceptibility\nmodel (SI)&quot;, fontsize=16)
ax[2, 3].set_aspect(10)

# overlay true geology model for comparison
indslicexplot = mesh.gridCC[:, 0] == mesh.cell_centers_x[indx]
indsliceyplot = mesh.gridCC[:, 1] == mesh.cell_centers_y[indy]
indslicezplot = mesh.gridCC[:, 2] == mesh.cell_centers_z[indz]
for i in range(3):
    for j, (plane, indd) in enumerate(
        zip([[1, 2], [0, 2], [0, 1]], [indslicexplot, indsliceyplot, indslicezplot])
    ):
        utils.plot2Ddata(
            mesh.gridCC[indd][:, plane],
            true_geology[indd],
            nx=100,
            ny=100,
            contourOpts={&quot;alpha&quot;: 0},
            clim=[0, 2],
            ax=ax[i, j],
            level=True,
            ncontour=2,
            levelOpts={&quot;colors&quot;: &quot;grey&quot;, &quot;linewidths&quot;: 2, &quot;linestyles&quot;: &quot;--&quot;},
            method=&quot;nearest&quot;,
        )

# plot the locations of the cross-sections
for i in range(3):
    ax[i, 0].plot(
        mesh.cell_centers_y[indy] * np.ones(2), [-300, 500], c=&quot;k&quot;, linestyle=&quot;dotted&quot;
    )
    ax[i, 0].plot(
        [
            data_mag.survey.receiver_locations[:, 1].min(),
            data_mag.survey.receiver_locations[:, 1].max(),
        ],
        mesh.cell_centers_z[indz] * np.ones(2),
        c=&quot;k&quot;,
        linestyle=&quot;dotted&quot;,
    )
    ax[i, 0].set_xlim(
        [
            data_mag.survey.receiver_locations[:, 1].min(),
            data_mag.survey.receiver_locations[:, 1].max(),
        ],
    )

    ax[i, 1].plot(
        mesh.cell_centers_x[indx] * np.ones(2), [-300, 500], c=&quot;k&quot;, linestyle=&quot;dotted&quot;
    )
    ax[i, 1].plot(
        [
            data_mag.survey.receiver_locations[:, 0].min(),
            data_mag.survey.receiver_locations[:, 0].max(),
        ],
        mesh.cell_centers_z[indz] * np.ones(2),
        c=&quot;k&quot;,
        linestyle=&quot;dotted&quot;,
    )
    ax[i, 1].set_xlim(
        [
            data_mag.survey.receiver_locations[:, 0].min(),
            data_mag.survey.receiver_locations[:, 0].max(),
        ],
    )

    ax[i, 2].plot(
        mesh.cell_centers_x[indx] * np.ones(2),
        [
            data_mag.survey.receiver_locations[:, 1].min(),
            data_mag.survey.receiver_locations[:, 1].max(),
        ],
        c=&quot;k&quot;,
        linestyle=&quot;dotted&quot;,
    )
    ax[i, 2].plot(
        [
            data_mag.survey.receiver_locations[:, 0].min(),
            data_mag.survey.receiver_locations[:, 0].max(),
        ],
        mesh.cell_centers_y[indy] * np.ones(2),
        c=&quot;k&quot;,
        linestyle=&quot;dotted&quot;,
    )
    ax[i, 2].set_xlim(
        [
            data_mag.survey.receiver_locations[:, 0].min(),
            data_mag.survey.receiver_locations[:, 0].max(),
        ],
    )
    ax[i, 2].set_ylim(
        [
            data_mag.survey.receiver_locations[:, 1].min(),
            data_mag.survey.receiver_locations[:, 1].max(),
        ],
    )

plt.tight_layout()
plt.show()

# Plot the learned 2D GMM
fig = plt.figure(figsize=(10, 10))
ax0 = plt.subplot2grid((4, 4), (3, 1), colspan=3)
ax1 = plt.subplot2grid((4, 4), (0, 1), colspan=3, rowspan=3)
ax2 = plt.subplot2grid((4, 4), (0, 0), rowspan=3)
ax = [ax0, ax1, ax2]
learned_gmm.plot_pdf(flag2d=True, ax=ax, padding=1, plotting_precision=100)
ax[0].set_xlabel(&quot;Density contrast [g/cc]&quot;)
ax[0].set_ylim([0, 5])
ax[2].set_xlim([0, 50])
ax[2].set_ylabel(&quot;magnetic Susceptibility [SI]&quot;)
ax[1].scatter(
    density_model_no_info[actv],
    magsus_model_no_info[actv],
    c=quasi_geology_model_no_info[actv],
    cmap=&quot;inferno_r&quot;,
    edgecolors=&quot;k&quot;,
    label=&quot;recovered PGI model&quot;,
    alpha=0.5,
)
ax[0].hist(density_model_no_info[actv], density=True, bins=50)
ax[2].hist(magsus_model_no_info[actv], density=True, bins=50, orientation=&quot;horizontal&quot;)
ax[1].scatter(
    [0, -0.8, -0.02],
    [0, 0.005, 0.02],
    label=&quot;True petrophysical means&quot;,
    cmap=&quot;inferno_r&quot;,
    c=[0, 1, 2],
    marker=&quot;v&quot;,
    edgecolors=&quot;k&quot;,
    s=200,
)
ax[1].legend()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="A6dLt64ktWYQ5UCUN8BAb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
Running inversion with SimPEG v0.24.0

                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                    ***Done using the default solver Pardiso and no solver_opts.***
                    
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Alpha scales: [np.float64(7660874.184294957), np.float64(0.0), np.float64(5073966.905923588), np.float64(0.0), np.float64(10755946.585578023), np.float64(0.0), np.float64(901080732.7168696), np.float64(0.0), np.float64(651184740.4106032), np.float64(0.0), np.float64(1695952133.7691708), np.float64(0.0)]
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>&lt;class &#x27;simpeg.regularization.pgi.PGIsmallness&#x27;&gt;
Initial data misfit scales:  [0.97501981 0.02498019]
model has any nan: 0
=============================== Projected GNCG ===============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   
-----------------------------------------------------------------------------
x0 has any nan: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   0  1.38e-08  4.25e+06  9.99e+04  4.25e+06    2.17e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 446636.5 (target 576.0 [False]); 126029.0 (target 576.0 [False]) | smallness misfit: 136498.4 (target: 11719.0 [False])
Beta cooling evaluation: progress: [446636.5 126029. ]; minimum progress targets: [3470231.3  572697.8]
mref changed in  4686  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   1  1.38e-08  4.39e+05  2.02e+09  4.39e+05    2.11e+01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 210204.3 (target 576.0 [False]); 61540.9 (target 576.0 [False]) | smallness misfit: 119214.1 (target: 11719.0 [False])
Beta cooling evaluation: progress: [210204.3  61540.9]; minimum progress targets: [357309.2 100823.2]
mref changed in  2555  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   2  1.38e-08  2.06e+05  4.72e+09  2.07e+05    2.10e+01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 88482.6 (target 576.0 [False]); 11937.2 (target 576.0 [False]) | smallness misfit: 93333.4 (target: 11719.0 [False])
Beta cooling evaluation: progress: [88482.6 11937.2]; minimum progress targets: [168163.4  49232.7]
mref changed in  1101  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   3  1.38e-08  8.66e+04  4.94e+09  8.66e+04    2.02e+01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 5187.1 (target 576.0 [False]); 490.5 (target 576.0 [True]) | smallness misfit: 70235.5 (target: 11719.0 [False])
Updating scaling for data misfits by  1.1742880694019584
New scales: [0.97864821 0.02135179]
Beta cooling evaluation: progress: [5187.1  490.5]; minimum progress targets: [70786.1  9549.8]
mref changed in  585  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   4  1.38e-08  5.09e+03  5.14e+09  5.16e+03    1.87e+01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 177.4 (target 576.0 [True]); 68.8 (target 576.0 [True]) | smallness misfit: 63591.2 (target: 11719.0 [False])
Beta cooling evaluation: progress: [177.4  68.8]; minimum progress targets: [4149.6  691.2]
Warming alpha_pgi to favor clustering:  5.811394880185052
mref changed in  157  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   5  1.38e-08  1.75e+02  5.61e+09  2.53e+02    1.99e+01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 166.4 (target 576.0 [True]); 42.3 (target 576.0 [True]) | smallness misfit: 58842.6 (target: 11719.0 [False])
Beta cooling evaluation: progress: [166.4  42.3]; minimum progress targets: [691.2 691.2]
Warming alpha_pgi to favor clustering:  49.58099161234084
mref changed in  14  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   6  1.38e-08  1.64e+02  8.51e+09  2.81e+02    3.81e+01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 157.3 (target 576.0 [True]); 223.1 (target 576.0 [True]) | smallness misfit: 45846.5 (target: 11719.0 [False])
Beta cooling evaluation: progress: [157.3 223.1]; minimum progress targets: [691.2 691.2]
Warming alpha_pgi to favor clustering:  154.79167783274733
mref changed in  18  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   7  1.38e-08  1.59e+02  1.41e+10  3.53e+02    2.02e+01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 164.2 (target 576.0 [True]); 140.5 (target 576.0 [True]) | smallness misfit: 37206.4 (target: 11719.0 [False])
Beta cooling evaluation: progress: [164.2 140.5]; minimum progress targets: [691.2 691.2]
Warming alpha_pgi to favor clustering:  588.8006720308646
mref changed in  1  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   8  1.38e-08  1.64e+02  3.20e+10  6.06e+02    1.73e+01      1              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 177.0 (target 576.0 [True]); 321.8 (target 576.0 [True]) | smallness misfit: 17587.1 (target: 11719.0 [False])
Beta cooling evaluation: progress: [177.  321.8]; minimum progress targets: [691.2 691.2]
Warming alpha_pgi to favor clustering:  1485.008396242765
mref changed in  0  places
Add mref to Smoothness. Changes in mref happened in 0.0 % of the cells
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   9  1.38e-08  1.80e+02  4.37e+10  7.84e+02    2.25e+01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 249.9 (target 576.0 [True]); 856.0 (target 576.0 [False]) | smallness misfit: 12697.4 (target: 11719.0 [False])
Updating scaling for data misfits by  2.3051366054747797
New scales: [0.95211561 0.04788439]
Beta cooling evaluation: progress: [249.9 856. ]; minimum progress targets: [691.2 691.2]
Decreasing beta to counter data misfit increase.
mref changed in  0  places
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  10  6.91e-09  2.79e+02  3.39e+10  5.13e+02    2.94e+01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 186.0 (target 576.0 [True]); 229.4 (target 576.0 [True]) | smallness misfit: 12420.1 (target: 11719.0 [False])
Beta cooling evaluation: progress: [186.  229.4]; minimum progress targets: [691.2 691.2]
Warming alpha_pgi to favor clustering:  4163.436201016231
mref changed in  0  places
Add mref to Smoothness. Changes in mref happened in 0.0 % of the cells
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  11  6.91e-09  1.88e+02  9.37e+10  8.35e+02    2.76e+01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.
  warnings.warn(
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>geophys. misfits: 298.4 (target 576.0 [True]); 554.8 (target 576.0 [True]) | smallness misfit: 10773.2 (target: 11719.0 [True])
All targets have been reached
Beta cooling evaluation: progress: [298.4 554.8]; minimum progress targets: [691.2 691.2]
Warming alpha_pgi to favor clustering:  6179.66475005224
mref changed in  0  places
Add mref to Smoothness. Changes in mref happened in 0.0 % of the cells
------------------------- STOP! -------------------------
1 : |fc-fOld| = 0.0000e+00 &lt;= tolF*(1+|f0|) = 4.2473e+05
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>0 : |xc-x_last| = 7.3188e-01 &lt;= tolX*(1+|x0|) = 1.0153e-01
0 : |proj(x-g)-x|    = 2.7320e+01 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 2.7320e+01 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =      30    &lt;= iter          =     12
------------------------- DONE! -------------------------
</span></code></pre></div><img src="/user-tutorials/build/e33abf5acccb23a70fa3bd1ad7293385.png" alt="&lt;Figure size 1500x1000 with 12 Axes&gt;"/><img src="/user-tutorials/build/3dd0fe73b42dbc23a834a1ea0ef45889.png" alt="&lt;Figure size 1000x1000 with 4 Axes&gt;"/></div></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/plot-inv-1-joint-pf-pgi-full-info-tutorial"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">PGI Inversion</div>Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/contributing-index"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">PGI Inversion</div>Contributing to User Tutorials</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/user-tutorials/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/user-tutorials/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/user-tutorials/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/plot-inv-2-joint-pf-pgi-no-info-tutorial","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.3","title":"SimPEG User Tutorials","options":{"logo":"/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png","logo_text":"User Tutorials","analytics_plausible":"simpeg.xyz"},"nav":[{"title":"SimPEG","children":[{"title":"Project website","url":"https://simpeg.xyz"},{"title":"Documentation","url":"https://docs.simpeg.xyz"}]}],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide","internal":false,"static":false}],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/user-tutorials"},"routes/$":{"config":{"version":2,"myst":"1.6.3","title":"SimPEG User Tutorials","options":{"logo":"/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png","logo_text":"User Tutorials","analytics_plausible":"simpeg.xyz"},"nav":[{"title":"SimPEG","children":[{"title":"Project website","url":"https://simpeg.xyz"},{"title":"Documentation","url":"https://docs.simpeg.xyz"}]}],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide","internal":false,"static":false}],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"a77dbf50df4db79dcd435f494629c9a0767db35c3265f80c4100882c8dcc634f","slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","location":"/notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb","dependencies":[],"frontmatter":{"title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]}],"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/simpeg/user-tutorials","subject":"SimPEG User Tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/simpeg/user-tutorials/blob/main/notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb","edit_url":"https://github.com/simpeg/user-tutorials/edit/main/notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb","exports":[{"format":"ipynb","filename":"plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb","url":"/user-tutorials/build/plot_inv_2_joint_pf_-70c9d601e124a47ddf1c1169a32d42bd.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2025-05-23T18:02:47.261780Z","iopub.status.busy":"2025-05-23T18:02:47.261313Z","iopub.status.idle":"2025-05-23T18:02:47.866922Z","shell.execute_reply":"2025-05-23T18:02:47.866372Z"},"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline","key":"NhCJenGkGD"},{"type":"output","id":"nYeJxwUY1aG1bJbkYqvhX","data":[],"key":"NMh6H2AtB0"}],"key":"tJZGEpSrfr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This tutorial shows through a joint inversion of Gravity and Magnetic data on an\nOctree mesh how to use the PGI framework introduced in Astic \u0026 Oldenburg (2019)\nand Astic et al. (2021) to make geologic assumptions and learn a suitable\npetrophysical distribution when no quantitative petrophysical information is\navailable.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T8lJJShRAg"}],"key":"r0AcRmoH28"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Thibaut Astic, Douglas W. Oldenburg,\nA framework for petrophysically and geologically guided geophysical inversion\nusing a dynamic Gaussian mixture model prior, Geophysical Journal International,\nVolume 219, Issue 3, December 2019, Pages 1989–2012, DOI:\n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"iWA4L6Af7y"},{"type":"inlineCode","value":"10.1093/gji/ggz389 \u003chttps://doi.org/10.1093/gji/ggz389\u003e","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tjur1E72uy"},{"type":"text","value":"_.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HZThipodYq"}],"key":"WA7trGJrka"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Thibaut Astic, Lindsey J. Heagy, Douglas W Oldenburg,\nPetrophysically and geologically guided multi-physics inversion using a dynamic\nGaussian mixture model, Geophysical Journal International,\nVolume 224, Issue 1, January 2021, Pages 40-68, DOI: ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"J2sjWPdB0E"},{"type":"inlineCode","value":"10.1093/gji/ggaa378 \u003chttps://doi.org/10.1093/gji/ggaa378\u003e","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CoMpXj9kX3"},{"type":"text","value":"_.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"HZSgv8mNX0"}],"key":"FP18sr21Ny"}],"key":"VMIBX9AUsk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import modules","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QXNVZH6SPi"}],"identifier":"import-modules","label":"Import modules","html_id":"import-modules","implicit":true,"key":"ZdsSJDfKqN"}],"key":"qBr2xkgrWp"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2025-05-23T18:02:47.870499Z","iopub.status.busy":"2025-05-23T18:02:47.870216Z","iopub.status.idle":"2025-05-23T18:02:49.063463Z","shell.execute_reply":"2025-05-23T18:02:49.062540Z"},"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"from discretize import TreeMesh\nfrom discretize.utils import active_from_xyz\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport simpeg.potential_fields as pf\nfrom simpeg import (\n    data_misfit,\n    directives,\n    inverse_problem,\n    inversion,\n    maps,\n    optimization,\n    regularization,\n    utils,\n)\nfrom simpeg.utils import io_utils","key":"vvaDHBER2w"},{"type":"output","id":"i1arZufQ0oh0G6UIsuY-S","data":[],"key":"MVf7zbz84w"}],"key":"M5FaSuViPv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Setup","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mEwiSnNgHB"}],"identifier":"setup","label":"Setup","html_id":"setup","implicit":true,"key":"gDxkUxEDqB"}],"key":"I5LSm0UW9p"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2025-05-23T18:02:49.067759Z","iopub.status.busy":"2025-05-23T18:02:49.067265Z","iopub.status.idle":"2025-05-23T18:02:57.650881Z","shell.execute_reply":"2025-05-23T18:02:57.649809Z"},"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Load Mesh\nmesh_file = io_utils.download(\n    \"https://storage.googleapis.com/simpeg/pgi_tutorial_assets/mesh_tutorial.ubc\"\n)\nmesh = TreeMesh.read_UBC(mesh_file)\n\n# Load True geological model for comparison with inversion result\ntrue_geology_file = io_utils.download(\n    \"https://storage.googleapis.com/simpeg/pgi_tutorial_assets/geology_true.mod\"\n)\ntrue_geology = mesh.read_model_UBC(true_geology_file)\n\n# Plot true geology model\nfig, ax = plt.subplots(1, 4, figsize=(20, 4))\nticksize, labelsize = 14, 16\nfor _, axx in enumerate(ax):\n    axx.set_aspect(1)\n    axx.tick_params(labelsize=ticksize)\nmesh.plot_slice(\n    true_geology,\n    normal=\"X\",\n    ax=ax[0],\n    ind=-17,\n    clim=[0, 2],\n    pcolor_opts={\"cmap\": \"inferno_r\"},\n    grid=True,\n)\nmesh.plot_slice(\n    true_geology,\n    normal=\"Y\",\n    ax=ax[1],\n    clim=[0, 2],\n    pcolor_opts={\"cmap\": \"inferno_r\"},\n    grid=True,\n)\ngeoplot = mesh.plot_slice(\n    true_geology,\n    normal=\"Z\",\n    ax=ax[2],\n    clim=[0, 2],\n    ind=-10,\n    pcolor_opts={\"cmap\": \"inferno_r\"},\n    grid=True,\n)\ngeocb = plt.colorbar(geoplot[0], cax=ax[3], ticks=[0, 1, 2])\ngeocb.set_label(\n    \"True geology model\\n(classification/density/mag. susc.)\", fontsize=labelsize\n)\ngeocb.set_ticklabels(\n    [\"BCKGRD (0 g/cc; 0 SI)\", \"PK (-0.8 g/cc; 5e-3 SI)\", \"VK (-0.2 g/cc; 2e-2 SI)\"]\n)\ngeocb.ax.tick_params(labelsize=ticksize)\nax[3].set_aspect(10)\nplt.show()\n\n# Load geophysical data\ndata_grav_file = io_utils.download(\n    \"https://storage.googleapis.com/simpeg/pgi_tutorial_assets/gravity_data.obs\"\n)\ndata_grav = io_utils.read_grav3d_ubc(data_grav_file)\ndata_mag_file = io_utils.download(\n    \"https://storage.googleapis.com/simpeg/pgi_tutorial_assets/magnetic_data.obs\"\n)\ndata_mag = io_utils.read_mag3d_ubc(data_mag_file)\n\n# plot data and mesh\nfig, ax = plt.subplots(2, 2, figsize=(15, 10))\nax = ax.reshape(-1)\nplt.gca().set_aspect(\"equal\")\nplt.gca().set_xlim(\n    [\n        data_mag.survey.receiver_locations[:, 0].min(),\n        data_mag.survey.receiver_locations[:, 0].max(),\n    ],\n)\nplt.gca().set_ylim(\n    [\n        data_mag.survey.receiver_locations[:, 1].min(),\n        data_mag.survey.receiver_locations[:, 1].max(),\n    ]\n)\nmesh.plot_slice(\n    np.ones(mesh.nC),\n    normal=\"Z\",\n    ind=int(-10),\n    grid=True,\n    pcolor_opts={\"cmap\": \"Greys\"},\n    ax=ax[0],\n)\nmm = utils.plot2Ddata(\n    data_grav.survey.receiver_locations,\n    -data_grav.dobs,\n    ax=ax[0],\n    level=True,\n    nx=20,\n    ny=20,\n    dataloc=True,\n    ncontour=12,\n    shade=True,\n    contourOpts={\"cmap\": \"Blues_r\", \"alpha\": 0.8},\n    levelOpts={\"colors\": \"k\", \"linewidths\": 0.5, \"linestyles\": \"dashed\"},\n)\nax[0].set_aspect(1)\nax[0].set_title(\n    \"Gravity data values and locations,\\nwith mesh and geology overlays\", fontsize=16\n)\nplt.colorbar(mm[0], cax=ax[2], orientation=\"horizontal\")\nax[2].set_aspect(0.05)\nax[2].set_title(\"mGal\", fontsize=16)\nmesh.plot_slice(\n    np.ones(mesh.nC),\n    normal=\"Z\",\n    ind=int(-10),\n    grid=True,\n    pcolor_opts={\"cmap\": \"Greys\"},\n    ax=ax[1],\n)\nmm = utils.plot2Ddata(\n    data_mag.survey.receiver_locations,\n    data_mag.dobs,\n    ax=ax[1],\n    level=True,\n    nx=20,\n    ny=20,\n    dataloc=True,\n    ncontour=11,\n    shade=True,\n    contourOpts={\"cmap\": \"Reds\", \"alpha\": 0.8},\n    levelOpts={\"colors\": \"k\", \"linewidths\": 0.5, \"linestyles\": \"dashed\"},\n)\nax[1].set_aspect(1)\nax[1].set_title(\n    \"Magnetic data values and locations,\\nwith mesh and geology overlays\", fontsize=16\n)\nplt.colorbar(mm[0], cax=ax[3], orientation=\"horizontal\")\nax[3].set_aspect(0.05)\nax[3].set_title(\"nT\", fontsize=16)\n# overlay true geology model for comparison\nindz = -9\nindslicezplot = mesh.gridCC[:, 2] == mesh.cell_centers_z[indz]\nfor i in range(2):\n    utils.plot2Ddata(\n        mesh.gridCC[indslicezplot][:, [0, 1]],\n        true_geology[indslicezplot],\n        nx=200,\n        ny=200,\n        contourOpts={\"alpha\": 0},\n        clim=[0, 2],\n        ax=ax[i],\n        level=True,\n        ncontour=2,\n        levelOpts={\"colors\": \"k\", \"linewidths\": 2, \"linestyles\": \"--\"},\n        method=\"nearest\",\n    )\nplt.subplots_adjust(hspace=-0.25, wspace=0.1)\nplt.show()\n\n# Load Topo\ntopo_file = io_utils.download(\n    \"https://storage.googleapis.com/simpeg/pgi_tutorial_assets/CDED_Lake_warp.xyz\"\n)\ntopo = np.genfromtxt(topo_file, skip_header=1)\n# find the active cells\nactv = active_from_xyz(mesh, topo, \"CC\")\n# Create active map to go from reduce set to full\nndv = np.nan\nactvMap = maps.InjectActiveCells(mesh, actv, ndv)\nnactv = int(actv.sum())\n\n# Create simulations and data misfits\n# Wires mapping\nwires = maps.Wires((\"den\", actvMap.nP), (\"sus\", actvMap.nP))\ngravmap = actvMap * wires.den\nmagmap = actvMap * wires.sus\nidenMap = maps.IdentityMap(nP=nactv)\n# Grav problem\nsimulation_grav = pf.gravity.simulation.Simulation3DIntegral(\n    survey=data_grav.survey,\n    mesh=mesh,\n    rhoMap=wires.den,\n    active_cells=actv,\n    engine=\"choclo\",\n)\ndmis_grav = data_misfit.L2DataMisfit(data=data_grav, simulation=simulation_grav)\n# Mag problem\nsimulation_mag = pf.magnetics.simulation.Simulation3DIntegral(\n    survey=data_mag.survey,\n    mesh=mesh,\n    chiMap=wires.sus,\n    active_cells=actv,\n    engine=\"choclo\",\n)\ndmis_mag = data_misfit.L2DataMisfit(data=data_mag, simulation=simulation_mag)","key":"U3ZPBZqSMn"},{"type":"output","id":"RzHCKOqNyRkHz1W32KfAc","data":[{"name":"stdout","output_type":"stream","text":"file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/mesh_tutorial.ubc\nDownloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/mesh_tutorial.ubc\n   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/mesh_tutorial.ubc\nDownload completed!\n"},{"name":"stdout","output_type":"stream","text":"file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/geology_true.mod\nDownloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/geology_true.mod\n   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/geology_true.mod\nDownload completed!\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c1d5e0d84d41f1406075fadfee3ee34f","path":"/user-tutorials/build/c1d5e0d84d41f1406075fadfee3ee34f.png"},"text/plain":{"content":"\u003cFigure size 2000x400 with 4 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/gravity_data.obs\nDownloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/gravity_data.obs\n   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/gravity_data.obs\nDownload completed!\nfile already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/magnetic_data.obs\nDownloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/magnetic_data.obs\n"},{"name":"stdout","output_type":"stream","text":"   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/magnetic_data.obs\nDownload completed!\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a42c757f04992a5e8eb0e43c4f2ef7c4","path":"/user-tutorials/build/a42c757f04992a5e8eb0e43c4f2ef7c4.png"},"text/plain":{"content":"\u003cFigure size 1500x1000 with 4 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"file already exists, new file is called /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/CDED_Lake_warp.xyz\nDownloading https://storage.googleapis.com/simpeg/pgi_tutorial_assets/CDED_Lake_warp.xyz\n"},{"name":"stdout","output_type":"stream","text":"   saved to: /home/ssoler/git/user-tutorials/notebooks/12-pgi-inversion/CDED_Lake_warp.xyz\nDownload completed!\n"}],"key":"gkaY2BwJHj"}],"key":"YrHWHibKzs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a joint Data Misfit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"phIRfm4Yny"}],"key":"t7O6Ausit8"}],"key":"DGtE0Bhbi7"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2025-05-23T18:02:57.654879Z","iopub.status.busy":"2025-05-23T18:02:57.654624Z","iopub.status.idle":"2025-05-23T18:02:57.659265Z","shell.execute_reply":"2025-05-23T18:02:57.658680Z"},"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Joint data misfit\ndmis = 0.5 * dmis_grav + 0.5 * dmis_mag\n\n# initial model\nm0 = np.r_[-1e-4 * np.ones(actvMap.nP), 1e-4 * np.ones(actvMap.nP)]","key":"lDya37u3QC"},{"type":"output","id":"nrAsxynKUOgU4UcJQ3Ywy","data":[],"key":"rdx77NwSDd"}],"key":"R8ZH8Jt8rv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion with no petrophysical information about the means","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uo1QyBh43L"}],"identifier":"inversion-with-no-petrophysical-information-about-the-means","label":"Inversion with no petrophysical information about the means","html_id":"inversion-with-no-petrophysical-information-about-the-means","implicit":true,"key":"iu46LTopDR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"In this scenario, we do not know the true petrophysical signature of each rock\nunit. We thus make geologic assumptions to design a coupling term and perform\na multi-physics inversion. in addition to a neutral background, we assume that\none rock unit is only less dense, and the third one is only magnetic. As we\ndo not know their mean petrophysical values. We start with an initial guess\n(-1 g/cc) for the updatable mean density-contrast value of the less dense unit\n(with a fixed susceptibility of 0 SI). The magnetic-contrasting unit’s updatable\nsusceptibility is initialized at a value of 0.1 SI (with a fixed 0 g/cc density\ncontrast). We then let the algorithm learn a suitable set of means under the set\nconstrained (fixed or updatable value), through the kappa argument, denoting our\nconfidences in each initial mean value (high confidence: fixed value; low\nconfidence: updatable value).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UK9A7OWLH2"}],"key":"pBPtCAVtvD"}],"key":"d6Cq1nd4eN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a petrophysical GMM initial guess","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YkI5a2Kh3W"}],"identifier":"create-a-petrophysical-gmm-initial-guess","label":"Create a petrophysical GMM initial guess","html_id":"create-a-petrophysical-gmm-initial-guess","implicit":true,"key":"ZwPiho8Wun"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"The GMM is our representation of the petrophysical and geological information.\nHere, we focus on the petrophysical aspect, with the means and covariances of\nthe physical properties of each rock unit.\nTo generate the data above, the PK unit was populated with a density contrast\nof -0.8 g/cc and a magnetic susceptibility of 0.005 SI. The properties of the\nHK unit were set at -0.2 g/cc and 0.02 SI. But here, we assume we\ndo not have this information. Thus, we start with initial guess for the means\nand confidences kappa such that one unit is only less dense and one unit is only\nmagnetic, both embedded in a neutral background. The covariances matrices are set\nso that we assume petrophysical noise levels of around 0.05 g/cc and 0.001 SI\nfor both unit. The background unit is set at a fixed null contrasts (0 g/cc\n0 SI) with a petrophysical noise level of half of the above.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v0WurxnRCN"}],"key":"sAaXu8uDFP"}],"key":"ogH5hdtUtR"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2025-05-23T18:02:57.662620Z","iopub.status.busy":"2025-05-23T18:02:57.662381Z","iopub.status.idle":"2025-05-23T18:02:59.897692Z","shell.execute_reply":"2025-05-23T18:02:59.896916Z"},"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"gmmref = utils.WeightedGaussianMixture(\n    n_components=3,  # number of rock units: bckgrd, PK, HK\n    mesh=mesh,  # inversion mesh\n    actv=actv,  # actv cells\n    covariance_type=\"diag\",  # diagonal covariances\n)\n# required: initialization with fit\n# fake random samples, size of the mesh\n# number of physical properties: 2 (density and mag.susc)\nrng = np.random.default_rng(seed=518936)\ngmmref.fit(rng.normal(size=(nactv, 2)))\n# set parameters manually\n# set phys. prop means for each unit\ngmmref.means_ = np.c_[\n    [0.0, 0.0],  # BCKGRD density contrast and mag. susc\n    [-1, 0.0],  # PK\n    [0, 0.1],  # HK\n].T\n# set phys. prop covariances for each unit\ngmmref.covariances_ = np.array(\n    [[6e-04, 3.175e-07], [2.4e-03, 1.5e-06], [2.4e-03, 1.5e-06]]\n)\n# important after setting cov. manually: compute precision matrices and cholesky\ngmmref.compute_clusters_precisions()\n# set global proportions; low-impact as long as not 0 or 1 (total=1)\ngmmref.weights_ = np.r_[0.9, 0.075, 0.025]\n\n# Plot the 2D GMM\nax = gmmref.plot_pdf(flag2d=True, plotting_precision=250)\nax[0].set_xlabel(\"Density contrast [g/cc]\")\nax[0].set_ylim([0, 5])\nax[2].set_ylabel(\"magnetic Susceptibility [SI]\")\nax[2].set_xlim([0, 100])\nplt.show()","key":"QTh1Tyw51L"},{"type":"output","id":"SAyCIhciwaD60mT-6PaTn","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1270df2167da2cf7757c52bbf6bafd8f","path":"/user-tutorials/build/1270df2167da2cf7757c52bbf6bafd8f.png"},"text/plain":{"content":"\u003cFigure size 1000x1000 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"SGoW5CCf0g"}],"key":"cc55va3wk2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inverse problem with no mean information","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yn2jInqLmY"}],"identifier":"inverse-problem-with-no-mean-information","label":"Inverse problem with no mean information","html_id":"inverse-problem-with-no-mean-information","implicit":true,"key":"GkPKeQG5rn"}],"key":"nRoUAHBpSE"},{"type":"block","kind":"notebook-code","data":{"collapsed":false,"execution":{"iopub.execute_input":"2025-05-23T18:02:59.900954Z","iopub.status.busy":"2025-05-23T18:02:59.900741Z","iopub.status.idle":"2025-05-23T18:04:28.912202Z","shell.execute_reply":"2025-05-23T18:04:28.911534Z"},"jupyter":{"outputs_hidden":false}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create PGI regularization\n# Sensitivity weighting\nwr_grav = np.sum(simulation_grav.G**2.0, axis=0) ** 0.5 / (mesh.cell_volumes[actv])\nwr_grav = wr_grav / np.max(wr_grav)\n\nwr_mag = np.sum(simulation_mag.G**2.0, axis=0) ** 0.5 / (mesh.cell_volumes[actv])\nwr_mag = wr_mag / np.max(wr_mag)\n\n# create joint PGI regularization with smoothness\nreg = regularization.PGI(\n    gmmref=gmmref,\n    mesh=mesh,\n    wiresmap=wires,\n    maplist=[idenMap, idenMap],\n    active_cells=actv,\n    alpha_pgi=1.0,\n    alpha_x=1.0,\n    alpha_y=1.0,\n    alpha_z=1.0,\n    alpha_xx=0.0,\n    alpha_yy=0.0,\n    alpha_zz=0.0,\n    # use the classification of the initial model (here, all background unit)\n    # as initial reference model\n    reference_model=utils.mkvc(\n        gmmref.means_[gmmref.predict(m0.reshape(actvMap.nP, -1))]\n    ),\n    weights_list=[wr_grav, wr_mag],  # weights each phys. prop. by correct sensW\n)\n\n# Directives\n# Add directives to the inversion\n# ratio to use for each phys prop. smoothness in each direction:\n# roughly the ratio of range of each phys. prop.\nalpha0_ratio = np.r_[\n    1e-2 * np.ones(len(reg.objfcts[1].objfcts[1:])),\n    1e-2 * 100.0 * np.ones(len(reg.objfcts[2].objfcts[1:])),\n]\nAlphas = directives.AlphasSmoothEstimate_ByEig(alpha0_ratio=alpha0_ratio, verbose=True)\n# initialize beta and beta/alpha_s schedule\nbeta = directives.BetaEstimate_ByEig(beta0_ratio=1e-4)\nbetaIt = directives.PGI_BetaAlphaSchedule(\n    verbose=True,\n    coolingFactor=2.0,\n    tolerance=0.2,\n    progress=0.2,\n)\n# geophy. and petro. target misfits\ntargets = directives.MultiTargetMisfits(\n    verbose=True,\n    chiSmall=0.5,  # ask for twice as much clustering (target value is /2)\n)\n# add learned mref in smooth once stable\nMrefInSmooth = directives.PGI_AddMrefInSmooth(\n    wait_till_stable=True,\n    verbose=True,\n)\n# update the parameters in smallness (L2-approx of PGI)\nupdate_smallness = directives.PGI_UpdateParameters(\n    update_gmm=True,  # update the GMM each iteration\n    kappa=np.c_[  # confidences in each mean phys. prop. of each cluster\n        1e10\n        * np.ones(\n            2\n        ),  # fixed background at 0 density, 0 mag. susc. (high confidences of 1e10)\n        [\n            0,\n            1e10,\n        ],  # density-contrasting cluster: updatable density mean, fixed mag. susc.\n        [\n            1e10,\n            0,\n        ],  # magnetic-contrasting cluster: fixed density mean, updatable mag. susc.\n    ].T,\n)\n# pre-conditioner\nupdate_Jacobi = directives.UpdatePreconditioner()\n# iteratively balance the scaling of the data misfits\nscaling_init = directives.ScalingMultipleDataMisfits_ByEig(chi0_ratio=[1.0, 100.0])\nscale_schedule = directives.JointScalingSchedule(verbose=True)\n\n# Create inverse problem\n# Optimization\n# set lower and upper bounds\nlowerbound = np.r_[-2.0 * np.ones(actvMap.nP), 0.0 * np.ones(actvMap.nP)]\nupperbound = np.r_[0.0 * np.ones(actvMap.nP), 1e-1 * np.ones(actvMap.nP)]\nopt = optimization.ProjectedGNCG(\n    maxIter=30,\n    lower=lowerbound,\n    upper=upperbound,\n    maxIterLS=20,\n    maxIterCG=100,\n    tolCG=1e-4,\n)\n# create inverse problem\ninvProb = inverse_problem.BaseInvProblem(dmis, reg, opt)\ninv = inversion.BaseInversion(\n    invProb,\n    # directives: evaluate alphas (and data misfits scales) before beta\n    directiveList=[\n        Alphas,\n        scaling_init,\n        beta,\n        update_smallness,\n        targets,\n        scale_schedule,\n        betaIt,\n        MrefInSmooth,\n        update_Jacobi,\n    ],\n)\n# Invert\npgi_model_no_info = inv.run(m0)\n\n\n# Plot the result with full petrophysical information\ndensity_model_no_info = gravmap * pgi_model_no_info\nmagsus_model_no_info = magmap * pgi_model_no_info\nlearned_gmm = reg.objfcts[0].gmm\nquasi_geology_model_no_info = actvMap * reg.objfcts[0].compute_quasi_geology_model()\n\nfig, ax = plt.subplots(3, 4, figsize=(15, 10))\nfor _, axx in enumerate(ax):\n    for _, axxx in enumerate(axx):\n        axxx.set_aspect(1)\n        axxx.tick_params(labelsize=ticksize)\n\nindx = 15\nindy = 17\nindz = -9\n# geology model\nmesh.plot_slice(\n    quasi_geology_model_no_info,\n    normal=\"X\",\n    ax=ax[0, 0],\n    clim=[0, 2],\n    ind=indx,\n    pcolor_opts={\"cmap\": \"inferno_r\"},\n)\nmesh.plot_slice(\n    quasi_geology_model_no_info,\n    normal=\"Y\",\n    ax=ax[0, 1],\n    clim=[0, 2],\n    ind=indy,\n    pcolor_opts={\"cmap\": \"inferno_r\"},\n)\ngeoplot = mesh.plot_slice(\n    quasi_geology_model_no_info,\n    normal=\"Z\",\n    ax=ax[0, 2],\n    clim=[0, 2],\n    ind=indz,\n    pcolor_opts={\"cmap\": \"inferno_r\"},\n)\ngeocb = plt.colorbar(geoplot[0], cax=ax[0, 3], ticks=[0, 1, 2])\ngeocb.set_ticklabels([\"BCK\", \"PK\", \"VK\"])\ngeocb.set_label(\"Quasi-Geology model\\n(Rock units classification)\", fontsize=16)\nax[0, 3].set_aspect(10)\n\n# gravity model\nmesh.plot_slice(\n    density_model_no_info,\n    normal=\"X\",\n    ax=ax[1, 0],\n    clim=[-1, 0],\n    ind=indx,\n    pcolor_opts={\"cmap\": \"Blues_r\"},\n)\nmesh.plot_slice(\n    density_model_no_info,\n    normal=\"Y\",\n    ax=ax[1, 1],\n    clim=[-1, 0],\n    ind=indy,\n    pcolor_opts={\"cmap\": \"Blues_r\"},\n)\ndenplot = mesh.plot_slice(\n    density_model_no_info,\n    normal=\"Z\",\n    ax=ax[1, 2],\n    clim=[-1, 0],\n    ind=indz,\n    pcolor_opts={\"cmap\": \"Blues_r\"},\n)\ndencb = plt.colorbar(denplot[0], cax=ax[1, 3])\ndencb.set_label(\"Density contrast\\nmodel (g/cc)\", fontsize=16)\nax[1, 3].set_aspect(10)\n\n# magnetic model\nmesh.plot_slice(\n    magsus_model_no_info,\n    normal=\"X\",\n    ax=ax[2, 0],\n    clim=[0, 0.025],\n    ind=indx,\n    pcolor_opts={\"cmap\": \"Reds\"},\n)\nmesh.plot_slice(\n    magsus_model_no_info,\n    normal=\"Y\",\n    ax=ax[2, 1],\n    clim=[0, 0.025],\n    ind=indy,\n    pcolor_opts={\"cmap\": \"Reds\"},\n)\nsusplot = mesh.plot_slice(\n    magsus_model_no_info,\n    normal=\"Z\",\n    ax=ax[2, 2],\n    clim=[0, 0.025],\n    ind=indz,\n    pcolor_opts={\"cmap\": \"Reds\"},\n)\nsuscb = plt.colorbar(susplot[0], cax=ax[2, 3])\nsuscb.set_label(\"Magnetic susceptibility\\nmodel (SI)\", fontsize=16)\nax[2, 3].set_aspect(10)\n\n# overlay true geology model for comparison\nindslicexplot = mesh.gridCC[:, 0] == mesh.cell_centers_x[indx]\nindsliceyplot = mesh.gridCC[:, 1] == mesh.cell_centers_y[indy]\nindslicezplot = mesh.gridCC[:, 2] == mesh.cell_centers_z[indz]\nfor i in range(3):\n    for j, (plane, indd) in enumerate(\n        zip([[1, 2], [0, 2], [0, 1]], [indslicexplot, indsliceyplot, indslicezplot])\n    ):\n        utils.plot2Ddata(\n            mesh.gridCC[indd][:, plane],\n            true_geology[indd],\n            nx=100,\n            ny=100,\n            contourOpts={\"alpha\": 0},\n            clim=[0, 2],\n            ax=ax[i, j],\n            level=True,\n            ncontour=2,\n            levelOpts={\"colors\": \"grey\", \"linewidths\": 2, \"linestyles\": \"--\"},\n            method=\"nearest\",\n        )\n\n# plot the locations of the cross-sections\nfor i in range(3):\n    ax[i, 0].plot(\n        mesh.cell_centers_y[indy] * np.ones(2), [-300, 500], c=\"k\", linestyle=\"dotted\"\n    )\n    ax[i, 0].plot(\n        [\n            data_mag.survey.receiver_locations[:, 1].min(),\n            data_mag.survey.receiver_locations[:, 1].max(),\n        ],\n        mesh.cell_centers_z[indz] * np.ones(2),\n        c=\"k\",\n        linestyle=\"dotted\",\n    )\n    ax[i, 0].set_xlim(\n        [\n            data_mag.survey.receiver_locations[:, 1].min(),\n            data_mag.survey.receiver_locations[:, 1].max(),\n        ],\n    )\n\n    ax[i, 1].plot(\n        mesh.cell_centers_x[indx] * np.ones(2), [-300, 500], c=\"k\", linestyle=\"dotted\"\n    )\n    ax[i, 1].plot(\n        [\n            data_mag.survey.receiver_locations[:, 0].min(),\n            data_mag.survey.receiver_locations[:, 0].max(),\n        ],\n        mesh.cell_centers_z[indz] * np.ones(2),\n        c=\"k\",\n        linestyle=\"dotted\",\n    )\n    ax[i, 1].set_xlim(\n        [\n            data_mag.survey.receiver_locations[:, 0].min(),\n            data_mag.survey.receiver_locations[:, 0].max(),\n        ],\n    )\n\n    ax[i, 2].plot(\n        mesh.cell_centers_x[indx] * np.ones(2),\n        [\n            data_mag.survey.receiver_locations[:, 1].min(),\n            data_mag.survey.receiver_locations[:, 1].max(),\n        ],\n        c=\"k\",\n        linestyle=\"dotted\",\n    )\n    ax[i, 2].plot(\n        [\n            data_mag.survey.receiver_locations[:, 0].min(),\n            data_mag.survey.receiver_locations[:, 0].max(),\n        ],\n        mesh.cell_centers_y[indy] * np.ones(2),\n        c=\"k\",\n        linestyle=\"dotted\",\n    )\n    ax[i, 2].set_xlim(\n        [\n            data_mag.survey.receiver_locations[:, 0].min(),\n            data_mag.survey.receiver_locations[:, 0].max(),\n        ],\n    )\n    ax[i, 2].set_ylim(\n        [\n            data_mag.survey.receiver_locations[:, 1].min(),\n            data_mag.survey.receiver_locations[:, 1].max(),\n        ],\n    )\n\nplt.tight_layout()\nplt.show()\n\n# Plot the learned 2D GMM\nfig = plt.figure(figsize=(10, 10))\nax0 = plt.subplot2grid((4, 4), (3, 1), colspan=3)\nax1 = plt.subplot2grid((4, 4), (0, 1), colspan=3, rowspan=3)\nax2 = plt.subplot2grid((4, 4), (0, 0), rowspan=3)\nax = [ax0, ax1, ax2]\nlearned_gmm.plot_pdf(flag2d=True, ax=ax, padding=1, plotting_precision=100)\nax[0].set_xlabel(\"Density contrast [g/cc]\")\nax[0].set_ylim([0, 5])\nax[2].set_xlim([0, 50])\nax[2].set_ylabel(\"magnetic Susceptibility [SI]\")\nax[1].scatter(\n    density_model_no_info[actv],\n    magsus_model_no_info[actv],\n    c=quasi_geology_model_no_info[actv],\n    cmap=\"inferno_r\",\n    edgecolors=\"k\",\n    label=\"recovered PGI model\",\n    alpha=0.5,\n)\nax[0].hist(density_model_no_info[actv], density=True, bins=50)\nax[2].hist(magsus_model_no_info[actv], density=True, bins=50, orientation=\"horizontal\")\nax[1].scatter(\n    [0, -0.8, -0.02],\n    [0, 0.005, 0.02],\n    label=\"True petrophysical means\",\n    cmap=\"inferno_r\",\n    c=[0, 1, 2],\n    marker=\"v\",\n    edgecolors=\"k\",\n    s=200,\n)\nax[1].legend()\nplt.show()","key":"ksQYhzxQdJ"},{"type":"output","id":"A6dLt64ktWYQ5UCUN8BAb","data":[{"name":"stdout","output_type":"stream","text":"\nRunning inversion with SimPEG v0.24.0\n\n                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.\n                    ***Done using the default solver Pardiso and no solver_opts.***\n                    \n"},{"name":"stdout","output_type":"stream","text":"Alpha scales: [np.float64(7660874.184294957), np.float64(0.0), np.float64(5073966.905923588), np.float64(0.0), np.float64(10755946.585578023), np.float64(0.0), np.float64(901080732.7168696), np.float64(0.0), np.float64(651184740.4106032), np.float64(0.0), np.float64(1695952133.7691708), np.float64(0.0)]\n"},{"name":"stdout","output_type":"stream","text":"\u003cclass 'simpeg.regularization.pgi.PGIsmallness'\u003e\nInitial data misfit scales:  [0.97501981 0.02498019]\nmodel has any nan: 0\n=============================== Projected GNCG ===============================\n  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   \n-----------------------------------------------------------------------------\nx0 has any nan: 0\n"},{"name":"stdout","output_type":"stream","text":"   0  1.38e-08  4.25e+06  9.99e+04  4.25e+06    2.17e+02      0              \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 446636.5 (target 576.0 [False]); 126029.0 (target 576.0 [False]) | smallness misfit: 136498.4 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [446636.5 126029. ]; minimum progress targets: [3470231.3  572697.8]\nmref changed in  4686  places\n"},{"name":"stdout","output_type":"stream","text":"   1  1.38e-08  4.39e+05  2.02e+09  4.39e+05    2.11e+01      0              \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 210204.3 (target 576.0 [False]); 61540.9 (target 576.0 [False]) | smallness misfit: 119214.1 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [210204.3  61540.9]; minimum progress targets: [357309.2 100823.2]\nmref changed in  2555  places\n"},{"name":"stdout","output_type":"stream","text":"   2  1.38e-08  2.06e+05  4.72e+09  2.07e+05    2.10e+01      0              \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 88482.6 (target 576.0 [False]); 11937.2 (target 576.0 [False]) | smallness misfit: 93333.4 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [88482.6 11937.2]; minimum progress targets: [168163.4  49232.7]\nmref changed in  1101  places\n"},{"name":"stdout","output_type":"stream","text":"   3  1.38e-08  8.66e+04  4.94e+09  8.66e+04    2.02e+01      0   Skip BFGS  \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 5187.1 (target 576.0 [False]); 490.5 (target 576.0 [True]) | smallness misfit: 70235.5 (target: 11719.0 [False])\nUpdating scaling for data misfits by  1.1742880694019584\nNew scales: [0.97864821 0.02135179]\nBeta cooling evaluation: progress: [5187.1  490.5]; minimum progress targets: [70786.1  9549.8]\nmref changed in  585  places\n"},{"name":"stdout","output_type":"stream","text":"   4  1.38e-08  5.09e+03  5.14e+09  5.16e+03    1.87e+01      0   Skip BFGS  \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 177.4 (target 576.0 [True]); 68.8 (target 576.0 [True]) | smallness misfit: 63591.2 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [177.4  68.8]; minimum progress targets: [4149.6  691.2]\nWarming alpha_pgi to favor clustering:  5.811394880185052\nmref changed in  157  places\n"},{"name":"stdout","output_type":"stream","text":"   5  1.38e-08  1.75e+02  5.61e+09  2.53e+02    1.99e+01      0   Skip BFGS  \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 166.4 (target 576.0 [True]); 42.3 (target 576.0 [True]) | smallness misfit: 58842.6 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [166.4  42.3]; minimum progress targets: [691.2 691.2]\nWarming alpha_pgi to favor clustering:  49.58099161234084\nmref changed in  14  places\n"},{"name":"stdout","output_type":"stream","text":"   6  1.38e-08  1.64e+02  8.51e+09  2.81e+02    3.81e+01      0   Skip BFGS  \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 157.3 (target 576.0 [True]); 223.1 (target 576.0 [True]) | smallness misfit: 45846.5 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [157.3 223.1]; minimum progress targets: [691.2 691.2]\nWarming alpha_pgi to favor clustering:  154.79167783274733\nmref changed in  18  places\n"},{"name":"stdout","output_type":"stream","text":"   7  1.38e-08  1.59e+02  1.41e+10  3.53e+02    2.02e+01      0              \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 164.2 (target 576.0 [True]); 140.5 (target 576.0 [True]) | smallness misfit: 37206.4 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [164.2 140.5]; minimum progress targets: [691.2 691.2]\nWarming alpha_pgi to favor clustering:  588.8006720308646\nmref changed in  1  places\n"},{"name":"stdout","output_type":"stream","text":"   8  1.38e-08  1.64e+02  3.20e+10  6.06e+02    1.73e+01      1              \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 177.0 (target 576.0 [True]); 321.8 (target 576.0 [True]) | smallness misfit: 17587.1 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [177.  321.8]; minimum progress targets: [691.2 691.2]\nWarming alpha_pgi to favor clustering:  1485.008396242765\nmref changed in  0  places\nAdd mref to Smoothness. Changes in mref happened in 0.0 % of the cells\n"},{"name":"stdout","output_type":"stream","text":"   9  1.38e-08  1.80e+02  4.37e+10  7.84e+02    2.25e+01      0              \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 249.9 (target 576.0 [True]); 856.0 (target 576.0 [False]) | smallness misfit: 12697.4 (target: 11719.0 [False])\nUpdating scaling for data misfits by  2.3051366054747797\nNew scales: [0.95211561 0.04788439]\nBeta cooling evaluation: progress: [249.9 856. ]; minimum progress targets: [691.2 691.2]\nDecreasing beta to counter data misfit increase.\nmref changed in  0  places\n"},{"name":"stdout","output_type":"stream","text":"  10  6.91e-09  2.79e+02  3.39e+10  5.13e+02    2.94e+01      0              \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 186.0 (target 576.0 [True]); 229.4 (target 576.0 [True]) | smallness misfit: 12420.1 (target: 11719.0 [False])\nBeta cooling evaluation: progress: [186.  229.4]; minimum progress targets: [691.2 691.2]\nWarming alpha_pgi to favor clustering:  4163.436201016231\nmref changed in  0  places\nAdd mref to Smoothness. Changes in mref happened in 0.0 % of the cells\n"},{"name":"stdout","output_type":"stream","text":"  11  6.91e-09  1.88e+02  9.37e+10  8.35e+02    2.76e+01      0              \n"},{"name":"stderr","output_type":"stream","text":"/t40array/ssoler/miniforge3/envs/simpeg-user-tutorials/lib/python3.12/site-packages/sklearn/base.py:474: FutureWarning: `BaseEstimator._validate_data` is deprecated in 1.6 and will be removed in 1.7. Use `sklearn.utils.validation.validate_data` instead. This function becomes public and is part of the scikit-learn developer API.\n  warnings.warn(\n"},{"name":"stdout","output_type":"stream","text":"geophys. misfits: 298.4 (target 576.0 [True]); 554.8 (target 576.0 [True]) | smallness misfit: 10773.2 (target: 11719.0 [True])\nAll targets have been reached\nBeta cooling evaluation: progress: [298.4 554.8]; minimum progress targets: [691.2 691.2]\nWarming alpha_pgi to favor clustering:  6179.66475005224\nmref changed in  0  places\nAdd mref to Smoothness. Changes in mref happened in 0.0 % of the cells\n------------------------- STOP! -------------------------\n1 : |fc-fOld| = 0.0000e+00 \u003c= tolF*(1+|f0|) = 4.2473e+05\n"},{"name":"stdout","output_type":"stream","text":"0 : |xc-x_last| = 7.3188e-01 \u003c= tolX*(1+|x0|) = 1.0153e-01\n0 : |proj(x-g)-x|    = 2.7320e+01 \u003c= tolG          = 1.0000e-01\n0 : |proj(x-g)-x|    = 2.7320e+01 \u003c= 1e3*eps       = 1.0000e-02\n0 : maxIter   =      30    \u003c= iter          =     12\n------------------------- DONE! -------------------------\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e33abf5acccb23a70fa3bd1ad7293385","path":"/user-tutorials/build/e33abf5acccb23a70fa3bd1ad7293385.png"},"text/plain":{"content":"\u003cFigure size 1500x1000 with 12 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3dd0fe73b42dbc23a834a1ea0ef45889","path":"/user-tutorials/build/3dd0fe73b42dbc23a834a1ea0ef45889.png"},"text/plain":{"content":"\u003cFigure size 1000x1000 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"LVnZKV5Vfe"}],"key":"iWqus5zyeo"}],"key":"sFk9dATt1r"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","url":"/plot-inv-1-joint-pf-pgi-full-info-tutorial","group":"PGI Inversion"},"next":{"title":"Contributing to User Tutorials","url":"/contributing-index","group":"PGI Inversion"}}},"domain":"http://localhost:3000"},"project":{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/user-tutorials/build/manifest-ED236704.js";
import * as route0 from "/user-tutorials/build/root-ZJOPFBMV.js";
import * as route1 from "/user-tutorials/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/user-tutorials/build/entry.client-UNPC4GT3.js");</script></body></html>