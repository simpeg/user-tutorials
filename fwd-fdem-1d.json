{"kind":"Notebook","sha256":"9436def6d9ca38cd2dca56d324eb051d0015323ded9ff56f195db5e83f5465b1","slug":"fwd-fdem-1d","location":"/notebooks/07-fdem/fwd_fdem_1d.ipynb","dependencies":[],"frontmatter":{"title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","affiliations":["University of British Columbia"],"id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","affiliations":["University of British Columbia"],"id":"contributors-myst-generated-uid-1"}],"license":{"content":{"id":"CC-BY-4.0","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true,"url":"https://creativecommons.org/licenses/by/4.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"github":"https://github.com/simpeg/user-tutorials","subject":"SimPEG User Tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"University of British Columbia","name":"University of British Columbia"}],"exports":[{"format":"ipynb","filename":"fwd_fdem_1d.ipynb","url":"/user-tutorials/build/fwd_fdem_1d-f841bccb64a144ea3684c1fcfbb805b2.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"admonition","class":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Introductory notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SrHToeVay2"}],"key":"cd8A7FIRI2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial teaches basic functionality within SimPEG and is a good entry point for new users.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tjOXnTjppK"}],"key":"WQfwpq1Xa6"}],"key":"nUobQzqZ11"}],"key":"J263bXkkQK"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"admonition","class":"hint","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Light-weight notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tCT7bxG21U"}],"key":"ZGL8COts6u"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WTIbWyuwqE"}],"key":"koMK3buf9t"}],"key":"QMeRhnekzn"}],"key":"sfKnn7HSIV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Author:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gipuZfAFlA"}],"key":"CpeI6ax8ZO"},{"type":"text","value":" Devin C. Cowan","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"edOwopDOPa"}],"key":"txNbG4eRfj"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Keywords:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RRJ5jgEp6m"}],"key":"dVfQyLVw3P"},{"type":"text","value":" FDEM, forward simulation, 1D sounding, inductive source, wires mapping.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"v2meZyKWNf"}],"key":"FpHIIbyIdN"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Summary:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"FmI8tp8dcp"}],"key":"DBZXvNHCLj"},{"type":"text","value":" In this tutorial, we present the fundamentals of simulating FDEM data in SimPEG. We use the module ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cmZBD8DvSO"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.electromagnetics.frequency_domain.html#module-simpeg.electromagnetics.frequency_domain","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"simpeg​.electromagnetics​.static​.frequency​_domain","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HkKUWtxust"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain","internal":false,"protocol":"xref:sphinx","key":"tjtuarkkWw"},{"type":"text","value":" to simulate FDEM data for a 1D sounding. The ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VNCul7JAhr"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.Simulation1DLayered.html#simpeg.electromagnetics.frequency_domain.Simulation1DLayered","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Simulation1DLayered","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"mipNb4SYSA"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain.simulation_1d.Simulation1DLayered","internal":false,"protocol":"xref:sphinx","key":"cN5lzEFWjH"},{"type":"text","value":" class is used to solve the problem via a semi-analytic Hankel transform solution. Note that almost all of what is learned here can be applied to simulating 3D FDEM data.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"YXtcteLFcw"}],"key":"T9xhf6Vngx"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Learning Objectives:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jK6TMyiIga"}],"key":"Jh7gQc1SKr"}],"key":"NPWbx4HugP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"The fundamentals of simulating FDEM data with SimPEG.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Ulokn4j5mU"}],"key":"SY5k96JyuI"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Understanding the way in which FDEM surveys are created in SimPEG, which includes:","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"uGkOcqtoEo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Defining receivers","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"BHND3iSAXt"}],"key":"sRSYbPbc5d"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Defining controlled sources","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"puMBhhklgl"}],"key":"InkxoSfoGA"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Organizing sources and receivers into a survey object","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"WozluNa5l8"}],"key":"Vcis8kbdka"}],"key":"RXcwOOCMls"}],"key":"bBn7NDVngU"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Defining the Earth’s electrical properties in terms of conductivity OR resistivity.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"vXCxchjYVU"}],"key":"waqfrqOSAt"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"The ways in which we can define 1D layered Earth models.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"hHrWrAqJ8p"}],"key":"ifTWf3jafq"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Defining appropriate mappings from the model parameters to parameters defining the simulation.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"jiBnhR1yCm"}],"key":"xh0jjoBowF"}],"key":"krYgqWLziS"}],"key":"gwlZ0yUfso"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Importing Modules","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iACsK7GCaI"}],"identifier":"importing-modules","label":"Importing Modules","html_id":"importing-modules","implicit":true,"key":"n3ML1E8uC0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here, we import all of the functionality required to run the notebook for the tutorial exercise. All of the functionality specific to FDEM is imported from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vfsjZo31Jo"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.electromagnetics.frequency_domain.html#module-simpeg.electromagnetics.frequency_domain","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simpeg​.electromagnetics​.frequency​_domain","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gd64wPtOoC"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain","internal":false,"protocol":"xref:sphinx","key":"PrPo8LGERz"},{"type":"text","value":".\nWe also import some useful utility functions from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"frDtct2SW2"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.utils.html#module-simpeg.utils","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simpeg.utils","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NDYjtzcdX9"}],"urlSource":"myst:simpeg#simpeg.utils","internal":false,"protocol":"xref:sphinx","key":"VqlW9i6GsN"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"l99m3anvpw"}],"key":"xUz1RyRqj3"}],"key":"Nv2kynCMWz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:01.391368Z","iopub.status.busy":"2024-07-17T18:20:01.390867Z","iopub.status.idle":"2024-07-17T18:20:03.818268Z","shell.execute_reply":"2024-07-17T18:20:03.817420Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# SimPEG functionality\nimport simpeg.electromagnetics.frequency_domain as fdem\nfrom simpeg import maps\nfrom simpeg.utils import plot_1d_layer_model\n\n# Common Python functionality\nimport os\nimport numpy as np\nfrom scipy.constants import mu_0\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\n\nmpl.rcParams.update({\"font.size\": 14})\n\nwrite_output = False  # Optional","key":"eH5tSkHUs9"},{"type":"output","id":"tbE5Do4N08cL6pdweEcNf","data":[],"key":"hAqp6F3AlU"}],"key":"YcegnzB8WO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining the Survey","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IQ5Wiffe6W"}],"identifier":"defining-the-survey","label":"Defining the Survey","html_id":"defining-the-survey","implicit":true,"key":"ncidld4iln"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"FDEM surveys within SimPEG require the user to create and connect three types of objects:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hA5rbMVnGL"}],"key":"nuDkDSrl6K"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"receivers:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OyZUJJ2moP"}],"key":"SO5afU4CY2"},{"type":"text","value":" There are a multitude of FDEM receiver classes within SimPEG, each of which is used to simulate data corresponding to a different field measurement; e.g. ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"b1GmpTLsQ8"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.receivers.PointMagneticField.html#simpeg.electromagnetics.frequency_domain.receivers.pointmagneticfield","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"PointMagneticField","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bTFJCljga0"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain.receivers.PointMagneticField","internal":false,"protocol":"xref:sphinx","key":"d2IBJHZ80d"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"d0MmrYFBAU"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.receivers.PointElectricField.html#simpeg.electromagnetics.frequency_domain.receivers.pointelectricfield","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"PointElectricField","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wuwiVvvMdv"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain.receivers.PointElectricField","internal":false,"protocol":"xref:sphinx","key":"IEl4hrySz9"},{"type":"text","value":". The properties for each FDEM receiver object generally include: the orientation of the field being measured (x, y, z, other), the component (real or imaginary), the data type (field or ppm), and one or more associated observation locations.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DDcTAiroZW"}],"key":"EuQ2kxXvS6"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"sources:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pdeI8QGGor"}],"key":"G826fz5Pgl"},{"type":"text","value":" There are a multitude of FDEM source classes within SimPEG, each of which corresponds to a different geometry; e.g. ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wzgZ1DLCbc"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.sources.MagDipole.html#simpeg.electromagnetics.frequency_domain.sources.magdipole","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"MagDipole","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"qxYX5UoCSW"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain.sources.MagDipole","internal":false,"protocol":"xref:sphinx","key":"TEaBXKl92j"},{"type":"text","value":", ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VmdmyogIOR"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.sources.CircularLoop.html#simpeg.electromagnetics.frequency_domain.sources.circularloop","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"CircularLoop","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"y4jqtjVOya"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain.sources.CircularLoop","internal":false,"protocol":"xref:sphinx","key":"Z3ZIpUyXIU"},{"type":"text","value":" and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pBkIthdTTq"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.sources.LineCurrent.html#simpeg.electromagnetics.frequency_domain.sources.linecurrent","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"LineCurrent","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"C4xiY83KP5"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain.sources.LineCurrent","internal":false,"protocol":"xref:sphinx","key":"B9HndFuqJP"},{"type":"text","value":". Source classes generally require the user to define the operating frequency (in Hz), its location and its geometry.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pA8h3RYDrE"}],"key":"xFVgoDMTax"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"survey:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"K6CkjbIC4L"}],"key":"kjE08u2EN8"},{"type":"text","value":" the object which stores and organizes all of the sources and receivers.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OoyepuSuP5"}],"key":"ep6W3jGBUN"}],"key":"EqySTFqrWL"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"For a full description of all source and receiver classes, please visit API documentation for ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XJeWlLz56V"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.electromagnetics.frequency_domain.html#module-simpeg.electromagnetics.frequency_domain","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"simpeg​.electromagnetics​.frequency​_domain","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UWBW6uJCkQ"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain","internal":false,"protocol":"xref:sphinx","key":"LGOJ3ifO7b"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dSceNYdFUf"}],"key":"C2iWAyeF9x"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Topography:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gMWDE05uug"}],"key":"UxOBwvZcuj"},{"type":"text","value":" When generating the survey for a 1D forward simulation, sources and receivers ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XL3oxqOnnB"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"must","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"eRabrW7EVq"}],"key":"dSNmBMXWUY"},{"type":"text","value":" be located ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"IGXCllBmD3"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"above","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gAnk42TRYz"}],"key":"NdnO9lA0BH"},{"type":"text","value":" the Earth’s surface. By default, the Earth’s surface is at z = 0 m when defining the 1D simulation. So for 1D FDEM problems, it is easiest to define the z-locations of all sources and receivers as flight heights.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vjThm8GLdA"}],"key":"HbzRoyfcxv"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"For this tutorial","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"CjrXL5h0TG"}],"key":"dza0AVcfry"},{"type":"text","value":", the survey consists of a vertical magnetic dipole source operating at 5 frequencies. Real and imaginary data in ppm are measured by a vertically-oriented receiver coil offset 10 m from the source.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"usuWd1vSAO"}],"key":"BZ5aQUjCUw"}],"key":"DxhqIJm88Z"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:03.822582Z","iopub.status.busy":"2024-07-17T18:20:03.822257Z","iopub.status.idle":"2024-07-17T18:20:03.826698Z","shell.execute_reply":"2024-07-17T18:20:03.826076Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Source properties\nfrequencies = np.r_[382, 1822, 7970, 35920, 130100]  # frequencies in Hz\nsource_location = np.array([0.0, 0.0, 30.0])  # (3, ) numpy.array_like\nsource_orientation = \"z\"  # \"x\", \"y\" or \"z\"\nmoment = 1.0  # dipole moment in Am^2\n\n# Receiver properties\nreceiver_locations = np.array([10.0, 0.0, 30.0])  # or (N, 3) numpy.ndarray\nreceiver_orientation = \"z\"  # \"x\", \"y\" or \"z\"\ndata_type = \"ppm\"  # \"secondary\", \"total\" or \"ppm\"","key":"nJgOqZsDxr"},{"type":"output","id":"3Hn2whR2OaRJQ9laPBTWf","data":[],"key":"Z8o1p4dBoK"}],"key":"R7UTmnYRFS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The most general way to generate FDEM surveys is to loop over all sources. A new source object must be created whenever the source location, geometry and/or operating frequencies differs. For each source, we define and assign the associated receivers. A different receiver object must be created whenever geometry or data type differs. However, identical data being collected at a multitude of observation locations can be defined using a single receiver object.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T965N021Cm"}],"key":"g9daYdsTom"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this tutorial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YyRYUTADhn"}],"key":"AOkRTV7VWt"},{"type":"text","value":", the location and geometry of the source remains the same, so we only need to loop over the operating frequencies. And since we have both real and imaginary data, we will need to define two receivers for each source. More complicated survey geometries are used in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YUWmvV0Dyr"},{"type":"link","url":"/user-tutorials/build/fwd_fdem_cyl-d734387f494945fbb4561eaa5e03ed09.ipynb","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"3D Forward Simulation of FDEM Data on Cylindrical Mesh for a Galvanic Source","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xFB9vodRcI"}],"urlSource":"fwd_fdem_cyl.ipynb","static":true,"protocol":"file","key":"y3RuUwHjSm"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YCSMmwjHn6"},{"type":"link","url":"/user-tutorials/build/fwd_fdem_3d-eb0fafb32c5e73b215ffab504ef62c60.ipynb","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Forward Simulation of 3D Airborne FDEM Data on a Tree Mesh","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Lzden5ppvu"}],"urlSource":"fwd_fdem_3d.ipynb","static":true,"protocol":"file","key":"dBKGyxWCCy"},{"type":"text","value":" tutorials.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u2t5pCyqKd"}],"key":"di4mKsCMgj"}],"key":"krUctA11s9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:03.830464Z","iopub.status.busy":"2024-07-17T18:20:03.830233Z","iopub.status.idle":"2024-07-17T18:20:03.836918Z","shell.execute_reply":"2024-07-17T18:20:03.836370Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"source_list = []  # create empty list for source objects\n\n# loop over all sources\nfor freq in frequencies:\n    # Define receivers that measure real and imaginary component\n    # magnetic field data in ppm.\n    receiver_list = []\n    receiver_list.append(\n        fdem.receivers.PointMagneticFieldSecondary(\n            receiver_locations,\n            orientation=receiver_orientation,\n            data_type=data_type,\n            component=\"real\",\n        )\n    )\n    receiver_list.append(\n        fdem.receivers.PointMagneticFieldSecondary(\n            receiver_locations,\n            orientation=receiver_orientation,\n            data_type=data_type,\n            component=\"imag\",\n        )\n    )\n\n    # Define a magnetic dipole source at each frequency\n    source_list.append(\n        fdem.sources.MagDipole(\n            receiver_list=receiver_list,\n            frequency=freq,\n            location=source_location,\n            orientation=source_orientation,\n            moment=moment,\n        )\n    )\n\n# Define the FDEM survey\nsurvey = fdem.survey.Survey(source_list)","key":"v9l7u7Ll5R"},{"type":"output","id":"Wh_fNnwZrPkhfWmJG7rnq","data":[],"key":"ySoJ6uuIEV"}],"key":"e5LN5tc49o"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining a 1D Layered Earth and the Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aVoJEa133z"}],"identifier":"defining-a-1d-layered-earth-and-the-model","label":"Defining a 1D Layered Earth and the Model","html_id":"defining-a-1d-layered-earth-and-the-model","implicit":true,"key":"VfAY7h4a4M"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, a 1D layered Earth is defined by the set of layer thicknesses and the physical properties for each layer. Thicknesses and physical property values are defined from the top layer down. If we have N layers, we define N physical property values and N-1 layer thicknesses. The lowest layer is assumed to extend to infinity. In the case of a halfspace, the layer thicknesses would be an empty array.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jPi3OBfOi8"}],"key":"tol76tQtWm"}],"key":"Ala727zTmt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:03.840019Z","iopub.status.busy":"2024-07-17T18:20:03.839726Z","iopub.status.idle":"2024-07-17T18:20:03.843288Z","shell.execute_reply":"2024-07-17T18:20:03.842725Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define layer thicknesses (m)\nlayer_thicknesses = np.array([20.0, 40.0])\n\n# Define layer conductivities (S/m)\nlayer_conductivities = np.r_[0.1, 1.0, 0.1]\n\n# Define layer susceptibilities (SI)\nlayer_susceptibilities = np.r_[0.0, 4.0, 0.0]","key":"BkdUUr36Hi"},{"type":"output","id":"g6AAGNPNOcQ7rl2nHYiLv","data":[],"key":"DYAdjE2KF2"}],"key":"b1tFCJUSRB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:03.846684Z","iopub.status.busy":"2024-07-17T18:20:03.846389Z","iopub.status.idle":"2024-07-17T18:20:04.319526Z","shell.execute_reply":"2024-07-17T18:20:04.318886Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(8, 5))\n\nax1 = fig.add_axes([0.1, 0.1, 0.3, 0.8])\nax1 = plot_1d_layer_model(layer_thicknesses, layer_conductivities, scale=\"log\", ax=ax1)\nax1.grid(which=\"both\")\nax1.set_xlabel(r\"Conductivity ($S/m$)\")\n\nax2 = fig.add_axes([0.6, 0.1, 0.3, 0.8])\nax2 = plot_1d_layer_model(\n    layer_thicknesses, layer_susceptibilities, scale=\"linear\", ax=ax2\n)\nax2.grid(which=\"both\")\nax2.set_xlim([-0.05, 1.1 * np.max(layer_susceptibilities)])\nax2.set_xlabel(r\"Susceptibility ($SI$)\")\nplt.show()","key":"InXWwNLuQn"},{"type":"output","id":"aexz42IYGf0DHw8JnliTm","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b586e6bac714b6c673c630875f3acbc6","path":"/user-tutorials/build/b586e6bac714b6c673c630875f3acbc6.png"},"text/plain":{"content":"<Figure size 800x500 with 2 Axes>","content_type":"text/plain"}}}],"key":"rt4iLitfIa"}],"key":"PKiWpuGTCQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Models and Mappings for 1D Simulations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SyaEEop0Ul"}],"identifier":"models-and-mappings-for-1d-simulations","label":"Models and Mappings for 1D Simulations","html_id":"models-and-mappings-for-1d-simulations","implicit":true,"key":"CrBYm7rS8a"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, the term ‘model’ is not necessarily synonymous with a set of physical property values. For example, the model may be defined as the logarithms of the physical property values, or be the parameters defining a layered Earth geometry. Models in SimPEG are 1D ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bZoVoVrord"},{"type":"link","url":"https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"numpy.ndarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I4WuUEdUni"}],"urlSource":"myst:numpy#numpy.ndarray","internal":false,"protocol":"xref:sphinx","key":"HECw0emBv2"},{"type":"text","value":" whose lengths are equal to the number of model parameters. For 1D FDEM simulations, we can characterize the Earth’s electric properties according to electrical conductivity or electrical resistivity.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VLEvPbg1W6"}],"key":"NjayvGLsa2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Classes within the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LZr9EoTBWT"},{"type":"inlineCode","value":"simpeg.maps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E4zFZvzIyg"},{"type":"text","value":" module are used to define the mapping that connects the model to the parameters required to run the 1D FDEM simulation; i.e. layer conductivities/resistivities, magnetic permeabilities and/or layer thicknesses. In this tutorial, we demonstrate several types of mappings and models that may be used for 1D FDEM simulation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WXEb0Rvyjc"}],"key":"CsYpA1hG1p"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"CASE 1: Conductivity model.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YXgSHAjkkh"}],"key":"CKFk1P5tGv"},{"type":"text","value":" The easiest case is when the layer thicknesses are fixed in the simulation, and by default we assume the Earth is non-permeable. Here, we define the model as the layer conductivities. And the mapping from the model to the conductivities is defined using the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yXS4adRQXq"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.IdentityMap.html#simpeg.maps.identitymap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"simpeg​.maps​.IdentityMap","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"L3fvuRZbwm"}],"urlSource":"myst:simpeg#simpeg.maps.IdentityMap","internal":false,"protocol":"xref:sphinx","key":"s1Ljqwsu9V"},{"type":"text","value":" class.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rfZYPU8Mau"}],"key":"SOPNgh93iv"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"CASE 2: Log-resistivity model with fixed magnetic permeability.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"G8djN8Un88"}],"key":"hwj7eU7Snn"},{"type":"text","value":" Here, the model parameters are the log-resistivity values for the layers. In addition to fixing the layer thicknesses in the simulation, we need to fix the magnetic permeabilities. In this case, we need a mapping that converts log-resistivities to resistivities. To do this, we use the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Bqt2oNqbUY"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.ExpMap.html#simpeg.maps.expmap","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"simpeg.maps.ExpMap","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JNNTJQeBW9"}],"urlSource":"myst:simpeg#simpeg.maps.ExpMap","internal":false,"protocol":"xref:sphinx","key":"kc9TLoRJag"},{"type":"text","value":" class.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ik9AwKLrLY"}],"key":"KZZeRbUoLc"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"CASE 3: Log-conductivity, magnetic permeability and layer thicknesses.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ItcdLUFzqS"}],"key":"YIIOBCidEK"},{"type":"text","value":" In this case, the model defines log-conductivities, magnetic permeabilities and layer thicknesses. We therefore need mappings that extract each parameter type from the model, and a converts to the appropriate quantity. For this, we require the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"J3rTkNPQvH"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.Wires.html#simpeg.maps.wires","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"simpeg.maps.Wires","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"pMLaT5E2SO"}],"urlSource":"myst:simpeg#simpeg.maps.Wires","internal":false,"protocol":"xref:sphinx","key":"WaICGCJk6r"},{"type":"text","value":" mapping and ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ibJO8Txt28"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.ExpMap.html#simpeg.maps.expmap","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"simpeg.maps.ExpMap","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"T8I9oyzMyF"}],"urlSource":"myst:simpeg#simpeg.maps.ExpMap","internal":false,"protocol":"xref:sphinx","key":"kIKTNFshJ5"},{"type":"text","value":" mapping classes. Note that successive mappings can be chained together using the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"R1A1ikepfX"},{"type":"inlineMath","value":"*","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∗</mo></mrow><annotation encoding=\"application/x-tex\">*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord\">∗</span></span></span></span>","key":"bQnmVMle2C"},{"type":"text","value":" operator.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MIWOgW9plE"}],"key":"fB65v6LzZp"}],"key":"UuEH74YXaN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Models","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lKhtMu6wuR"}],"identifier":"define-the-models","label":"Define the Models","html_id":"define-the-models","implicit":true,"key":"jtOOAUIplf"}],"key":"ZNJYGD28b7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:04.324169Z","iopub.status.busy":"2024-07-17T18:20:04.323823Z","iopub.status.idle":"2024-07-17T18:20:04.328353Z","shell.execute_reply":"2024-07-17T18:20:04.327737Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"n_layers = len(layer_conductivities)\n\n# CASE 1: CONDUCTIVITY MODEL\nconductivity_model = layer_conductivities.copy()\n\n# CASE 2: LOG-RESISTIVITY MODEL\nlog_resistivity_model = np.log(1 / layer_conductivities)\n\n# CASE 3: LOG-CONDUCTIVITY, MAGNETIC PERMEABILITY AND LAYER THICKNESSES\nparametric_model = np.r_[\n    np.log(layer_conductivities), mu_0 * (1 + layer_susceptibilities), layer_thicknesses\n]","key":"v0AaHgbGM5"},{"type":"output","id":"5IGgXBvMWNs5j45f64KAG","data":[],"key":"Zb9GtvIMQ6"}],"key":"SCUv6EtB5C"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Mappings","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jSLAK0WDsT"}],"identifier":"define-the-mappings","label":"Define the Mappings","html_id":"define-the-mappings","implicit":true,"key":"KOzYrJnLzQ"}],"key":"io5jfFvz9g"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:04.332296Z","iopub.status.busy":"2024-07-17T18:20:04.331948Z","iopub.status.idle":"2024-07-17T18:20:04.338337Z","shell.execute_reply":"2024-07-17T18:20:04.337634Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# CASE 1: CONDUCTIVITY MODEL\nconductivity_map = maps.IdentityMap()\n\n# CASE 2: LOG-RESISTIVITY MODEL\nlog_resistivity_map = maps.ExpMap()\n\n# CASE 3: LOG-CONDUCTIVITY, MAGNETIC PERMEABILITY AND LAYER THICKNEESSES\n# Note the ordering in which you defined the model parameters and the\n# order in which you defined the wire mappings matters!!!\nwire_map = maps.Wires(\n    (\"log_conductivity\", n_layers),\n    (\"permeability\", n_layers),\n    (\"thicknesses\", n_layers - 1),\n)\nlog_conductivity_map = maps.ExpMap() * wire_map.log_conductivity\npermeability_map = wire_map.permeability\nthicknesses_map = wire_map.thicknesses","key":"TakhpchOdM"},{"type":"output","id":"qZUFfY0I209eq7LS6g83v","data":[],"key":"TfITBjtGvu"}],"key":"iKOZlbWbJY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining the Forward Simulation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AwI8cemDn0"}],"identifier":"defining-the-forward-simulation","label":"Defining the Forward Simulation","html_id":"defining-the-forward-simulation","implicit":true,"key":"RMGcOy90Vh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In SimPEG, the physics of the forward simulation is defined by creating an instance of an appropriate simulation class. Here, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qFob2DEkJa"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.Simulation1DLayered.html#simpeg.electromagnetics.frequency_domain.simulation1dlayered","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Simulation1DLayered","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ucxLHDT7bE"}],"urlSource":"myst:simpeg#simpeg.electromagnetics.frequency_domain.Simulation1DLayered","internal":false,"protocol":"xref:sphinx","key":"IbQBVE4LrB"},{"type":"text","value":" which simulates the data according to a 1D Hankel transform solution. To fully define the forward simulation, we need to connect the simulation object to:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TZjLPjp3wT"}],"key":"UZSVOmYZDt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"the survey","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BAXSQcH2YS"}],"key":"WSTcn4UJmM"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"the layer thicknesses","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Ma0Fp5mMUH"}],"key":"qK4Ge7OEp6"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"the layer conductivities/resistivities","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dhNy98ujz4"}],"key":"DB65EjF24e"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"the layer magnetic permeabilities (optional)","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"EvIIH4i4NG"}],"key":"LFegN7VXYN"}],"key":"w8HPgpaq6i"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This is accomplished by setting each one of the aforementioned items as a property of the simulation object. Since the parameters defining the model in each case are different, we must define a separate simulation object for each case.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gop8jxPKrE"}],"key":"tUII60mrut"}],"key":"hJd6j4FYdM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"CASE 1: Conductivity model.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GU68Ds3Lo3"}],"key":"qFPo6JOWuS"},{"type":"text","value":" Here, the model parameters are the layer conductivities. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jb7Ku0cX4P"},{"type":"inlineCode","value":"sigmaMap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cdiAfcWYlZ"},{"type":"text","value":" is used to define the mapping from the model to the layer conductivities. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VQxyZD7UB1"},{"type":"inlineCode","value":"thicknessess","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZIbgIVVUIp"},{"type":"text","value":" is used to set the layer thicknesses as static parameters of the simulation. By default, the simulation assumes the Earth is non-permeable and we do not have to set this property.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o8OAaYSFnz"}],"key":"bFTv6Bu7wT"}],"key":"AdpsXqFnfs"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:04.341814Z","iopub.status.busy":"2024-07-17T18:20:04.341505Z","iopub.status.idle":"2024-07-17T18:20:04.348273Z","shell.execute_reply":"2024-07-17T18:20:04.347644Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation_conductivity = fdem.Simulation1DLayered(\n    survey=survey,\n    thicknesses=layer_thicknesses,\n    sigmaMap=conductivity_map,\n)","key":"OCcZinzoNN"},{"type":"output","id":"ukc-_HIJxXeYkwdze0ZBO","data":[],"key":"LRJWhca2GD"}],"key":"YtoA9swhCq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"CASE 2: Log-resistivity model with fixed magnetic permeability.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MxWMzunXOt"}],"key":"jf89YUqyUb"},{"type":"text","value":" Here, the model parameters are the log-resistivities of the layers. Because we are now working with electric resistivity, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XqgxM7ddCd"},{"type":"inlineCode","value":"rhoMap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PZDR1mOQji"},{"type":"text","value":" is used to define the mapping for the Earth’s electrical properties; i.e. model parameters to layer resistivities. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XNfI6mB4Ez"},{"type":"inlineCode","value":"thicknessess","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eOvAYSkEOf"},{"type":"text","value":" is used to set the layer thicknesses as static parameters in the simulation. Likewise, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pQ3nJUC0IR"},{"type":"inlineCode","value":"mu","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a8CZuWlH9i"},{"type":"text","value":" is used to set the magnetic permeabilities.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IaoVVyl9Wr"}],"key":"edkmM0wScV"}],"key":"WrYviPGMPa"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:04.351730Z","iopub.status.busy":"2024-07-17T18:20:04.351500Z","iopub.status.idle":"2024-07-17T18:20:04.355780Z","shell.execute_reply":"2024-07-17T18:20:04.355114Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation_log_resistivity = fdem.Simulation1DLayered(\n    survey=survey,\n    thicknesses=layer_thicknesses,\n    rhoMap=log_resistivity_map,\n)","key":"moZPoJrTuY"},{"type":"output","id":"XYR6fvpwEQ10WineZ3dat","data":[],"key":"MzigzbQEIz"}],"key":"qbyk29447E"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"CASE 3: Log-conductivity, magnetic permeability and layer thicknesses.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eMSkjjI72o"}],"key":"bXTPfwPNUj"},{"type":"text","value":" Here, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nVlCzhD7Xo"},{"type":"inlineCode","value":"sigmaMap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gOIDU3z24V"},{"type":"text","value":" is used to define the mapping from the model to the layer conductivities. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F04oS3TaHI"},{"type":"inlineCode","value":"muMap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PYvekD4TzA"},{"type":"text","value":" is used to define the mapping from the model to the layer permeabilities. And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RpTrZ0wF8P"},{"type":"inlineCode","value":"thicknessesMap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TcmNkkwCkG"},{"type":"text","value":" is used to define the mapping from the model to the layer thicknesses.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hb85FzjpOo"}],"key":"wWnN2u2WSv"}],"key":"QSZhW18QIN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:04.359591Z","iopub.status.busy":"2024-07-17T18:20:04.359307Z","iopub.status.idle":"2024-07-17T18:20:04.364135Z","shell.execute_reply":"2024-07-17T18:20:04.363421Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation_parametric = fdem.Simulation1DLayered(\n    survey=survey,\n    thicknessesMap=thicknesses_map,\n    sigmaMap=log_conductivity_map,\n    muMap=permeability_map,\n)","key":"vnCRwu1evU"},{"type":"output","id":"6FUpQ4YaX1_m1A8TCHGSY","data":[],"key":"J5vwPywA84"}],"key":"v8K0VmaNxh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Predict 1D FDEM Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HEoHOVLlXY"}],"identifier":"predict-1d-fdem-data","label":"Predict 1D FDEM Data","html_id":"predict-1d-fdem-data","implicit":true,"key":"YEMUWG4UUc"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Once any simulation within SimPEG has been properly constructed, simulated data for a given model vector can be computed using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oGaZmdbId1"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.simulation.BaseSimulation.dpred.html#simpeg.simulation.basesimulation.dpred","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"dpred","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ydhTT1wdv8"}],"urlSource":"myst:simpeg#simpeg.simulation.BaseSimulation.dpred","internal":false,"protocol":"xref:sphinx","key":"VOaKE2rauB"},{"type":"text","value":" method. Note that despite the difference in how we defined the model, the data predicted for CASE 1 and CASE 2 should be the same. And for CASE 3, we expect to see differences given the layer is now significantly permeable.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GA5rxxe3BQ"}],"key":"Cbb5pEAOfS"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For surveys consisting of multiple sources, multiple receivers per source and multiple observation locations per receiver, the predicted data vector is organized:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pvxD3fvmRr"}],"key":"axMlEApBpO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"by source","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"o1Pasn2J7J"}],"key":"kyvrlmf3c1"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"by receiver, then","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"j0ri5bMTX2"}],"key":"dVZIowWXzI"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"by observation location","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"F3dQdvotou"}],"key":"YtxBqoYH2c"}],"key":"o99gl2KoyI"}],"key":"f3kNuDKUH0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:04.367910Z","iopub.status.busy":"2024-07-17T18:20:04.367543Z","iopub.status.idle":"2024-07-17T18:20:04.381453Z","shell.execute_reply":"2024-07-17T18:20:04.380703Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dpred_conductivity = simulation_conductivity.dpred(conductivity_model)\ndpred_log_resistivity = simulation_log_resistivity.dpred(log_resistivity_model)\ndpred_parametric = simulation_parametric.dpred(parametric_model)","key":"yjBE8exE8A"},{"type":"output","id":"k8CJP18-jZI4gy48TVqeu","data":[],"key":"CTFRBPATl0"}],"key":"q60KKc4wB4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:04.384507Z","iopub.status.busy":"2024-07-17T18:20:04.384258Z","iopub.status.idle":"2024-07-17T18:20:04.918750Z","shell.execute_reply":"2024-07-17T18:20:04.918078Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ylim = [np.min(dpred_parametric), 1.1 * np.max(dpred_parametric)]\n\nfig = plt.figure(figsize=(10, 5))\n\nax1 = fig.add_axes([0.1, 0.1, 0.4, 0.85])\nax1.semilogx(frequencies, dpred_conductivity[0::2], \"b-o\", lw=3, ms=10)\nax1.semilogx(frequencies, dpred_log_resistivity[0::2], \"r--s\", lw=3, ms=6)\nax1.semilogx(frequencies, dpred_parametric[0::2], \"g:d\", lw=3, ms=6)\nax1.grid()\nax1.set_ylim(ylim)\nax1.set_xlabel(\"Frequency (Hz)\")\nax1.set_ylabel(\"Hs/Hp (ppm)\")\nax1.set_title(\"Real Component\")\nax1.legend([\"Conductivity model\", \"Log-resistivity model\", \"Parametric model\"])\n\nax2 = fig.add_axes([0.55, 0.1, 0.4, 0.85])\nax2.semilogx(frequencies, dpred_conductivity[1::2], \"b-o\", lw=3, ms=10)\nax2.semilogx(frequencies, dpred_log_resistivity[1::2], \"r--s\", lw=3, ms=6)\nax2.semilogx(frequencies, dpred_parametric[1::2], \"g:d\", lw=3, ms=6)\nax2.set_ylim(ylim)\nax2.grid()\nax2.set_xlabel(\"Frequency (Hz)\")\nax2.set_yticklabels(\"\")\nax2.set_title(\"Imaginary Component\")\nax2.legend([\"Conductivity model\", \"Log-resistivity model\", \"Parametric model\"])\n\nplt.show()","key":"LDdE84Hk9z"},{"type":"output","id":"3a7s5E5zOxW5iW3WJdC24","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"25bd4802bf8a5883a134700b30d36ccd","path":"/user-tutorials/build/25bd4802bf8a5883a134700b30d36ccd.png"},"text/plain":{"content":"<Figure size 1000x500 with 2 Axes>","content_type":"text/plain"}}}],"key":"ZHTVm8jImq"}],"key":"AEGZJtgM8S"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Optional:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nUIspq0FB9"}],"key":"X1p3vgEQnl"},{"type":"text","value":" Export data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SuEQwn5iMM"}],"key":"UJLMpe5xj0"}],"key":"Iee7UFVdOj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-07-17T18:20:04.924194Z","iopub.status.busy":"2024-07-17T18:20:04.923797Z","iopub.status.idle":"2024-07-17T18:20:04.928844Z","shell.execute_reply":"2024-07-17T18:20:04.928267Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"if write_output:\n    dir_path = os.path.sep.join([\".\", \"fwd_fdem_1d_outputs\"]) + os.path.sep\n    if not os.path.exists(dir_path):\n        os.mkdir(dir_path)\n\n    np.random.seed(222)\n    noise = (\n        0.05\n        * np.abs(dpred_conductivity)\n        * np.random.normal(size=len(dpred_conductivity))\n    )\n    dpred_out = dpred_conductivity + noise\n\n    fname = dir_path + \"em1dfm_data.txt\"\n    np.savetxt(\n        fname,\n        np.c_[frequencies, dpred_out[0::2], dpred_out[1::2]],\n        fmt=\"%.4e\",\n        header=\"FREQUENCY HZ_REAL HZ_IMAG\",\n    )","key":"zO3Hf0LYoB"},{"type":"output","id":"6Kw4s1vcz6Ch5i3cw6rwo","data":[],"key":"Iq7TUIyrkI"}],"key":"e1LOPmUxpQ"}],"key":"xvRL2mEYcJ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Frequency-Domain Electromagnetics","url":"/fdem-index","group":"SimPEG User Tutorials"},"next":{"title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","url":"/inv-fdem-1d","group":"SimPEG User Tutorials"}}},"domain":"http://localhost:3000"}