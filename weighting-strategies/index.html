<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Compare weighting strategy with Inversion of surface Gravity Anomaly Data - SimPEG User Tutorials</title><meta property="og:title" content="Compare weighting strategy with Inversion of surface Gravity Anomaly Data - SimPEG User Tutorials"/><meta name="generator" content="mystmd"/><meta name="description" content="SimPEG user tutorials"/><meta property="og:description" content="SimPEG user tutorials"/><meta name="keywords" content="geophysics, inversions, python, open-source"/><meta name="image" content="/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png"/><meta property="og:image" content="/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png"/><link rel="stylesheet" href="/user-tutorials/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/user-tutorials/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script defer="" data-domain="simpeg.xyz" src="https://plausible.io/js/plausible.js"></script><link rel="icon" href="/user-tutorials/favicon.ico"/><link rel="stylesheet" href="/user-tutorials/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/user-tutorials/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png" class="h-9" alt="User Tutorials" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5">User Tutorials</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0" data-headlessui-state=""><div class="inline-block"><button class="inline-flex items-center justify-center w-full py-1 mx-2 font-medium rounded-md text-md text-stone-900 dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" id="headlessui-menu-button-:R1j4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span>SimPEG</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="ml-2 -mr-1 text-violet-200 hover:text-violet-100"><path fill-rule="evenodd" d="M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://mystmd.org/guide" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Learn More</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a class="py-2 grow" href="/">SimPEG</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rap8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rap8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="SimPEG User Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/user-tutorials/">SimPEG User Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Gravity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/gravity-index">Gravity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Magnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/magnetics-index">Magnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Direct Current Resistivity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/dcr-index">Direct Current Resistivity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Induced Polarization" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/ip-index">Induced Polarization</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Frequency-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/fdem-index">Frequency-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Time-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/tdem-index">Time-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1up8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1up8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Joint Inversion" class="block break-words rounded py-2 grow cursor-pointer">Joint Inversion</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="PGI Inversion" class="block break-words rounded py-2 grow cursor-pointer">PGI Inversion</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Contributing to User Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/contributing-index">Contributing to User Tutorials</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">SimPEG User Tutorials</div><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" title="Code License: MIT License (MIT)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://github.com/simpeg/user-tutorials" title="GitHub Repository: simpeg/user-tutorials" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/simpeg/user-tutorials/edit/main/notebooks/03-gravity/weighting_strategies.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Compare weighting strategy with Inversion of surface Gravity Anomaly Data</h1><header class="mt-4 not-prose"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div><span class="font-semibold text-sm"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R2t8top:" data-state="closed">Thibaut Astic</button></span></div><div class="text-sm"><div>Kobold Metals<!-- --> </div></div></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="tvjJgTyGRi" class="relative group/block"><aside class="myst-admonition myst-admonition-caution my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-amber-600 caution"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-amber-600 bg-amber-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-amber-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Intermediate notebook</div></div><div class="myst-admonition-body px-4 py-1"><p>This tutorial focusses on intermediate level functionality within SimPEG. Basic functionality within SimPEG is not discussed in detail, as we assume the user is already familiar.</p></div></aside></div><div id="Xn9jzAoWct" class="relative group/block"><aside class="myst-admonition myst-admonition-hint my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 hint"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Light-weight notebook</div></div><div class="myst-admonition-body px-4 py-1"><p>This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.</p></div></aside></div><div id="H1t0homLf7" class="relative group/block"><p>Here we invert gravity anomaly data to recover a density contrast model. We formulate the inverse problem as an iteratively
re-weighted least-squares (IRLS) optimization problem. For this tutorial, we
focus on the following:</p><ol start="1"><li><p>Setting regularization weights</p></li><li><p>Defining the survey from xyz formatted data</p></li><li><p>Generating a mesh based on survey geometry</p></li><li><p>Including surface topography</p></li><li><p>Defining the inverse problem (data misfit, regularization, optimization)</p></li><li><p>Specifying directives for the inversion</p></li><li><p>Setting sparse and blocky norms</p></li><li><p>Plotting the recovered model and data misfit</p></li></ol><p>Although we consider gravity anomaly data in this tutorial, the same approach
can be used to invert gradiometry and other types of geophysical data.</p></div><div id="yskdnEuxpP" class="relative group/block"><h2 id="import-modules" class="relative group"><span class="heading-text">Import modules</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#import-modules" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="QikU6OqK2N" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import tarfile

import matplotlib as mpl
import matplotlib.pyplot as plt
import numpy as np
from discretize import TensorMesh
from discretize.utils import active_from_xyz

from simpeg import (
    data,
    data_misfit,
    directives,
    inverse_problem,
    inversion,
    maps,
    optimization,
    regularization,
    utils,
)
from simpeg.potential_fields import gravity
from simpeg.utils import model_builder, plot2Ddata</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TNmdc_W6rKTqZxo6tjkxX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qIovAwpXXr" class="relative group/block"><h2 id="define-file-names" class="relative group"><span class="heading-text">Define File Names</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-file-names" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>File paths for assets we are loading. To set up the inversion, we require
topography and field observations. The true model defined on the whole mesh
is loaded to compare with the inversion result. These files are stored as a
tar-file on our google cloud bucket:
“<a target="_blank" rel="noreferrer" href="https://storage.googleapis.com/simpeg/doc-assets/gravity.tar.gz" class="">https://<wbr/>storage<wbr/>.googleapis<wbr/>.com<wbr/>/simpeg<wbr/>/doc<wbr/>-assets<wbr/>/gravity<wbr/>.tar<wbr/>.gz</a>”</p></div><div id="QnpsjX0ZLw" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># storage bucket where we have the data
data_source = &quot;https://storage.googleapis.com/simpeg/doc-assets/gravity.tar.gz&quot;

# download the data
downloaded_data = utils.download(data_source, overwrite=True)

# unzip the tarfile
tar = tarfile.open(downloaded_data, &quot;r&quot;)
tar.extractall()
tar.close()

# path to the directory containing our data
dir_path = downloaded_data.split(&quot;.&quot;)[0] + os.path.sep

# files to work with
topo_filename = dir_path + &quot;gravity_topo.txt&quot;
data_filename = dir_path + &quot;gravity_data.obs&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SOxINFtZw_IeqDJRQVKrO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Downloading https://storage.googleapis.com/simpeg/doc-assets/gravity.tar.gz
   saved to: /home/ssoler/git/user-tutorials/notebooks/03-gravity/gravity.tar.gz
Download completed!
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/tmp/ipykernel_971017/1191307735.py:9: DeprecationWarning: Python 3.14 will, by default, filter extracted tar archives and reject files or modify their metadata. Use the filter argument to control this behavior.
  tar.extractall()
</span></code></pre></div></div></div><div id="jqcKt6q6AF" class="relative group/block"><h2 id="load-data-and-plot" class="relative group"><span class="heading-text">Load Data and Plot</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-data-and-plot" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we load and plot synthetic gravity anomaly data. Topography is generally
defined as an (N, 3) array. Gravity data is generally defined with 4 columns:
x, y, z and data.</p></div><div id="Xiuhkb0FUG" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load topography
xyz_topo = np.loadtxt(str(topo_filename))

# Load field data
dobs = np.loadtxt(str(data_filename))

# Define receiver locations and observed data
receiver_locations = dobs[:, 0:3]
dobs = dobs[:, -1]

# Plot
mpl.rcParams.update({&quot;font.size&quot;: 12})
fig = plt.figure(figsize=(7, 5))

ax1 = fig.add_axes([0.1, 0.1, 0.73, 0.85])
plot2Ddata(
    receiver_locations,
    dobs,
    ax=ax1,
    contourOpts={&quot;cmap&quot;: &quot;bwr&quot;},
    shade=True,
    nx=20,
    ny=20,
    dataloc=True,
)
ax1.set_title(&quot;Gravity Anomaly&quot;)
ax1.set_xlabel(&quot;x (m)&quot;)
ax1.set_ylabel(&quot;y (m)&quot;)

ax2 = fig.add_axes([0.8, 0.1, 0.03, 0.85])
norm = mpl.colors.Normalize(vmin=-np.max(np.abs(dobs)), vmax=np.max(np.abs(dobs)))
cbar = mpl.colorbar.ColorbarBase(
    ax2, norm=norm, orientation=&quot;vertical&quot;, cmap=mpl.cm.bwr, format=&quot;%.1e&quot;
)
cbar.set_label(&quot;$mGal$&quot;, rotation=270, labelpad=15, size=12)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_-_6S-X5OviBshQU_Ua0k" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/a4ad56474e8d1d1d073ceb69432ff15a.png" alt="&lt;Figure size 700x500 with 2 Axes&gt;"/></div></div><div id="JfDBO8ejQB" class="relative group/block"><h2 id="assign-uncertainties" class="relative group"><span class="heading-text">Assign Uncertainties</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#assign-uncertainties" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Inversion with simpeg requires that we define the standard deviation of our data.
This represents our estimate of the noise in our data. For a gravity inversion,
a constant floor value is generally applied to all data. For this tutorial,
the standard deviation on each datum will be 1% of the maximum observed
gravity anomaly value.</p></div><div id="fld7lwzMy6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">maximum_anomaly = np.max(np.abs(dobs))

uncertainties = 0.01 * maximum_anomaly * np.ones(np.shape(dobs))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MW12ttUgWkQbQqRA13UXt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hwVTmjmBYN" class="relative group/block"><h2 id="defining-the-survey" class="relative group"><span class="heading-text">Defining the Survey</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-the-survey" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we define the survey that will be used for this tutorial. Gravity
surveys are simple to create. The user only needs an (N, 3) array to define
the xyz locations of the observation locations. From this, the user can
define the receivers and the source field.</p></div><div id="lqGn1DLbG5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Define the receivers. The data consists of vertical gravity anomaly measurements.
# The set of receivers must be defined as a list.
receiver_list = gravity.receivers.Point(receiver_locations, components=&quot;gz&quot;)

receiver_list = [receiver_list]

# Define the source field
source_field = gravity.sources.SourceField(receiver_list=receiver_list)

# Define the survey
survey = gravity.survey.Survey(source_field)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Prlcj9pe4dWfDD3iHffn1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="fykC1eUnlp" class="relative group/block"><h2 id="defining-the-data" class="relative group"><span class="heading-text">Defining the Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-the-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here is where we define the data that is inverted. The data is defined by
the survey, the observation values and the standard deviation.</p></div><div id="OOUVW2lCHU" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">data_object = data.Data(survey, dobs=dobs, standard_deviation=uncertainties)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MRE4lBxwA4wPd39N1rVVW" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QzQKaaxLkb" class="relative group/block"><h2 id="defining-a-tensor-mesh" class="relative group"><span class="heading-text">Defining a Tensor Mesh</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-a-tensor-mesh" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we create the tensor mesh that will be used to invert gravity anomaly
data. If desired, we could define an OcTree mesh.</p></div><div id="ijcX6XMdgv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">dh = 5.0
hx = [(dh, 5, -1.3), (dh, 40), (dh, 5, 1.3)]
hy = [(dh, 5, -1.3), (dh, 40), (dh, 5, 1.3)]
hz = [(dh, 5, -1.3), (dh, 15)]
mesh = TensorMesh([hx, hy, hz], &quot;CCN&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FCSest3I62OGhGusHaIos" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="FRRBGC9k8y" class="relative group/block"><h2 id="starting-reference-model-and-mapping-on-tensor-mesh" class="relative group"><span class="heading-text">Starting/Reference Model and Mapping on Tensor Mesh</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#starting-reference-model-and-mapping-on-tensor-mesh" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we create starting and/or reference models for the inversion as
well as the mapping from the model space to the active cells. Starting and
reference models can be a constant background value or contain a-priori
structures.</p></div><div id="uEdws7toCh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Find the indices of the active cells in forward model (ones below surface)
ind_active = active_from_xyz(mesh, xyz_topo)

# Define mapping from model to active cells
nC = int(ind_active.sum())
model_map = maps.IdentityMap(nP=nC)  # model consists of a value for each active cell

# Define and plot starting model
starting_model = np.zeros(nC)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eywj6FwK5AY5vZIInF9Xh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UKH6EQrR5W" class="relative group/block"><h2 id="define-the-physics-and-data-misfit" class="relative group"><span class="heading-text">Define the Physics and data misfit</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-the-physics-and-data-misfit" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we define the physics of the gravity problem by using the simulation
class.</p></div><div id="eS2lNJ5JJw" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">simulation = gravity.simulation.Simulation3DIntegral(
    survey=survey, mesh=mesh, rhoMap=model_map, active_cells=ind_active
)

# Define the data misfit. Here the data misfit is the L2 norm of the weighted
# residual between the observed data and the data predicted for a given model.
# Within the data misfit, the residual between predicted and observed data are
# normalized by the data&#x27;s standard deviation.
dmis = data_misfit.L2DataMisfit(data=data_object, simulation=simulation)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jLvUwU--9pf9jSE69J25I" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="eJhgdqSRL7" class="relative group/block"><h2 id="running-the-depth-weighted-inversion" class="relative group"><span class="heading-text">Running the Depth Weighted inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#running-the-depth-weighted-inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we define the directives, weights, regularization, and optimization
for a depth-weighted inversion</p></div><div id="qpJlLYhu2i" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># inversion directives
# Defining a starting value for the trade-off parameter (beta) between the data
# misfit and the regularization.
starting_beta = directives.BetaEstimate_ByEig(beta0_ratio=1e0)

# Defines the directives for the IRLS regularization. This includes setting
# the cooling schedule for the trade-off parameter.
update_IRLS = directives.UpdateIRLS(
    f_min_change=1e-4,
    max_irls_iterations=30,
    irls_cooling_factor=1.5,
    misfit_tolerance=1e-2,
)

# Options for outputting recovered models and predicted data for each beta.
save_iteration = directives.SaveOutputEveryIteration(save_txt=False)

# Updating the preconditionner if it is model dependent.
update_jacobi = directives.UpdatePreconditioner()

# The directives are defined as a list
directives_list = [
    update_IRLS,
    starting_beta,
    save_iteration,
    update_jacobi,
]

# Define the regularization (model objective function) with depth weighting.
reg_dpth = regularization.Sparse(mesh, active_cells=ind_active, mapping=model_map)
reg_dpth.norms = [0, 2, 2, 2]
depth_weights = utils.depth_weighting(
    mesh, receiver_locations, active_cells=ind_active, exponent=2
)
reg_dpth.set_weights(depth_weights=depth_weights)

# Define how the optimization problem is solved. Here we will use a projected
# Gauss-Newton approach that employs the conjugate gradient solver.
opt = optimization.ProjectedGNCG(
    maxIter=100, lower=-1.0, upper=1.0, maxIterLS=20, maxIterCG=10, tolCG=1e-3
)

# Here we define the inverse problem that is to be solved
inv_prob = inverse_problem.BaseInvProblem(dmis, reg_dpth, opt)

# Here we combine the inverse problem and the set of directives
inv = inversion.BaseInversion(inv_prob, directives_list)

# Run inversion
recovered_model_dpth = inv.run(starting_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4bx-5Z0Cd4XLMu4-nAuXr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
Running inversion with SimPEG v0.24.0
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.

                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                    ***Done using the default solver Pardiso and no solver_opts.***
                    
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>model has any nan: 0
=============================== Projected GNCG ===============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   
-----------------------------------------------------------------------------
x0 has any nan: 0
   0  9.78e+02  2.66e+05  0.00e+00  2.66e+05    2.19e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   1  4.89e+02  3.19e+03  1.71e+01  1.16e+04    2.10e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   2  2.44e+02  1.21e+03  1.99e+01  6.07e+03    2.04e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   3  1.22e+02  4.61e+02  2.20e+01  3.15e+03    1.93e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reached starting chifact with l2-norm regularization: Start IRLS steps...
irls_threshold 0.05928551292065909
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   4  1.22e+02  1.83e+02  4.61e+01  5.82e+03    2.06e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   5  1.50e+02  2.53e+02  5.92e+01  9.16e+03    2.12e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   6  8.26e+01  4.75e+02  6.48e+01  5.83e+03    2.03e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   7  1.05e+02  2.39e+02  6.72e+01  7.28e+03    2.14e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   8  6.21e+01  3.97e+02  5.96e+01  4.10e+03    2.10e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   9  8.13e+01  2.25e+02  5.22e+01  4.47e+03    2.15e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  10  9.84e+01  2.61e+02  4.39e+01  4.58e+03    2.16e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  11  6.43e+01  3.07e+02  3.79e+01  2.74e+03    2.08e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  12  9.10e+01  1.92e+02  3.32e+01  3.21e+03    2.17e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  13  1.11e+02  2.57e+02  2.73e+01  3.29e+03    2.17e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  14  7.24e+01  3.07e+02  2.30e+01  1.97e+03    2.03e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  15  9.85e+01  2.08e+02  2.14e+01  2.32e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  16  1.21e+02  2.55e+02  1.85e+01  2.49e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  17  8.00e+01  2.93e+02  1.64e+01  1.60e+03    2.04e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  18  1.06e+02  2.19e+02  1.62e+01  1.94e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  19  1.29e+02  2.60e+02  1.48e+01  2.17e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  20  1.50e+02  2.79e+02  1.36e+01  2.32e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  21  1.73e+02  2.85e+02  1.28e+01  2.50e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  22  1.99e+02  2.90e+02  1.22e+01  2.72e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  23  1.31e+02  2.98e+02  1.18e+01  1.85e+03    1.88e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  24  1.72e+02  2.25e+02  1.20e+01  2.28e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  25  2.13e+02  2.49e+02  1.15e+01  2.69e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  26  2.55e+02  2.67e+02  1.11e+01  3.09e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  27  3.01e+02  2.72e+02  1.07e+01  3.50e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  28  3.47e+02  2.85e+02  1.05e+01  3.92e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  29  3.99e+02  2.91e+02  1.02e+01  4.37e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  30  2.62e+02  3.04e+02  9.94e+00  2.90e+03    2.08e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  31  3.36e+02  2.33e+02  1.01e+01  3.62e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  32  4.08e+02  2.60e+02  9.86e+00  4.28e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  33  4.74e+02  2.81e+02  9.67e+00  4.86e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reach maximum number of IRLS cycles: 30
------------------------- STOP! -------------------------
1 : |fc-fOld| = 0.0000e+00 &lt;= tolF*(1+|f0|) = 2.6622e+04
1 : |xc-x_last| = 2.9311e-02 &lt;= tolX*(1+|x0|) = 1.0000e-01
0 : |proj(x-g)-x|    = 2.1837e+02 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 2.1837e+02 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =     100    &lt;= iter          =     34
------------------------- DONE! -------------------------
</span></code></pre></div></div></div><div id="Bl0S3UvFl2" class="relative group/block"><h2 id="running-the-distance-weighted-inversion" class="relative group"><span class="heading-text">Running the Distance Weighted inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#running-the-distance-weighted-inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we define the directives, weights, regularization, and optimization
for a distance-weighted inversion</p></div><div id="pgC8xkQ72F" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># inversion directives
# Defining a starting value for the trade-off parameter (beta) between the data
# misfit and the regularization.
starting_beta = directives.BetaEstimate_ByEig(beta0_ratio=1e0)

# Defines the directives for the IRLS regularization. This includes setting
# the cooling schedule for the trade-off parameter.
update_IRLS = directives.UpdateIRLS(
    f_min_change=1e-4,
    max_irls_iterations=30,
    irls_cooling_factor=1.5,
    misfit_tolerance=1e-2,
)

# Options for outputting recovered models and predicted data for each beta.
save_iteration = directives.SaveOutputEveryIteration(save_txt=False)

# Updating the preconditionner if it is model dependent.
update_jacobi = directives.UpdatePreconditioner()

# The directives are defined as a list
directives_list = [
    update_IRLS,
    starting_beta,
    save_iteration,
    update_jacobi,
]

# Define the regularization (model objective function) with distance weighting.
reg_dist = regularization.Sparse(mesh, active_cells=ind_active, mapping=model_map)
reg_dist.norms = [0, 2, 2, 2]
distance_weights = utils.distance_weighting(
    mesh, receiver_locations, active_cells=ind_active, exponent=2
)
reg_dist.set_weights(distance_weights=distance_weights)

# Define how the optimization problem is solved. Here we will use a projected
# Gauss-Newton approach that employs the conjugate gradient solver.
opt = optimization.ProjectedGNCG(
    maxIter=100, lower=-1.0, upper=1.0, maxIterLS=20, maxIterCG=10, tolCG=1e-3
)

# Here we define the inverse problem that is to be solved
inv_prob = inverse_problem.BaseInvProblem(dmis, reg_dist, opt)

# Here we combine the inverse problem and the set of directives
inv = inversion.BaseInversion(inv_prob, directives_list)

# Run inversion
recovered_model_dist = inv.run(starting_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8iOvO8fnuNSS1VQQlaXJQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
Running inversion with SimPEG v0.24.0
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.

                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                    ***Done using the default solver Pardiso and no solver_opts.***
                    
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>model has any nan: 0
=============================== Projected GNCG ===============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   
-----------------------------------------------------------------------------
x0 has any nan: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   0  2.86e+03  2.66e+05  0.00e+00  2.66e+05    2.19e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   1  1.43e+03  2.35e+04  1.41e+01  4.37e+04    2.17e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   2  7.15e+02  1.05e+04  2.04e+01  2.51e+04    2.15e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   3  3.57e+02  4.24e+03  2.65e+01  1.37e+04    2.11e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   4  1.79e+02  1.62e+03  3.15e+01  7.25e+03    2.05e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   5  8.94e+01  6.17e+02  3.53e+01  3.77e+03    1.96e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reached starting chifact with l2-norm regularization: Start IRLS steps...
irls_threshold 0.05584940363763429
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   6  8.94e+01  2.43e+02  7.45e+01  6.90e+03    2.08e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   7  5.55e+01  3.53e+02  9.54e+01  5.65e+03    2.06e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   8  7.31e+01  2.22e+02  1.13e+02  8.51e+03    2.14e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   9  4.07e+01  4.59e+02  1.08e+02  4.85e+03    2.05e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  10  5.12e+01  2.43e+02  9.71e+01  5.21e+03    2.14e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  11  3.39e+01  2.94e+02  8.14e+01  3.05e+03    2.06e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  12  4.87e+01  1.85e+02  6.95e+01  3.57e+03    2.16e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  13  6.40e+01  2.23e+02  5.90e+01  4.00e+03    2.16e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  14  7.39e+01  2.84e+02  4.90e+01  3.91e+03    2.16e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  15  4.83e+01  3.08e+02  4.11e+01  2.29e+03    2.09e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  16  6.72e+01  1.98e+02  3.76e+01  2.72e+03    2.17e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  17  8.43e+01  2.44e+02  3.26e+01  2.99e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  18  1.06e+02  2.90e+02  2.88e+01  3.34e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  19  6.65e+01  3.40e+02  2.59e+01  2.06e+03    2.14e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  20  8.47e+01  2.37e+02  2.54e+01  2.39e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  21  1.01e+02  2.66e+02  2.35e+01  2.65e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  22  6.73e+01  2.93e+02  2.22e+01  1.78e+03    2.02e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  23  9.04e+01  2.13e+02  2.21e+01  2.21e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  24  1.14e+02  2.40e+02  2.08e+01  2.62e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  25  1.39e+02  2.61e+02  1.99e+01  3.01e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  26  1.64e+02  2.72e+02  1.91e+01  3.40e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  27  1.90e+02  2.81e+02  1.85e+01  3.80e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  28  2.21e+02  2.92e+02  1.80e+01  4.27e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  29  1.44e+02  3.06e+02  1.77e+01  2.85e+03    2.03e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  30  1.87e+02  2.28e+02  1.78e+01  3.57e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  31  2.31e+02  2.53e+02  1.74e+01  4.27e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  32  2.71e+02  2.76e+02  1.70e+01  4.88e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  33  1.80e+02  2.92e+02  1.66e+01  3.27e+03    1.56e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  34  2.40e+02  2.16e+02  1.67e+01  4.22e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  35  2.94e+02  2.54e+02  1.63e+01  5.06e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reach maximum number of IRLS cycles: 30
------------------------- STOP! -------------------------
1 : |fc-fOld| = 0.0000e+00 &lt;= tolF*(1+|f0|) = 2.6622e+04
1 : |xc-x_last| = 4.0755e-02 &lt;= tolX*(1+|x0|) = 1.0000e-01
0 : |proj(x-g)-x|    = 2.1824e+02 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 2.1824e+02 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =     100    &lt;= iter          =     36
------------------------- DONE! -------------------------
</span></code></pre></div></div></div><div id="n218BNc2LP" class="relative group/block"><h2 id="running-the-distance-weighted-inversion-1" class="relative group"><span class="heading-text">Running the Distance Weighted inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#running-the-distance-weighted-inversion-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we define the directives, weights, regularization, and optimization
for a sensitivity weighted inversion</p></div><div id="ivdQoqxoeV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># inversion directives
# Defining a starting value for the trade-off parameter (beta) between the data
# misfit and the regularization.
starting_beta = directives.BetaEstimate_ByEig(beta0_ratio=1e0)

# Defines the directives for the IRLS regularization. This includes setting
# the cooling schedule for the trade-off parameter.
update_IRLS = directives.UpdateIRLS(
    f_min_change=1e-4,
    max_irls_iterations=30,
    irls_cooling_factor=1.5,
    misfit_tolerance=1e-2,
)

# Options for outputting recovered models and predicted data for each beta.
save_iteration = directives.SaveOutputEveryIteration(save_txt=False)

# Updating the preconditionner if it is model dependent.
update_jacobi = directives.UpdatePreconditioner()

# Add sensitivity weights
sensitivity_weights = directives.UpdateSensitivityWeights(every_iteration=False)

# The directives are defined as a list
directives_list = [
    update_IRLS,
    sensitivity_weights,
    starting_beta,
    save_iteration,
    update_jacobi,
]

# Define the regularization (model objective function) for sensitivity weighting.
reg_sensw = regularization.Sparse(mesh, active_cells=ind_active, mapping=model_map)
reg_sensw.norms = [0, 2, 2, 2]

# Define how the optimization problem is solved. Here we will use a projected
# Gauss-Newton approach that employs the conjugate gradient solver.
opt = optimization.ProjectedGNCG(
    maxIter=100, lower=-1.0, upper=1.0, maxIterLS=20, maxIterCG=10, tolCG=1e-3
)

# Here we define the inverse problem that is to be solved
inv_prob = inverse_problem.BaseInvProblem(dmis, reg_sensw, opt)

# Here we combine the inverse problem and the set of directives
inv = inversion.BaseInversion(inv_prob, directives_list)

# Run inversion
recovered_model_sensw = inv.run(starting_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3cbnq1b0nGbwgUr3gZ7He" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
Running inversion with SimPEG v0.24.0
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.

                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                    ***Done using the default solver Pardiso and no solver_opts.***
                    
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>model has any nan: 0
=============================== Projected GNCG ===============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   
-----------------------------------------------------------------------------
x0 has any nan: 0
   0  3.20e+03  2.66e+05  0.00e+00  2.66e+05    2.19e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   1  1.60e+03  1.88e+04  1.15e+01  3.72e+04    2.16e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   2  8.00e+02  8.19e+03  1.61e+01  2.11e+04    2.14e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   3  4.00e+02  3.26e+03  2.03e+01  1.14e+04    2.10e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   4  2.00e+02  1.24e+03  2.38e+01  5.99e+03    2.00e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   5  1.00e+02  4.71e+02  2.64e+01  3.11e+03    1.91e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reached starting chifact with l2-norm regularization: Start IRLS steps...
irls_threshold 0.05481358175866103
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   6  1.00e+02  1.89e+02  5.44e+01  5.63e+03    2.09e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   7  1.19e+02  2.68e+02  6.88e+01  8.49e+03    2.14e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   8  6.87e+01  4.27e+02  7.46e+01  5.55e+03    1.86e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   9  8.75e+01  2.37e+02  7.61e+01  6.90e+03    2.16e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  10  5.19e+01  3.97e+02  6.77e+01  3.91e+03    2.08e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  11  7.14e+01  2.04e+02  5.95e+01  4.45e+03    2.15e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  12  9.04e+01  2.40e+02  5.00e+01  4.75e+03    2.14e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  13  5.96e+01  2.99e+02  4.21e+01  2.80e+03    2.16e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  14  8.56e+01  1.86e+02  3.68e+01  3.34e+03    2.16e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  15  1.13e+02  2.20e+02  3.15e+01  3.78e+03    2.17e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  16  1.36e+02  2.63e+02  2.73e+01  3.99e+03    2.17e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  17  8.97e+01  3.01e+02  2.43e+01  2.48e+03    2.08e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  18  1.21e+02  2.11e+02  2.32e+01  3.02e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  19  1.49e+02  2.55e+02  2.12e+01  3.41e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  20  9.85e+01  2.95e+02  1.98e+01  2.24e+03    2.05e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  21  1.33e+02  2.12e+02  1.94e+01  2.79e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  22  1.65e+02  2.47e+02  1.84e+01  3.28e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  23  1.95e+02  2.75e+02  1.75e+01  3.68e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  24  2.24e+02  2.85e+02  1.68e+01  4.05e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  25  1.48e+02  2.98e+02  1.62e+01  2.70e+03    1.93e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  26  2.01e+02  2.08e+02  1.62e+01  3.47e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  27  2.52e+02  2.46e+02  1.57e+01  4.21e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  28  2.93e+02  2.80e+02  1.54e+01  4.78e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  29  1.93e+02  2.98e+02  1.50e+01  3.19e+03    1.59e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  30  2.63e+02  2.09e+02  1.50e+01  4.16e+03    2.18e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  31  3.26e+02  2.49e+02  1.46e+01  5.01e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  32  3.77e+02  2.83e+02  1.43e+01  5.67e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  33  2.45e+02  3.13e+02  1.40e+01  3.75e+03    2.02e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  34  3.25e+02  2.18e+02  1.42e+01  4.84e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  35  3.90e+02  2.66e+02  1.39e+01  5.68e+03    2.18e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Reach maximum number of IRLS cycles: 30
------------------------- STOP! -------------------------
1 : |fc-fOld| = 0.0000e+00 &lt;= tolF*(1+|f0|) = 2.6622e+04
1 : |xc-x_last| = 3.4660e-02 &lt;= tolX*(1+|x0|) = 1.0000e-01
0 : |proj(x-g)-x|    = 2.1800e+02 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 2.1800e+02 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =     100    &lt;= iter          =     36
------------------------- DONE! -------------------------
</span></code></pre></div></div></div><div id="jpNfYBTd5m" class="relative group/block"><h2 id="recreate-true-model" class="relative group"><span class="heading-text">Recreate True Model</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#recreate-true-model" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="EPaeggtyTJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Define density contrast values for each unit in g/cc
background_density = 0.0
block_density = -0.2
sphere_density = 0.2

# Define model. Models in simpeg are vector arrays.
true_model = background_density * np.ones(nC)

# You could find the indicies of specific cells within the model and change their
# value to add structures.
ind_block = (
    (mesh.gridCC[ind_active, 0] &gt; -50.0)
    &amp; (mesh.gridCC[ind_active, 0] &lt; -20.0)
    &amp; (mesh.gridCC[ind_active, 1] &gt; -15.0)
    &amp; (mesh.gridCC[ind_active, 1] &lt; 15.0)
    &amp; (mesh.gridCC[ind_active, 2] &gt; -50.0)
    &amp; (mesh.gridCC[ind_active, 2] &lt; -30.0)
)
true_model[ind_block] = block_density

# You can also use simpeg utilities to add structures to the model more concisely
ind_sphere = model_builder.get_indices_sphere(
    np.r_[35.0, 0.0, -40.0], 15.0, mesh.gridCC
)
ind_sphere = ind_sphere[ind_active]
true_model[ind_sphere] = sphere_density</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LJQ3m8KAF3W048cP7hC0v" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EC1cmq5lLf" class="relative group/block"><h2 id="plotting-true-model-and-recovered-models" class="relative group"><span class="heading-text">Plotting True Model and Recovered Models</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plotting-true-model-and-recovered-models" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="FJTGRkYUQA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Plot Models
fig, ax = plt.subplots(2, 2, figsize=(20, 10), sharex=True, sharey=True)
ax = ax.flatten()
plotting_map = maps.InjectActiveCells(mesh, ind_active, np.nan)
cmap = &quot;coolwarm&quot;
slice_y_loc = 0.0

mm = mesh.plot_slice(
    plotting_map * true_model,
    normal=&quot;Y&quot;,
    ax=ax[0],
    grid=False,
    slice_loc=slice_y_loc,
    pcolor_opts={&quot;cmap&quot;: cmap, &quot;norm&quot;: norm},
)
ax[0].set_title(f&quot;True model slice at y = {slice_y_loc} m&quot;)
plt.colorbar(mm[0], label=&quot;$g/cm^3$&quot;, ax=ax[0])

# plot depth weighting result
vmax = np.abs(recovered_model_dpth).max()
norm = mpl.colors.TwoSlopeNorm(vcenter=0, vmin=-vmax, vmax=vmax)
mm = mesh.plot_slice(
    plotting_map * recovered_model_dpth,
    normal=&quot;Y&quot;,
    ax=ax[1],
    grid=False,
    slice_loc=slice_y_loc,
    pcolor_opts={&quot;cmap&quot;: cmap, &quot;norm&quot;: norm},
)
ax[1].set_title(f&quot;Depth weighting Model slice at y = {slice_y_loc} m&quot;)
plt.colorbar(mm[0], label=&quot;$g/cm^3$&quot;, ax=ax[1])

# plot distance weighting result
vmax = np.abs(recovered_model_dist).max()
norm = mpl.colors.TwoSlopeNorm(vcenter=0, vmin=-vmax, vmax=vmax)
mm = mesh.plot_slice(
    plotting_map * recovered_model_dist,
    normal=&quot;Y&quot;,
    ax=ax[2],
    grid=False,
    slice_loc=slice_y_loc,
    pcolor_opts={&quot;cmap&quot;: cmap, &quot;norm&quot;: norm},
)
ax[2].set_title(f&quot;Distance weighting Model slice at y = {slice_y_loc} m&quot;)
plt.colorbar(mm[0], label=&quot;$g/cm^3$&quot;, ax=ax[2])

# plot sensitivity weighting result
vmax = np.abs(recovered_model_sensw).max()
norm = mpl.colors.TwoSlopeNorm(vcenter=0, vmin=-vmax, vmax=vmax)
mm = mesh.plot_slice(
    plotting_map * recovered_model_sensw,
    normal=&quot;Y&quot;,
    ax=ax[3],
    grid=False,
    slice_loc=slice_y_loc,
    pcolor_opts={&quot;cmap&quot;: cmap, &quot;norm&quot;: norm},
)
ax[3].set_title(f&quot;Sensitivity weighting Model slice at y = {slice_y_loc} m&quot;)
plt.colorbar(mm[0], label=&quot;$g/cm^3$&quot;, ax=ax[3])

# shared plotting
plotting_map = maps.InjectActiveCells(mesh, ind_active, 0.0)
slice_y_ind = (
    mesh.cell_centers[:, 1] == np.abs(mesh.cell_centers[:, 1] - slice_y_loc).min()
)
for axx in ax:
    utils.plot2Ddata(
        mesh.cell_centers[slice_y_ind][:, [0, 2]],
        (plotting_map * true_model)[slice_y_ind],
        contourOpts={&quot;alpha&quot;: 0},
        level=True,
        ncontour=2,
        levelOpts={&quot;colors&quot;: &quot;grey&quot;, &quot;linewidths&quot;: 2, &quot;linestyles&quot;: &quot;--&quot;},
        method=&quot;nearest&quot;,
        ax=axx,
    )
    axx.set_aspect(1)

plt.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wrYixxRPfpX7yY5IifEuq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/30e1f355fee1b48bd29d902558b42646.png" alt="&lt;Figure size 2000x1000 with 8 Axes&gt;"/></div></div><div id="J5HceA0cwh" class="relative group/block"><h2 id="visualize-weights" class="relative group"><span class="heading-text">Visualize weights</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualize-weights" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Plot Weights</p></div><div id="BKXG3Xbwmc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(1, 3, figsize=(20, 4), sharex=True, sharey=True)
plotting_map = maps.InjectActiveCells(mesh, ind_active, np.nan)
cmap = &quot;magma&quot;
slice_y_loc = 0.0

# plot depth weights
mm = mesh.plot_slice(
    plotting_map * np.log10(depth_weights),
    normal=&quot;Y&quot;,
    ax=ax[0],
    grid=False,
    slice_loc=slice_y_loc,
    pcolor_opts={&quot;cmap&quot;: cmap},
)
ax[0].set_title(f&quot;log10(depth weights) slice at y = {slice_y_loc} m&quot;)
plt.colorbar(mm[0], label=&quot;log10(depth weights)&quot;, ax=ax[0])

# plot distance weights
mm = mesh.plot_slice(
    plotting_map * np.log10(distance_weights),
    normal=&quot;Y&quot;,
    ax=ax[1],
    grid=False,
    slice_loc=slice_y_loc,
    pcolor_opts={&quot;cmap&quot;: cmap},
)
ax[1].set_title(f&quot;log10(distance weights) slice at y = {slice_y_loc} m&quot;)
plt.colorbar(mm[0], label=&quot;log10(distance weights)&quot;, ax=ax[1])

# plot sensitivity weights
mm = mesh.plot_slice(
    plotting_map * np.log10(reg_sensw.objfcts[0].get_weights(key=&quot;sensitivity&quot;)),
    normal=&quot;Y&quot;,
    ax=ax[2],
    grid=False,
    slice_loc=slice_y_loc,
    pcolor_opts={&quot;cmap&quot;: cmap},
)
ax[2].set_title(f&quot;log10(sensitivity weights) slice at y = {slice_y_loc} m&quot;)
plt.colorbar(mm[0], label=&quot;log10(sensitivity weights)&quot;, ax=ax[2])

# shared plotting
for axx in ax:
    axx.set_aspect(1)

plt.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kPNwnlDv6oL8allcZThJD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/4468057a1aa02f8ecd9a8a8d999f98b7.png" alt="&lt;Figure size 2000x400 with 6 Axes&gt;"/></div></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/inv-gravity-anomaly-3d"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">SimPEG User Tutorials</div>3D Inversion of Gravity Anomaly Data</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/magnetics-index"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">SimPEG User Tutorials</div>Magnetics</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/user-tutorials/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/user-tutorials/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/user-tutorials/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/weighting-strategies","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.3","title":"SimPEG User Tutorials","options":{"logo":"/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png","logo_text":"User Tutorials","analytics_plausible":"simpeg.xyz"},"nav":[{"title":"SimPEG","children":[{"title":"Project website","url":"https://simpeg.xyz"},{"title":"Documentation","url":"https://docs.simpeg.xyz"}]}],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide","internal":false,"static":false}],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/user-tutorials"},"routes/$":{"config":{"version":2,"myst":"1.6.3","title":"SimPEG User Tutorials","options":{"logo":"/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png","logo_text":"User Tutorials","analytics_plausible":"simpeg.xyz"},"nav":[{"title":"SimPEG","children":[{"title":"Project website","url":"https://simpeg.xyz"},{"title":"Documentation","url":"https://docs.simpeg.xyz"}]}],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide","internal":false,"static":false}],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"50fac606170c209ceb7aed985435b42f1f16e45d0792469883a7e4b729b2c56a","slug":"weighting-strategies","location":"/notebooks/03-gravity/weighting_strategies.ipynb","dependencies":[],"frontmatter":{"title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","authors":[{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/simpeg/user-tutorials","subject":"SimPEG User Tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"kobold","name":"Kobold Metals"},{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/simpeg/user-tutorials/blob/main/notebooks/03-gravity/weighting_strategies.ipynb","edit_url":"https://github.com/simpeg/user-tutorials/edit/main/notebooks/03-gravity/weighting_strategies.ipynb","exports":[{"format":"ipynb","filename":"weighting_strategies.ipynb","url":"/user-tutorials/build/weighting_strategies-f8038fc464c9a72f6ee1a4fc03e720ec.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Intermediate notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WLHOkh1A3V"}],"key":"TEdSS6UTGx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial focusses on intermediate level functionality within SimPEG. Basic functionality within SimPEG is not discussed in detail, as we assume the user is already familiar.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RNuX5pc2bt"}],"key":"R3TXXWCiWK"}],"class":"caution","key":"IARhm9E01x"}],"key":"tvjJgTyGRi"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Light-weight notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tOpWJbexpg"}],"key":"iz5SqgOpxa"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hQdxsOh4eO"}],"key":"q44OU973VK"}],"class":"hint","key":"tbTWbXMzid"}],"key":"Xn9jzAoWct"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"\"\"\""},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we invert gravity anomaly data to recover a density contrast model. We formulate the inverse problem as an iteratively\nre-weighted least-squares (IRLS) optimization problem. For this tutorial, we\nfocus on the following:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OGa6YTRqBz"}],"key":"QKzanvVf13"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Setting regularization weights","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FvzdOm30HR"}],"key":"C2rdNc76sT"}],"key":"Vy464nV5Bu"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Defining the survey from xyz formatted data","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kFuwWAjDGz"}],"key":"Cn97G5Wu6m"}],"key":"h7gpcQuBZi"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Generating a mesh based on survey geometry","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OYXSO2y77C"}],"key":"XYsvFJkSVa"}],"key":"svOvPK1iJF"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Including surface topography","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"hW1BsZJDQ5"}],"key":"nGdB176bfT"}],"key":"Xf78h0R6q3"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Defining the inverse problem (data misfit, regularization, optimization)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ktWiE03Xm8"}],"key":"UQE5uVXsVu"}],"key":"n6fDTR7ElA"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Specifying directives for the inversion","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vIKKmGS24I"}],"key":"xDTBl8V4AB"}],"key":"wuhWPPLVQs"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Setting sparse and blocky norms","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"n0AN1KCl0h"}],"key":"HeexfKzonX"}],"key":"hIcF5wiJjL"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Plotting the recovered model and data misfit","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jtOxrKtxjp"}],"key":"klEeob0cMh"}],"key":"W4XeFH6n9L"}],"key":"yGgTvGwsAU"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Although we consider gravity anomaly data in this tutorial, the same approach\ncan be used to invert gradiometry and other types of geophysical data.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"qx0OjIsRST"}],"key":"xxUxkjuPqa"}],"key":"H1t0homLf7"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#########################################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Import modules","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VgtuoMrzpC"}],"identifier":"import-modules","label":"Import modules","html_id":"import-modules","implicit":true,"key":"CjItW4UvgE"}],"key":"yskdnEuxpP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:31.480131Z","iopub.status.busy":"2025-05-23T16:23:31.479613Z","iopub.status.idle":"2025-05-23T16:23:33.528935Z","shell.execute_reply":"2025-05-23T16:23:33.527920Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport tarfile\n\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom discretize import TensorMesh\nfrom discretize.utils import active_from_xyz\n\nfrom simpeg import (\n    data,\n    data_misfit,\n    directives,\n    inverse_problem,\n    inversion,\n    maps,\n    optimization,\n    regularization,\n    utils,\n)\nfrom simpeg.potential_fields import gravity\nfrom simpeg.utils import model_builder, plot2Ddata","key":"LhPsydUEdJ"},{"type":"output","id":"TNmdc_W6rKTqZxo6tjkxX","data":[],"key":"ag36SXpPlD"}],"key":"QikU6OqK2N"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#############################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Define File Names","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vCbWumVnBv"}],"identifier":"define-file-names","label":"Define File Names","html_id":"define-file-names","implicit":true,"key":"EsQ91GV0Nc"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"File paths for assets we are loading. To set up the inversion, we require\ntopography and field observations. The true model defined on the whole mesh\nis loaded to compare with the inversion result. These files are stored as a\ntar-file on our google cloud bucket:\n“","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xYB99dx8li"},{"type":"link","url":"https://storage.googleapis.com/simpeg/doc-assets/gravity.tar.gz","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"https://​storage​.googleapis​.com​/simpeg​/doc​-assets​/gravity​.tar​.gz","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ryt4YTrFxc"}],"urlSource":"https://storage.googleapis.com/simpeg/doc-assets/gravity.tar.gz","key":"h9EjqN8l9U"},{"type":"text","value":"”","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"St2w1HBuwn"}],"key":"VhazLcxZ0v"}],"key":"qIovAwpXXr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:33.531956Z","iopub.status.busy":"2025-05-23T16:23:33.531527Z","iopub.status.idle":"2025-05-23T16:23:33.728484Z","shell.execute_reply":"2025-05-23T16:23:33.727377Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# storage bucket where we have the data\ndata_source = \"https://storage.googleapis.com/simpeg/doc-assets/gravity.tar.gz\"\n\n# download the data\ndownloaded_data = utils.download(data_source, overwrite=True)\n\n# unzip the tarfile\ntar = tarfile.open(downloaded_data, \"r\")\ntar.extractall()\ntar.close()\n\n# path to the directory containing our data\ndir_path = downloaded_data.split(\".\")[0] + os.path.sep\n\n# files to work with\ntopo_filename = dir_path + \"gravity_topo.txt\"\ndata_filename = dir_path + \"gravity_data.obs\"","key":"F5WV2qQRko"},{"type":"output","id":"SOxINFtZw_IeqDJRQVKrO","data":[{"name":"stdout","output_type":"stream","text":"Downloading https://storage.googleapis.com/simpeg/doc-assets/gravity.tar.gz\n   saved to: /home/ssoler/git/user-tutorials/notebooks/03-gravity/gravity.tar.gz\nDownload completed!\n"},{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_971017/1191307735.py:9: DeprecationWarning: Python 3.14 will, by default, filter extracted tar archives and reject files or modify their metadata. Use the filter argument to control this behavior.\n  tar.extractall()\n"}],"key":"ARyeVr6Ig4"}],"key":"QnpsjX0ZLw"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#############################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Load Data and Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rZ4uRPMHQG"}],"identifier":"load-data-and-plot","label":"Load Data and Plot","html_id":"load-data-and-plot","implicit":true,"key":"aPg7ZZ2gNN"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Here we load and plot synthetic gravity anomaly data. Topography is generally\ndefined as an (N, 3) array. Gravity data is generally defined with 4 columns:\nx, y, z and data.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ngoSsaahpA"}],"key":"aanfPYzs14"}],"key":"jqcKt6q6AF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:33.731647Z","iopub.status.busy":"2025-05-23T16:23:33.731288Z","iopub.status.idle":"2025-05-23T16:23:34.208567Z","shell.execute_reply":"2025-05-23T16:23:34.207859Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Load topography\nxyz_topo = np.loadtxt(str(topo_filename))\n\n# Load field data\ndobs = np.loadtxt(str(data_filename))\n\n# Define receiver locations and observed data\nreceiver_locations = dobs[:, 0:3]\ndobs = dobs[:, -1]\n\n# Plot\nmpl.rcParams.update({\"font.size\": 12})\nfig = plt.figure(figsize=(7, 5))\n\nax1 = fig.add_axes([0.1, 0.1, 0.73, 0.85])\nplot2Ddata(\n    receiver_locations,\n    dobs,\n    ax=ax1,\n    contourOpts={\"cmap\": \"bwr\"},\n    shade=True,\n    nx=20,\n    ny=20,\n    dataloc=True,\n)\nax1.set_title(\"Gravity Anomaly\")\nax1.set_xlabel(\"x (m)\")\nax1.set_ylabel(\"y (m)\")\n\nax2 = fig.add_axes([0.8, 0.1, 0.03, 0.85])\nnorm = mpl.colors.Normalize(vmin=-np.max(np.abs(dobs)), vmax=np.max(np.abs(dobs)))\ncbar = mpl.colorbar.ColorbarBase(\n    ax2, norm=norm, orientation=\"vertical\", cmap=mpl.cm.bwr, format=\"%.1e\"\n)\ncbar.set_label(\"$mGal$\", rotation=270, labelpad=15, size=12)\n\nplt.show()","key":"t3887Yd8Bz"},{"type":"output","id":"_-_6S-X5OviBshQU_Ua0k","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a4ad56474e8d1d1d073ceb69432ff15a","path":"/user-tutorials/build/a4ad56474e8d1d1d073ceb69432ff15a.png"},"text/plain":{"content":"\u003cFigure size 700x500 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"jPPIcTJlsy"}],"key":"Xiuhkb0FUG"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#############################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Assign Uncertainties","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VpUkhOeCJ8"}],"identifier":"assign-uncertainties","label":"Assign Uncertainties","html_id":"assign-uncertainties","implicit":true,"key":"vX7guqeb2G"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Inversion with simpeg requires that we define the standard deviation of our data.\nThis represents our estimate of the noise in our data. For a gravity inversion,\na constant floor value is generally applied to all data. For this tutorial,\nthe standard deviation on each datum will be 1% of the maximum observed\ngravity anomaly value.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"IOdFcj9tZU"}],"key":"oQLwt7mtV5"}],"key":"JfDBO8ejQB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:34.212373Z","iopub.status.busy":"2025-05-23T16:23:34.212117Z","iopub.status.idle":"2025-05-23T16:23:34.216435Z","shell.execute_reply":"2025-05-23T16:23:34.215706Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"maximum_anomaly = np.max(np.abs(dobs))\n\nuncertainties = 0.01 * maximum_anomaly * np.ones(np.shape(dobs))","key":"WuruVnvFnZ"},{"type":"output","id":"MW12ttUgWkQbQqRA13UXt","data":[],"key":"BxZwb7vp6S"}],"key":"fld7lwzMy6"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#############################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Defining the Survey","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Oaw5SCAtVV"}],"identifier":"defining-the-survey","label":"Defining the Survey","html_id":"defining-the-survey","implicit":true,"key":"G7xaPrlPhK"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Here, we define the survey that will be used for this tutorial. Gravity\nsurveys are simple to create. The user only needs an (N, 3) array to define\nthe xyz locations of the observation locations. From this, the user can\ndefine the receivers and the source field.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"G96WvSZnKz"}],"key":"N78GJ6qlh4"}],"key":"hwVTmjmBYN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:34.219304Z","iopub.status.busy":"2025-05-23T16:23:34.219034Z","iopub.status.idle":"2025-05-23T16:23:34.223620Z","shell.execute_reply":"2025-05-23T16:23:34.222964Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define the receivers. The data consists of vertical gravity anomaly measurements.\n# The set of receivers must be defined as a list.\nreceiver_list = gravity.receivers.Point(receiver_locations, components=\"gz\")\n\nreceiver_list = [receiver_list]\n\n# Define the source field\nsource_field = gravity.sources.SourceField(receiver_list=receiver_list)\n\n# Define the survey\nsurvey = gravity.survey.Survey(source_field)","key":"Dz3O3cGJa0"},{"type":"output","id":"Prlcj9pe4dWfDD3iHffn1","data":[],"key":"gjG9xCTgqI"}],"key":"lqGn1DLbG5"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#############################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Defining the Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oSbxD83P0V"}],"identifier":"defining-the-data","label":"Defining the Data","html_id":"defining-the-data","implicit":true,"key":"k08AFPTOEU"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here is where we define the data that is inverted. The data is defined by\nthe survey, the observation values and the standard deviation.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yftLmrev6j"}],"key":"EdI9h2LI1d"}],"key":"fykC1eUnlp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:34.225959Z","iopub.status.busy":"2025-05-23T16:23:34.225583Z","iopub.status.idle":"2025-05-23T16:23:34.229691Z","shell.execute_reply":"2025-05-23T16:23:34.229070Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"data_object = data.Data(survey, dobs=dobs, standard_deviation=uncertainties)","key":"ubmm8IuhIs"},{"type":"output","id":"MRE4lBxwA4wPd39N1rVVW","data":[],"key":"c2iVgypNtU"}],"key":"OOUVW2lCHU"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#############################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Defining a Tensor Mesh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JHoFvUTD3Z"}],"identifier":"defining-a-tensor-mesh","label":"Defining a Tensor Mesh","html_id":"defining-a-tensor-mesh","implicit":true,"key":"tu13Q0OMhY"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here, we create the tensor mesh that will be used to invert gravity anomaly\ndata. If desired, we could define an OcTree mesh.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nhEriw9gFI"}],"key":"jchdzbOtuE"}],"key":"QzQKaaxLkb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:34.232070Z","iopub.status.busy":"2025-05-23T16:23:34.231759Z","iopub.status.idle":"2025-05-23T16:23:34.237166Z","shell.execute_reply":"2025-05-23T16:23:34.236428Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dh = 5.0\nhx = [(dh, 5, -1.3), (dh, 40), (dh, 5, 1.3)]\nhy = [(dh, 5, -1.3), (dh, 40), (dh, 5, 1.3)]\nhz = [(dh, 5, -1.3), (dh, 15)]\nmesh = TensorMesh([hx, hy, hz], \"CCN\")","key":"YBsHwvoPrx"},{"type":"output","id":"FCSest3I62OGhGusHaIos","data":[],"key":"iAWylnYWhs"}],"key":"ijcX6XMdgv"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"########################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Starting/Reference Model and Mapping on Tensor Mesh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SgZDhfq0XS"}],"identifier":"starting-reference-model-and-mapping-on-tensor-mesh","label":"Starting/Reference Model and Mapping on Tensor Mesh","html_id":"starting-reference-model-and-mapping-on-tensor-mesh","implicit":true,"key":"wXVS1Y3RUz"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Here, we create starting and/or reference models for the inversion as\nwell as the mapping from the model space to the active cells. Starting and\nreference models can be a constant background value or contain a-priori\nstructures.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dD3usU2MKO"}],"key":"IB6B4wNCFS"}],"key":"FRRBGC9k8y"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:34.239424Z","iopub.status.busy":"2025-05-23T16:23:34.239143Z","iopub.status.idle":"2025-05-23T16:23:34.278099Z","shell.execute_reply":"2025-05-23T16:23:34.277378Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Find the indices of the active cells in forward model (ones below surface)\nind_active = active_from_xyz(mesh, xyz_topo)\n\n# Define mapping from model to active cells\nnC = int(ind_active.sum())\nmodel_map = maps.IdentityMap(nP=nC)  # model consists of a value for each active cell\n\n# Define and plot starting model\nstarting_model = np.zeros(nC)","key":"RM3xLX1B6Z"},{"type":"output","id":"eywj6FwK5AY5vZIInF9Xh","data":[],"key":"ZXPF02OK5R"}],"key":"uEdws7toCh"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"##############################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Define the Physics and data misfit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"frlr7xHUZX"}],"identifier":"define-the-physics-and-data-misfit","label":"Define the Physics and data misfit","html_id":"define-the-physics-and-data-misfit","implicit":true,"key":"ZALExUx53A"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here, we define the physics of the gravity problem by using the simulation\nclass.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ar1i09wANg"}],"key":"qSWigEC7OM"}],"key":"UKH6EQrR5W"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:34.280596Z","iopub.status.busy":"2025-05-23T16:23:34.280357Z","iopub.status.idle":"2025-05-23T16:23:34.328405Z","shell.execute_reply":"2025-05-23T16:23:34.327677Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation = gravity.simulation.Simulation3DIntegral(\n    survey=survey, mesh=mesh, rhoMap=model_map, active_cells=ind_active\n)\n\n# Define the data misfit. Here the data misfit is the L2 norm of the weighted\n# residual between the observed data and the data predicted for a given model.\n# Within the data misfit, the residual between predicted and observed data are\n# normalized by the data's standard deviation.\ndmis = data_misfit.L2DataMisfit(data=data_object, simulation=simulation)","key":"BYuC4Vdxen"},{"type":"output","id":"jLvUwU--9pf9jSE69J25I","data":[],"key":"x57YnKzwvn"}],"key":"eS2lNJ5JJw"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#######################################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Running the Depth Weighted inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mO7KXSZaYv"}],"identifier":"running-the-depth-weighted-inversion","label":"Running the Depth Weighted inversion","html_id":"running-the-depth-weighted-inversion","implicit":true,"key":"NIZYp9f3rJ"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here we define the directives, weights, regularization, and optimization\nfor a depth-weighted inversion","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yAWqdzgs72"}],"key":"bt9nJfv3BB"}],"key":"eJhgdqSRL7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:34.331246Z","iopub.status.busy":"2025-05-23T16:23:34.331002Z","iopub.status.idle":"2025-05-23T16:23:55.552437Z","shell.execute_reply":"2025-05-23T16:23:55.551668Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# inversion directives\n# Defining a starting value for the trade-off parameter (beta) between the data\n# misfit and the regularization.\nstarting_beta = directives.BetaEstimate_ByEig(beta0_ratio=1e0)\n\n# Defines the directives for the IRLS regularization. This includes setting\n# the cooling schedule for the trade-off parameter.\nupdate_IRLS = directives.UpdateIRLS(\n    f_min_change=1e-4,\n    max_irls_iterations=30,\n    irls_cooling_factor=1.5,\n    misfit_tolerance=1e-2,\n)\n\n# Options for outputting recovered models and predicted data for each beta.\nsave_iteration = directives.SaveOutputEveryIteration(save_txt=False)\n\n# Updating the preconditionner if it is model dependent.\nupdate_jacobi = directives.UpdatePreconditioner()\n\n# The directives are defined as a list\ndirectives_list = [\n    update_IRLS,\n    starting_beta,\n    save_iteration,\n    update_jacobi,\n]\n\n# Define the regularization (model objective function) with depth weighting.\nreg_dpth = regularization.Sparse(mesh, active_cells=ind_active, mapping=model_map)\nreg_dpth.norms = [0, 2, 2, 2]\ndepth_weights = utils.depth_weighting(\n    mesh, receiver_locations, active_cells=ind_active, exponent=2\n)\nreg_dpth.set_weights(depth_weights=depth_weights)\n\n# Define how the optimization problem is solved. Here we will use a projected\n# Gauss-Newton approach that employs the conjugate gradient solver.\nopt = optimization.ProjectedGNCG(\n    maxIter=100, lower=-1.0, upper=1.0, maxIterLS=20, maxIterCG=10, tolCG=1e-3\n)\n\n# Here we define the inverse problem that is to be solved\ninv_prob = inverse_problem.BaseInvProblem(dmis, reg_dpth, opt)\n\n# Here we combine the inverse problem and the set of directives\ninv = inversion.BaseInversion(inv_prob, directives_list)\n\n# Run inversion\nrecovered_model_dpth = inv.run(starting_model)","key":"ga2FEa6P9v"},{"type":"output","id":"4bx-5Z0Cd4XLMu4-nAuXr","data":[{"name":"stdout","output_type":"stream","text":"\nRunning inversion with SimPEG v0.24.0\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\n\n                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.\n                    ***Done using the default solver Pardiso and no solver_opts.***\n                    \n"},{"name":"stdout","output_type":"stream","text":"model has any nan: 0\n=============================== Projected GNCG ===============================\n  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   \n-----------------------------------------------------------------------------\nx0 has any nan: 0\n   0  9.78e+02  2.66e+05  0.00e+00  2.66e+05    2.19e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   1  4.89e+02  3.19e+03  1.71e+01  1.16e+04    2.10e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   2  2.44e+02  1.21e+03  1.99e+01  6.07e+03    2.04e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   3  1.22e+02  4.61e+02  2.20e+01  3.15e+03    1.93e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"Reached starting chifact with l2-norm regularization: Start IRLS steps...\nirls_threshold 0.05928551292065909\n"},{"name":"stdout","output_type":"stream","text":"   4  1.22e+02  1.83e+02  4.61e+01  5.82e+03    2.06e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   5  1.50e+02  2.53e+02  5.92e+01  9.16e+03    2.12e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   6  8.26e+01  4.75e+02  6.48e+01  5.83e+03    2.03e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   7  1.05e+02  2.39e+02  6.72e+01  7.28e+03    2.14e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   8  6.21e+01  3.97e+02  5.96e+01  4.10e+03    2.10e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   9  8.13e+01  2.25e+02  5.22e+01  4.47e+03    2.15e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  10  9.84e+01  2.61e+02  4.39e+01  4.58e+03    2.16e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  11  6.43e+01  3.07e+02  3.79e+01  2.74e+03    2.08e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  12  9.10e+01  1.92e+02  3.32e+01  3.21e+03    2.17e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  13  1.11e+02  2.57e+02  2.73e+01  3.29e+03    2.17e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  14  7.24e+01  3.07e+02  2.30e+01  1.97e+03    2.03e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  15  9.85e+01  2.08e+02  2.14e+01  2.32e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  16  1.21e+02  2.55e+02  1.85e+01  2.49e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  17  8.00e+01  2.93e+02  1.64e+01  1.60e+03    2.04e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  18  1.06e+02  2.19e+02  1.62e+01  1.94e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  19  1.29e+02  2.60e+02  1.48e+01  2.17e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  20  1.50e+02  2.79e+02  1.36e+01  2.32e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  21  1.73e+02  2.85e+02  1.28e+01  2.50e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  22  1.99e+02  2.90e+02  1.22e+01  2.72e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  23  1.31e+02  2.98e+02  1.18e+01  1.85e+03    1.88e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  24  1.72e+02  2.25e+02  1.20e+01  2.28e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  25  2.13e+02  2.49e+02  1.15e+01  2.69e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  26  2.55e+02  2.67e+02  1.11e+01  3.09e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  27  3.01e+02  2.72e+02  1.07e+01  3.50e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  28  3.47e+02  2.85e+02  1.05e+01  3.92e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  29  3.99e+02  2.91e+02  1.02e+01  4.37e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  30  2.62e+02  3.04e+02  9.94e+00  2.90e+03    2.08e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  31  3.36e+02  2.33e+02  1.01e+01  3.62e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  32  4.08e+02  2.60e+02  9.86e+00  4.28e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  33  4.74e+02  2.81e+02  9.67e+00  4.86e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"Reach maximum number of IRLS cycles: 30\n------------------------- STOP! -------------------------\n1 : |fc-fOld| = 0.0000e+00 \u003c= tolF*(1+|f0|) = 2.6622e+04\n1 : |xc-x_last| = 2.9311e-02 \u003c= tolX*(1+|x0|) = 1.0000e-01\n0 : |proj(x-g)-x|    = 2.1837e+02 \u003c= tolG          = 1.0000e-01\n0 : |proj(x-g)-x|    = 2.1837e+02 \u003c= 1e3*eps       = 1.0000e-02\n0 : maxIter   =     100    \u003c= iter          =     34\n------------------------- DONE! -------------------------\n"}],"key":"NIAxaUanLJ"}],"key":"qpJlLYhu2i"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#######################################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Running the Distance Weighted inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GLAwACkcmc"}],"identifier":"running-the-distance-weighted-inversion","label":"Running the Distance Weighted inversion","html_id":"running-the-distance-weighted-inversion","implicit":true,"key":"Mzc8kp95Sx"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here we define the directives, weights, regularization, and optimization\nfor a distance-weighted inversion","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"orcuxZHoyx"}],"key":"AGtWKwXFrA"}],"key":"Bl0S3UvFl2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:23:55.555600Z","iopub.status.busy":"2025-05-23T16:23:55.555048Z","iopub.status.idle":"2025-05-23T16:24:22.553126Z","shell.execute_reply":"2025-05-23T16:24:22.552231Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# inversion directives\n# Defining a starting value for the trade-off parameter (beta) between the data\n# misfit and the regularization.\nstarting_beta = directives.BetaEstimate_ByEig(beta0_ratio=1e0)\n\n# Defines the directives for the IRLS regularization. This includes setting\n# the cooling schedule for the trade-off parameter.\nupdate_IRLS = directives.UpdateIRLS(\n    f_min_change=1e-4,\n    max_irls_iterations=30,\n    irls_cooling_factor=1.5,\n    misfit_tolerance=1e-2,\n)\n\n# Options for outputting recovered models and predicted data for each beta.\nsave_iteration = directives.SaveOutputEveryIteration(save_txt=False)\n\n# Updating the preconditionner if it is model dependent.\nupdate_jacobi = directives.UpdatePreconditioner()\n\n# The directives are defined as a list\ndirectives_list = [\n    update_IRLS,\n    starting_beta,\n    save_iteration,\n    update_jacobi,\n]\n\n# Define the regularization (model objective function) with distance weighting.\nreg_dist = regularization.Sparse(mesh, active_cells=ind_active, mapping=model_map)\nreg_dist.norms = [0, 2, 2, 2]\ndistance_weights = utils.distance_weighting(\n    mesh, receiver_locations, active_cells=ind_active, exponent=2\n)\nreg_dist.set_weights(distance_weights=distance_weights)\n\n# Define how the optimization problem is solved. Here we will use a projected\n# Gauss-Newton approach that employs the conjugate gradient solver.\nopt = optimization.ProjectedGNCG(\n    maxIter=100, lower=-1.0, upper=1.0, maxIterLS=20, maxIterCG=10, tolCG=1e-3\n)\n\n# Here we define the inverse problem that is to be solved\ninv_prob = inverse_problem.BaseInvProblem(dmis, reg_dist, opt)\n\n# Here we combine the inverse problem and the set of directives\ninv = inversion.BaseInversion(inv_prob, directives_list)\n\n# Run inversion\nrecovered_model_dist = inv.run(starting_model)","key":"ynfW4j7GVt"},{"type":"output","id":"8iOvO8fnuNSS1VQQlaXJQ","data":[{"name":"stdout","output_type":"stream","text":"\nRunning inversion with SimPEG v0.24.0\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\n\n                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.\n                    ***Done using the default solver Pardiso and no solver_opts.***\n                    \n"},{"name":"stdout","output_type":"stream","text":"model has any nan: 0\n=============================== Projected GNCG ===============================\n  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   \n-----------------------------------------------------------------------------\nx0 has any nan: 0\n"},{"name":"stdout","output_type":"stream","text":"   0  2.86e+03  2.66e+05  0.00e+00  2.66e+05    2.19e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   1  1.43e+03  2.35e+04  1.41e+01  4.37e+04    2.17e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   2  7.15e+02  1.05e+04  2.04e+01  2.51e+04    2.15e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   3  3.57e+02  4.24e+03  2.65e+01  1.37e+04    2.11e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   4  1.79e+02  1.62e+03  3.15e+01  7.25e+03    2.05e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   5  8.94e+01  6.17e+02  3.53e+01  3.77e+03    1.96e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"Reached starting chifact with l2-norm regularization: Start IRLS steps...\nirls_threshold 0.05584940363763429\n"},{"name":"stdout","output_type":"stream","text":"   6  8.94e+01  2.43e+02  7.45e+01  6.90e+03    2.08e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   7  5.55e+01  3.53e+02  9.54e+01  5.65e+03    2.06e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   8  7.31e+01  2.22e+02  1.13e+02  8.51e+03    2.14e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   9  4.07e+01  4.59e+02  1.08e+02  4.85e+03    2.05e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  10  5.12e+01  2.43e+02  9.71e+01  5.21e+03    2.14e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  11  3.39e+01  2.94e+02  8.14e+01  3.05e+03    2.06e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  12  4.87e+01  1.85e+02  6.95e+01  3.57e+03    2.16e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  13  6.40e+01  2.23e+02  5.90e+01  4.00e+03    2.16e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  14  7.39e+01  2.84e+02  4.90e+01  3.91e+03    2.16e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  15  4.83e+01  3.08e+02  4.11e+01  2.29e+03    2.09e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  16  6.72e+01  1.98e+02  3.76e+01  2.72e+03    2.17e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  17  8.43e+01  2.44e+02  3.26e+01  2.99e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  18  1.06e+02  2.90e+02  2.88e+01  3.34e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  19  6.65e+01  3.40e+02  2.59e+01  2.06e+03    2.14e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  20  8.47e+01  2.37e+02  2.54e+01  2.39e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  21  1.01e+02  2.66e+02  2.35e+01  2.65e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  22  6.73e+01  2.93e+02  2.22e+01  1.78e+03    2.02e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  23  9.04e+01  2.13e+02  2.21e+01  2.21e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  24  1.14e+02  2.40e+02  2.08e+01  2.62e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  25  1.39e+02  2.61e+02  1.99e+01  3.01e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  26  1.64e+02  2.72e+02  1.91e+01  3.40e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  27  1.90e+02  2.81e+02  1.85e+01  3.80e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  28  2.21e+02  2.92e+02  1.80e+01  4.27e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  29  1.44e+02  3.06e+02  1.77e+01  2.85e+03    2.03e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  30  1.87e+02  2.28e+02  1.78e+01  3.57e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  31  2.31e+02  2.53e+02  1.74e+01  4.27e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  32  2.71e+02  2.76e+02  1.70e+01  4.88e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  33  1.80e+02  2.92e+02  1.66e+01  3.27e+03    1.56e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  34  2.40e+02  2.16e+02  1.67e+01  4.22e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  35  2.94e+02  2.54e+02  1.63e+01  5.06e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"Reach maximum number of IRLS cycles: 30\n------------------------- STOP! -------------------------\n1 : |fc-fOld| = 0.0000e+00 \u003c= tolF*(1+|f0|) = 2.6622e+04\n1 : |xc-x_last| = 4.0755e-02 \u003c= tolX*(1+|x0|) = 1.0000e-01\n0 : |proj(x-g)-x|    = 2.1824e+02 \u003c= tolG          = 1.0000e-01\n0 : |proj(x-g)-x|    = 2.1824e+02 \u003c= 1e3*eps       = 1.0000e-02\n0 : maxIter   =     100    \u003c= iter          =     36\n------------------------- DONE! -------------------------\n"}],"key":"oMRmnw8nHM"}],"key":"pgC8xkQ72F"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"#######################################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Running the Distance Weighted inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R87heGbPWU"}],"identifier":"running-the-distance-weighted-inversion","label":"Running the Distance Weighted inversion","html_id":"running-the-distance-weighted-inversion-1","implicit":true,"key":"HpKy7xcaFl"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here we define the directives, weights, regularization, and optimization\nfor a sensitivity weighted inversion","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"L6Bnkn5scj"}],"key":"HJzoBaXxD0"}],"key":"n218BNc2LP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:24:22.556464Z","iopub.status.busy":"2025-05-23T16:24:22.555739Z","iopub.status.idle":"2025-05-23T16:24:46.531761Z","shell.execute_reply":"2025-05-23T16:24:46.530871Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# inversion directives\n# Defining a starting value for the trade-off parameter (beta) between the data\n# misfit and the regularization.\nstarting_beta = directives.BetaEstimate_ByEig(beta0_ratio=1e0)\n\n# Defines the directives for the IRLS regularization. This includes setting\n# the cooling schedule for the trade-off parameter.\nupdate_IRLS = directives.UpdateIRLS(\n    f_min_change=1e-4,\n    max_irls_iterations=30,\n    irls_cooling_factor=1.5,\n    misfit_tolerance=1e-2,\n)\n\n# Options for outputting recovered models and predicted data for each beta.\nsave_iteration = directives.SaveOutputEveryIteration(save_txt=False)\n\n# Updating the preconditionner if it is model dependent.\nupdate_jacobi = directives.UpdatePreconditioner()\n\n# Add sensitivity weights\nsensitivity_weights = directives.UpdateSensitivityWeights(every_iteration=False)\n\n# The directives are defined as a list\ndirectives_list = [\n    update_IRLS,\n    sensitivity_weights,\n    starting_beta,\n    save_iteration,\n    update_jacobi,\n]\n\n# Define the regularization (model objective function) for sensitivity weighting.\nreg_sensw = regularization.Sparse(mesh, active_cells=ind_active, mapping=model_map)\nreg_sensw.norms = [0, 2, 2, 2]\n\n# Define how the optimization problem is solved. Here we will use a projected\n# Gauss-Newton approach that employs the conjugate gradient solver.\nopt = optimization.ProjectedGNCG(\n    maxIter=100, lower=-1.0, upper=1.0, maxIterLS=20, maxIterCG=10, tolCG=1e-3\n)\n\n# Here we define the inverse problem that is to be solved\ninv_prob = inverse_problem.BaseInvProblem(dmis, reg_sensw, opt)\n\n# Here we combine the inverse problem and the set of directives\ninv = inversion.BaseInversion(inv_prob, directives_list)\n\n# Run inversion\nrecovered_model_sensw = inv.run(starting_model)","key":"d4RWo0pMMP"},{"type":"output","id":"3cbnq1b0nGbwgUr3gZ7He","data":[{"name":"stdout","output_type":"stream","text":"\nRunning inversion with SimPEG v0.24.0\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\n\n                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.\n                    ***Done using the default solver Pardiso and no solver_opts.***\n                    \n"},{"name":"stdout","output_type":"stream","text":"model has any nan: 0\n=============================== Projected GNCG ===============================\n  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   \n-----------------------------------------------------------------------------\nx0 has any nan: 0\n   0  3.20e+03  2.66e+05  0.00e+00  2.66e+05    2.19e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   1  1.60e+03  1.88e+04  1.15e+01  3.72e+04    2.16e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   2  8.00e+02  8.19e+03  1.61e+01  2.11e+04    2.14e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   3  4.00e+02  3.26e+03  2.03e+01  1.14e+04    2.10e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   4  2.00e+02  1.24e+03  2.38e+01  5.99e+03    2.00e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   5  1.00e+02  4.71e+02  2.64e+01  3.11e+03    1.91e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"Reached starting chifact with l2-norm regularization: Start IRLS steps...\nirls_threshold 0.05481358175866103\n"},{"name":"stdout","output_type":"stream","text":"   6  1.00e+02  1.89e+02  5.44e+01  5.63e+03    2.09e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   7  1.19e+02  2.68e+02  6.88e+01  8.49e+03    2.14e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   8  6.87e+01  4.27e+02  7.46e+01  5.55e+03    1.86e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   9  8.75e+01  2.37e+02  7.61e+01  6.90e+03    2.16e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  10  5.19e+01  3.97e+02  6.77e+01  3.91e+03    2.08e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  11  7.14e+01  2.04e+02  5.95e+01  4.45e+03    2.15e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  12  9.04e+01  2.40e+02  5.00e+01  4.75e+03    2.14e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  13  5.96e+01  2.99e+02  4.21e+01  2.80e+03    2.16e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  14  8.56e+01  1.86e+02  3.68e+01  3.34e+03    2.16e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  15  1.13e+02  2.20e+02  3.15e+01  3.78e+03    2.17e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  16  1.36e+02  2.63e+02  2.73e+01  3.99e+03    2.17e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  17  8.97e+01  3.01e+02  2.43e+01  2.48e+03    2.08e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  18  1.21e+02  2.11e+02  2.32e+01  3.02e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  19  1.49e+02  2.55e+02  2.12e+01  3.41e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  20  9.85e+01  2.95e+02  1.98e+01  2.24e+03    2.05e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  21  1.33e+02  2.12e+02  1.94e+01  2.79e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  22  1.65e+02  2.47e+02  1.84e+01  3.28e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  23  1.95e+02  2.75e+02  1.75e+01  3.68e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  24  2.24e+02  2.85e+02  1.68e+01  4.05e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  25  1.48e+02  2.98e+02  1.62e+01  2.70e+03    1.93e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  26  2.01e+02  2.08e+02  1.62e+01  3.47e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  27  2.52e+02  2.46e+02  1.57e+01  4.21e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  28  2.93e+02  2.80e+02  1.54e+01  4.78e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  29  1.93e+02  2.98e+02  1.50e+01  3.19e+03    1.59e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  30  2.63e+02  2.09e+02  1.50e+01  4.16e+03    2.18e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  31  3.26e+02  2.49e+02  1.46e+01  5.01e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  32  3.77e+02  2.83e+02  1.43e+01  5.67e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  33  2.45e+02  3.13e+02  1.40e+01  3.75e+03    2.02e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  34  3.25e+02  2.18e+02  1.42e+01  4.84e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"  35  3.90e+02  2.66e+02  1.39e+01  5.68e+03    2.18e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"Reach maximum number of IRLS cycles: 30\n------------------------- STOP! -------------------------\n1 : |fc-fOld| = 0.0000e+00 \u003c= tolF*(1+|f0|) = 2.6622e+04\n1 : |xc-x_last| = 3.4660e-02 \u003c= tolX*(1+|x0|) = 1.0000e-01\n0 : |proj(x-g)-x|    = 2.1800e+02 \u003c= tolG          = 1.0000e-01\n0 : |proj(x-g)-x|    = 2.1800e+02 \u003c= 1e3*eps       = 1.0000e-02\n0 : maxIter   =     100    \u003c= iter          =     36\n------------------------- DONE! -------------------------\n"}],"key":"zDUIhnNvL2"}],"key":"ivdQoqxoeV"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"############################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Recreate True Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f7p4W6zfc1"}],"identifier":"recreate-true-model","label":"Recreate True Model","html_id":"recreate-true-model","implicit":true,"key":"Sup866cVvv"}],"key":"jpNfYBTd5m"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:24:46.535235Z","iopub.status.busy":"2025-05-23T16:24:46.534335Z","iopub.status.idle":"2025-05-23T16:24:46.546603Z","shell.execute_reply":"2025-05-23T16:24:46.545890Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define density contrast values for each unit in g/cc\nbackground_density = 0.0\nblock_density = -0.2\nsphere_density = 0.2\n\n# Define model. Models in simpeg are vector arrays.\ntrue_model = background_density * np.ones(nC)\n\n# You could find the indicies of specific cells within the model and change their\n# value to add structures.\nind_block = (\n    (mesh.gridCC[ind_active, 0] \u003e -50.0)\n    \u0026 (mesh.gridCC[ind_active, 0] \u003c -20.0)\n    \u0026 (mesh.gridCC[ind_active, 1] \u003e -15.0)\n    \u0026 (mesh.gridCC[ind_active, 1] \u003c 15.0)\n    \u0026 (mesh.gridCC[ind_active, 2] \u003e -50.0)\n    \u0026 (mesh.gridCC[ind_active, 2] \u003c -30.0)\n)\ntrue_model[ind_block] = block_density\n\n# You can also use simpeg utilities to add structures to the model more concisely\nind_sphere = model_builder.get_indices_sphere(\n    np.r_[35.0, 0.0, -40.0], 15.0, mesh.gridCC\n)\nind_sphere = ind_sphere[ind_active]\ntrue_model[ind_sphere] = sphere_density","key":"HF3XrK098v"},{"type":"output","id":"LJQ3m8KAF3W048cP7hC0v","data":[],"key":"Nke9yd8pvo"}],"key":"EPaeggtyTJ"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"############################################################"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Plotting True Model and Recovered Models","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hbahgbUiHC"}],"identifier":"plotting-true-model-and-recovered-models","label":"Plotting True Model and Recovered Models","html_id":"plotting-true-model-and-recovered-models","implicit":true,"key":"AUSp2z4ZeA"}],"key":"EC1cmq5lLf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:24:46.549620Z","iopub.status.busy":"2025-05-23T16:24:46.549086Z","iopub.status.idle":"2025-05-23T16:24:47.702440Z","shell.execute_reply":"2025-05-23T16:24:47.701381Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot Models\nfig, ax = plt.subplots(2, 2, figsize=(20, 10), sharex=True, sharey=True)\nax = ax.flatten()\nplotting_map = maps.InjectActiveCells(mesh, ind_active, np.nan)\ncmap = \"coolwarm\"\nslice_y_loc = 0.0\n\nmm = mesh.plot_slice(\n    plotting_map * true_model,\n    normal=\"Y\",\n    ax=ax[0],\n    grid=False,\n    slice_loc=slice_y_loc,\n    pcolor_opts={\"cmap\": cmap, \"norm\": norm},\n)\nax[0].set_title(f\"True model slice at y = {slice_y_loc} m\")\nplt.colorbar(mm[0], label=\"$g/cm^3$\", ax=ax[0])\n\n# plot depth weighting result\nvmax = np.abs(recovered_model_dpth).max()\nnorm = mpl.colors.TwoSlopeNorm(vcenter=0, vmin=-vmax, vmax=vmax)\nmm = mesh.plot_slice(\n    plotting_map * recovered_model_dpth,\n    normal=\"Y\",\n    ax=ax[1],\n    grid=False,\n    slice_loc=slice_y_loc,\n    pcolor_opts={\"cmap\": cmap, \"norm\": norm},\n)\nax[1].set_title(f\"Depth weighting Model slice at y = {slice_y_loc} m\")\nplt.colorbar(mm[0], label=\"$g/cm^3$\", ax=ax[1])\n\n# plot distance weighting result\nvmax = np.abs(recovered_model_dist).max()\nnorm = mpl.colors.TwoSlopeNorm(vcenter=0, vmin=-vmax, vmax=vmax)\nmm = mesh.plot_slice(\n    plotting_map * recovered_model_dist,\n    normal=\"Y\",\n    ax=ax[2],\n    grid=False,\n    slice_loc=slice_y_loc,\n    pcolor_opts={\"cmap\": cmap, \"norm\": norm},\n)\nax[2].set_title(f\"Distance weighting Model slice at y = {slice_y_loc} m\")\nplt.colorbar(mm[0], label=\"$g/cm^3$\", ax=ax[2])\n\n# plot sensitivity weighting result\nvmax = np.abs(recovered_model_sensw).max()\nnorm = mpl.colors.TwoSlopeNorm(vcenter=0, vmin=-vmax, vmax=vmax)\nmm = mesh.plot_slice(\n    plotting_map * recovered_model_sensw,\n    normal=\"Y\",\n    ax=ax[3],\n    grid=False,\n    slice_loc=slice_y_loc,\n    pcolor_opts={\"cmap\": cmap, \"norm\": norm},\n)\nax[3].set_title(f\"Sensitivity weighting Model slice at y = {slice_y_loc} m\")\nplt.colorbar(mm[0], label=\"$g/cm^3$\", ax=ax[3])\n\n# shared plotting\nplotting_map = maps.InjectActiveCells(mesh, ind_active, 0.0)\nslice_y_ind = (\n    mesh.cell_centers[:, 1] == np.abs(mesh.cell_centers[:, 1] - slice_y_loc).min()\n)\nfor axx in ax:\n    utils.plot2Ddata(\n        mesh.cell_centers[slice_y_ind][:, [0, 2]],\n        (plotting_map * true_model)[slice_y_ind],\n        contourOpts={\"alpha\": 0},\n        level=True,\n        ncontour=2,\n        levelOpts={\"colors\": \"grey\", \"linewidths\": 2, \"linestyles\": \"--\"},\n        method=\"nearest\",\n        ax=axx,\n    )\n    axx.set_aspect(1)\n\nplt.tight_layout()","key":"TUw9zCEGyp"},{"type":"output","id":"wrYixxRPfpX7yY5IifEuq","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"30e1f355fee1b48bd29d902558b42646","path":"/user-tutorials/build/30e1f355fee1b48bd29d902558b42646.png"},"text/plain":{"content":"\u003cFigure size 2000x1000 with 8 Axes\u003e","content_type":"text/plain"}}}],"key":"tTReXjmZ3w"}],"key":"FJTGRkYUQA"},{"type":"block","kind":"notebook-content","data":{"cell_marker":"############################################################","lines_to_next_cell":0},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Visualize weights","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vSai4WbVoD"}],"identifier":"visualize-weights","label":"Visualize weights","html_id":"visualize-weights","implicit":true,"key":"E9LGQfDwMA"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Plot Weights","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dwZBbEns4j"}],"key":"HH4fKvWUy3"}],"key":"J5HceA0cwh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T16:24:47.706227Z","iopub.status.busy":"2025-05-23T16:24:47.705989Z","iopub.status.idle":"2025-05-23T16:24:48.326628Z","shell.execute_reply":"2025-05-23T16:24:48.325461Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 3, figsize=(20, 4), sharex=True, sharey=True)\nplotting_map = maps.InjectActiveCells(mesh, ind_active, np.nan)\ncmap = \"magma\"\nslice_y_loc = 0.0\n\n# plot depth weights\nmm = mesh.plot_slice(\n    plotting_map * np.log10(depth_weights),\n    normal=\"Y\",\n    ax=ax[0],\n    grid=False,\n    slice_loc=slice_y_loc,\n    pcolor_opts={\"cmap\": cmap},\n)\nax[0].set_title(f\"log10(depth weights) slice at y = {slice_y_loc} m\")\nplt.colorbar(mm[0], label=\"log10(depth weights)\", ax=ax[0])\n\n# plot distance weights\nmm = mesh.plot_slice(\n    plotting_map * np.log10(distance_weights),\n    normal=\"Y\",\n    ax=ax[1],\n    grid=False,\n    slice_loc=slice_y_loc,\n    pcolor_opts={\"cmap\": cmap},\n)\nax[1].set_title(f\"log10(distance weights) slice at y = {slice_y_loc} m\")\nplt.colorbar(mm[0], label=\"log10(distance weights)\", ax=ax[1])\n\n# plot sensitivity weights\nmm = mesh.plot_slice(\n    plotting_map * np.log10(reg_sensw.objfcts[0].get_weights(key=\"sensitivity\")),\n    normal=\"Y\",\n    ax=ax[2],\n    grid=False,\n    slice_loc=slice_y_loc,\n    pcolor_opts={\"cmap\": cmap},\n)\nax[2].set_title(f\"log10(sensitivity weights) slice at y = {slice_y_loc} m\")\nplt.colorbar(mm[0], label=\"log10(sensitivity weights)\", ax=ax[2])\n\n# shared plotting\nfor axx in ax:\n    axx.set_aspect(1)\n\nplt.tight_layout()","key":"tox9FtWxEe"},{"type":"output","id":"kPNwnlDv6oL8allcZThJD","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4468057a1aa02f8ecd9a8a8d999f98b7","path":"/user-tutorials/build/4468057a1aa02f8ecd9a8a8d999f98b7.png"},"text/plain":{"content":"\u003cFigure size 2000x400 with 6 Axes\u003e","content_type":"text/plain"}}}],"key":"JTzgOPYvW6"}],"key":"BKXG3Xbwmc"}],"key":"erdeyddzgj"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"3D Inversion of Gravity Anomaly Data","url":"/inv-gravity-anomaly-3d","group":"SimPEG User Tutorials"},"next":{"title":"Magnetics","url":"/magnetics-index","group":"SimPEG User Tutorials"}}},"domain":"http://localhost:3000"},"project":{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/user-tutorials/build/manifest-ED236704.js";
import * as route0 from "/user-tutorials/build/root-ZJOPFBMV.js";
import * as route1 from "/user-tutorials/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/user-tutorials/build/entry.client-UNPC4GT3.js");</script></body></html>