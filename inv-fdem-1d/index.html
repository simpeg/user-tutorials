<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>1D Inversion of Frequency Domain EM Data for a Single Sounding - SimPEG User Tutorials</title><meta property="og:title" content="1D Inversion of Frequency Domain EM Data for a Single Sounding - SimPEG User Tutorials"/><meta name="generator" content="mystmd"/><meta name="description" content="SimPEG user tutorials"/><meta property="og:description" content="SimPEG user tutorials"/><meta name="keywords" content="geophysics, inversions, python, open-source"/><meta name="image" content="/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png"/><meta property="og:image" content="/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png"/><link rel="stylesheet" href="/user-tutorials/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/user-tutorials/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script defer="" data-domain="simpeg.xyz" src="https://plausible.io/js/plausible.js"></script><link rel="icon" href="/user-tutorials/favicon.ico"/><link rel="stylesheet" href="/user-tutorials/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/user-tutorials/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png" class="h-9" alt="User Tutorials" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5">User Tutorials</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0" data-headlessui-state=""><div class="inline-block"><button class="inline-flex items-center justify-center w-full py-1 mx-2 font-medium rounded-md text-md text-stone-900 dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" id="headlessui-menu-button-:R1j4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span>SimPEG</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="ml-2 -mr-1 text-violet-200 hover:text-violet-100"><path fill-rule="evenodd" d="M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://mystmd.org/guide" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Learn More</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a class="py-2 grow" href="/">SimPEG</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rap8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rap8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="SimPEG User Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/user-tutorials/">SimPEG User Tutorials</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Gravity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/gravity-index">Gravity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Magnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/magnetics-index">Magnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Direct Current Resistivity" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/dcr-index">Direct Current Resistivity</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Induced Polarization" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/ip-index">Induced Polarization</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Frequency-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/fdem-index">Frequency-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Time-Domain Electromagnetics" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/tdem-index">Time-Domain Electromagnetics</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1up8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1up8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Joint Inversion" class="block break-words rounded py-2 grow cursor-pointer">Joint Inversion</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="PGI Inversion" class="block break-words rounded py-2 grow cursor-pointer">PGI Inversion</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="Contributing to User Tutorials" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/user-tutorials/contributing-index">Contributing to User Tutorials</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">SimPEG User Tutorials</div><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" title="Code License: MIT License (MIT)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://github.com/simpeg/user-tutorials" title="GitHub Repository: simpeg/user-tutorials" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/simpeg/user-tutorials/edit/main/notebooks/07-fdem/inv_fdem_1d.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">1D Inversion of Frequency Domain EM Data for a Single Sounding</h1><header class="mt-4 not-prose"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div><span class="font-semibold text-sm"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R2t8top:" data-state="closed">Devin Cowan</button><a class="ml-1" href="https://orcid.org/0000-0002-0089-402X" title="ORCID: 0000-0002-0089-402X" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 -translate-y-[0.1em] hover:text-[#A9C751]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia<!-- --> <a class="ml-1" href="https://ror.org/03rmrcq20" target="_blank" rel="noopener noreferrer" title="Research Organization Registry"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block"><path d="M10 4.2L8.3 6.8 6.6 4.2H10zM17.1 4.2l-1.7 2.6-1.7-2.6h3.4zM6.6 19.8l1.7-2.6 1.7 2.6H6.6zM13.7 19.8l1.7-2.6 1.7 2.6h-3.4zM20.8 12.5c.6-.1 1.1-.4 1.4-.8.3-.4.5-.9.5-1.5 0-.5-.1-.9-.3-1.2-.2-.3-.4-.6-.7-.8-.3-.2-.6-.3-1-.4-.4-.1-.8-.1-1.2-.1h-3.3v2.6c0-.1-.1-.2-.1-.2-.2-.6-.6-1-1-1.4-.4-.4-.9-.7-1.5-.9-.6-.2-1.2-.3-1.9-.3s-1.3.1-1.9.3c-.5.1-1 .4-1.4.8-.3.4-.6.8-.9 1.3 0-.3-.1-.6-.2-.9-.2-.4-.4-.6-.7-.8-.3-.2-.6-.3-1-.4s-.8-.2-1.3-.2H1v8.5h1.9v-3.4h.9l1.8 3.4h2.3l-2.2-3.6c.6-.1 1.1-.4 1.4-.8v-.1.2c0 .7.1 1.3.3 1.8.2.6.6 1 1 1.4.4.4.9.7 1.5.9.6.2 1.2.3 1.9.3s1.3-.1 1.9-.3c.6-.2 1.1-.5 1.5-.9.4-.4.7-.9 1-1.4 0-.1.1-.2.1-.2V16H18v-3.4h.9l1.8 3.4H23l-2.2-3.5zM5.4 10.7c-.1.2-.2.3-.3.3-.2.1-.3.1-.5.1H2.9V9.2h1.7c.2 0 .3.1.5.1.1.1.3.2.3.3.1.1.1.3.1.5.1.3 0 .5-.1.6zm8.8 2.3c-.1.3-.3.6-.5.9-.2.2-.5.4-.8.6-.3.1-.7.2-1.1.2-.4 0-.8-.1-1.1-.2-.3-.1-.6-.3-.8-.6-.2-.2-.4-.5-.5-.9-.1-.3-.2-.7-.2-1.1 0-.4.1-.8.2-1.1s.3-.6.5-.9c.2-.2.5-.4.8-.6.3-.1.7-.2 1.1-.2.4 0 .8.1 1.1.2.3.1.6.3.8.6.2.2.4.5.5.9.1.3.2.7.2 1.1 0 .4 0 .7-.2 1.1zm6.4-2.3c-.1.1-.2.2-.4.3-.2.1-.3.1-.5.1H18V9.2h1.7c.2 0 .3.1.5.1.1.1.3.2.3.3.1.1.1.3.1.5.1.3.1.5 0 .6z"></path></svg></a></div></div></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="xg7tjT6kAz" class="relative group/block"><aside class="myst-admonition myst-admonition-caution my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-amber-600 caution"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-amber-600 bg-amber-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-amber-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Intermediate notebook</div></div><div class="myst-admonition-body px-4 py-1"><p>This tutorial focusses on intermediate level functionality within SimPEG. Basic functionality within SimPEG is not discussed in detail, as we assume the user is already familiar.</p></div></aside></div><div id="ZsNvRuh37u" class="relative group/block"><aside class="myst-admonition myst-admonition-hint my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-green-600 hint"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Light-weight notebook</div></div><div class="myst-admonition-body px-4 py-1"><p>This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.</p></div></aside></div><div id="WmGc4cBcQ6" class="relative group/block"><p><strong>Keywords:</strong> frequency-domain EM, 1D sounding, inversion, parametric, sparse norm, wires mapping</p><p><strong>Summary:</strong> Here, we invert secondary magnetic field data for a single 1D FDEM sounding. We demonstrate 3 approaches for inverting the data:</p><ol start="1"><li><p>A weighted least-squares inversion where the number of layers and their thicknesses are fixed</p></li><li><p>An iteratively re-weighted least-squares (IRLS) inversion to recover sparse and/or blocky structures</p></li><li><p>A parametric inversion where we invert for the layer thicknesses and electrical properties assuming a 3-layered Earth</p></li></ol><p>The <em>weighted least-squares</em> approach is a great introduction to geophysical inversion with SimPEG. One drawback however, is that it recovers smooth structures which may not be representative of the true model. To recover sparse and/or blocky 1D structures, we demonstrate an <em>iteratively re-weighted least-squares</em> approach. If the number of layers is known, but their depths, thicknesses and conductivities are not, we can use a <em>parametric inversion</em> approach.</p><p><strong>Learning Objectives:</strong> Because this tutorial focusses primarily on inversion-related functionality, we urge the reader to become familiar with functionality explained in the <a class="" href="/user-tutorials/fwd-fdem-1d">1D Forward Simulation of Frequency-Domain EM Data for a Single Sounding</a> tutorial before working through this one. For this tutorial, we focus on:</p><ul><li><p>How to carry out 1D geophysical inversion with SimPEG.</p></li><li><p>How to assign appropriate uncertainties to FDEM data.</p></li><li><p>Choosing suitable parameters for the inversion.</p></li><li><p>Specifying directives that are applied throughout the inversion.</p></li><li><p>Weighted least-squares, sparse-norm and parametric inversion.</p></li><li><p>Analyzing inversion outputs.</p></li></ul></div><div id="mqc0tsyd50" class="relative group/block"><h2 id="importing-modules" class="relative group"><span class="heading-text">Importing Modules</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#importing-modules" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we import all of the functionality required to run the notebook for the tutorial exercise.
All of the functionality specific to the forward simulation of 1D frequency domain EM data are imported from the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/simpeg.electromagnetics.frequency_domain.html#module-simpeg.electromagnetics.frequency_domain" class="">simpeg<wbr/>.electromagnetics<wbr/>.frequency<wbr/>_domain</a> module. Classes required to define the data misfit, regularization, optimization, etc... are imported from elsewhere within SimPEG. We also import some useful utility functions from <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/simpeg.utils.html#module-simpeg.utils" class="">simpeg.utils</a>. To generate the mesh used for the inversion, we use the <a target="_blank" rel="noreferrer" href="https://discretize.simpeg.xyz/en/main" class="">discretize</a> package.</p></div><div id="aK76ck2H9Q" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># SimPEG functionality
import simpeg.electromagnetics.frequency_domain as fdem
from simpeg.utils import plot_1d_layer_model, download, mkvc
from simpeg import (
    maps,
    data,
    data_misfit,
    regularization,
    optimization,
    inverse_problem,
    inversion,
    directives,
)

# discretize functionality
from discretize import TensorMesh

# Basic Python functionality
import os
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
import tarfile

mpl.rcParams.update({&quot;font.size&quot;: 14})</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EwE1HppYxIjgJ_ZD2_DdP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qugdxzo9kD" class="relative group/block"><h2 id="download-and-extract-the-tutorial-data" class="relative group"><span class="heading-text">Download and Extract the Tutorial Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#download-and-extract-the-tutorial-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>For this tutorial, the frequencies and observed data for 1D sounding are stored within a tar-file. Here, we download and extract the data file.</p></div><div id="cEqpFmu5rN" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># URL to assets
data_source = &quot;https://github.com/simpeg/user-tutorials/raw/main/assets/07-fdem/inv_fdem_1d_files.tar.gz&quot;

# download the data
downloaded_data = download(data_source, overwrite=True)

# unzip the tarfile
tar = tarfile.open(downloaded_data, &quot;r&quot;)
tar.extractall()
tar.close()

# path to the directory containing our data
dir_path = downloaded_data.split(&quot;.&quot;)[0] + os.path.sep

# files to work with
data_filename = dir_path + &quot;em1dfm_data.txt&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JjgJ2O27E67Yg80tuS5a4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Downloading https://github.com/simpeg/user-tutorials/raw/main/assets/07-fdem/inv_fdem_1d_files.tar.gz
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   saved to: /home/ssoler/git/user-tutorials/notebooks/07-fdem/inv_fdem_1d_files.tar.gz
Download completed!
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/tmp/ipykernel_983900/1849335314.py:9: DeprecationWarning: Python 3.14 will, by default, filter extracted tar archives and reject files or modify their metadata. Use the filter argument to control this behavior.
  tar.extractall()
</span></code></pre></div></div></div><div id="fwFfi5WRfg" class="relative group/block"><h2 id="load-and-plot-the-data" class="relative group"><span class="heading-text">Load and Plot the Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-and-plot-the-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here we load and plot the 1D sounding data. In this case, we have the
secondary field response in ppm for a set of frequencies. The columns of the data file are: frequency (Hz), real component (ppm) and imaginary component (ppm).</p></div><div id="ACsrHHquSa" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load data
dobs = np.loadtxt(str(data_filename), skiprows=1)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RS6aYMH7gtGeZG7S1Fd5L" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="V2M85l3pPL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract frequency and observed data columns
frequencies = dobs[:, 0]
dobs = mkvc(dobs[:, 1:].T)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lY8ievKXHxC96SexUfbcE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="WsXtrXT07M" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Plot data
fig, ax = plt.subplots(1, 1, figsize=(5, 5))
ax.loglog(frequencies, np.abs(dobs[0::2]), &quot;k-o&quot;, lw=2)
ax.loglog(frequencies, np.abs(dobs[1::2]), &quot;k:o&quot;, lw=2)
ax.grid(which=&quot;both&quot;)
ax.set_xlabel(&quot;Frequency (Hz)&quot;)
ax.set_ylabel(&quot;|Hs/Hp| (ppm)&quot;)
ax.set_title(&quot;Sounding Data&quot;)
ax.legend([&quot;Real&quot;, &quot;Imaginary&quot;])
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KGx0NzkENm0Ckyrmq0qQ6" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/7f4511de6b36ddfb59a48a5d276cb1c4.png" alt="&lt;Figure size 500x500 with 1 Axes&gt;"/></div></div><div id="jZVazsEIHt" class="relative group/block"><h2 id="defining-the-survey" class="relative group"><span class="heading-text">Defining the Survey</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-the-survey" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we define the survey geometry. For a comprehensive description of constructing FDEM surveys in SimPEG, see the <a class="" href="/user-tutorials/fwd-fdem-1d">1D Forward Simulation of Frequency-Domain EM Data for a Single Sounding</a> tutorial.</p><p>Here, the survey consisted of a vertical magnetic dipole source located 30 m above the surface. The receiver measured the vertical component of the secondary field at a 10 m offset from the source in ppm.</p></div><div id="H8IsuCMAVL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">source_location = np.array([0.0, 0.0, 30.0])
source_orientation = &quot;z&quot;
moment = 1.0

receiver_location = np.array([10.0, 0.0, 30.0])
receiver_orientation = &quot;z&quot;
data_type = &quot;ppm&quot;

# Receiver list
receiver_list = []
receiver_list.append(
    fdem.receivers.PointMagneticFieldSecondary(
        receiver_location,
        orientation=receiver_orientation,
        data_type=data_type,
        component=&quot;real&quot;,
    )
)
receiver_list.append(
    fdem.receivers.PointMagneticFieldSecondary(
        receiver_location,
        orientation=receiver_orientation,
        data_type=data_type,
        component=&quot;imag&quot;,
    )
)

# Define source list
source_list = []
for freq in frequencies:
    source_list.append(
        fdem.sources.MagDipole(
            receiver_list=receiver_list,
            frequency=freq,
            location=source_location,
            orientation=source_orientation,
            moment=moment,
        )
    )

# Survey
survey = fdem.survey.Survey(source_list)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ysgObCaPEYQ5Fg22vv84s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QPPr3tfhzr" class="relative group/block"><h2 id="assign-uncertainties" class="relative group"><span class="heading-text">Assign Uncertainties</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#assign-uncertainties" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Inversion with SimPEG requires that we define the uncertainties on our data; that is, an estimate of the standard deviation of the noise on our data assuming it is uncorrelated Gaussian with zero mean. An online resource explaining uncertainties and their role in the inversion can be found <a target="_blank" rel="noreferrer" href="https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/Uncertainties.html" class="">here</a>.</p><p><strong>For secondary field and ppm data:</strong> In this case, we generally apply a percent uncertainty. Depending on many factors, a percent uncertainty between 5% and 20% may be applied. For systems where multiple field directions are measured for the same source, we may not want to apply a uniform percent uncertainty to all data. Doing so may cause the inversion to overfit weaker signals. In this case, the uncertainty may be a percent of the amplitude of the secondary field. If the data contain very small values, a small floor value should be added to ensure stability of the inversion.</p><p><strong>For total field data:</strong> In this case, the real component contains both the primary and secondary fields, whereas the imaginary component contains only secondary fields. Because the primary field is orders of magnitude larger than the secondary field, applying a simple percent uncertainty to the real component data may result in us underfitting the real component of the EM response. Ideally, we would have defined the survey to perfectly simulate the primary fields, and assign uncertainties based on the secondary fields.</p></div><div id="jXc0gRF814" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># 5% of the absolute value
uncertainties = 0.05 * np.abs(dobs) * np.ones(np.shape(dobs))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ve7gZEb2aa2TpXlqovDid" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="pR9NiSND9B" class="relative group/block"><h2 id="defining-the-data" class="relative group"><span class="heading-text">Defining the Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-the-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>The SimPEG <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.data.Data.html#simpeg.data.data" class="">Data</a> class is required for inversion and connects the observed data, uncertainties and survey geometry.</p></div><div id="lsyx0fScQD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">data_object = data.Data(survey, dobs=dobs, noise_floor=uncertainties)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KIeWVwvba1hoeZH5n9xbE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="YcaTnkdNGq" class="relative group/block"><h2 id="weighted-least-squares-inversion" class="relative group"><span class="heading-text">Weighted Least-Squares Inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#weighted-least-squares-inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we use the weighted least-squares inversion approach to recover the log-conductivities on a 1D layered Earth. We impose no a-priori information about the number of layers (geological units) or their thicknesses. Instead, we define a large number of layers with exponentially increasing thicknesses. And the depth, thickness and electrical properties of the Earth are inferred from the recovered model.</p></div><div id="K16NAhB9CG" class="relative group/block"><h3 id="defining-a-1d-layered-earth" class="relative group"><span class="heading-text">Defining a 1D Layered Earth</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-a-1d-layered-earth" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Let us assume we have a reasonable estimate of the regional conductivity within our area of interest. For the highest frequency and the estimated conductivity, we compute the minimum skin depth:</p><div id="djioRdq33d" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>≈</mo><mn>500</mn><msqrt><mfrac><mn>1</mn><mrow><mi>σ</mi><mtext> </mtext><msub><mi>f</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">d_{min} \approx 500 \sqrt{\dfrac{1}{\sigma \, f_{max}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.44em;vertical-align:-0.8856em;"></span><span class="mord">500</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5544em;"><span class="svg-align" style="top:-4.4em;"><span class="pstrut" style="height:4.4em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.5144em;"><span class="pstrut" style="height:4.4em;"></span><span class="hide-tail" style="min-width:1.02em;height:2.48em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'><path d='M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8856em;"><span></span></span></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#djioRdq33d" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>The minimum layer thickness is some fraction of the minimum skin depth. Next, we use the minimum frequency and the estimated conductivity to compute the maximum skin depth:</p><div id="DrrEhrYpyu" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>d</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>≈</mo><mn>500</mn><msqrt><mfrac><mn>1</mn><mrow><mi>σ</mi><mtext> </mtext><msub><mi>f</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">d_{max} \approx 500 \sqrt{\dfrac{1}{\sigma \, f_{min}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.44em;vertical-align:-0.8856em;"></span><span class="mord">500</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5544em;"><span class="svg-align" style="top:-4.4em;"><span class="pstrut" style="height:4.4em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.5144em;"><span class="pstrut" style="height:4.4em;"></span><span class="hide-tail" style="min-width:1.02em;height:2.48em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'><path d='M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8856em;"><span></span></span></span></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#DrrEhrYpyu" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>Starting from our minimum layer thickness, we continue to add layers with exponentially increasing thicknesses. We do so until the layers extend to some multiple of the maximum skin depth.</p></div><div id="gKb2CvWV5o" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># estimated host conductivity (S/m)
estimated_conductivity = 0.1

# minimum skin depth
d_min = 500.0 / np.sqrt(estimated_conductivity * frequencies.max())
print(&quot;MINIMUM SKIN DEPTH: {} m&quot;.format(d_min))

# maximum skin depth
d_max = 500.0 / np.sqrt(estimated_conductivity * frequencies.min())
print(&quot;MAXIMUM SKIN DEPTH: {} m&quot;.format(d_max))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HP0rCx3qZGbcvYA6oyKOL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>MINIMUM SKIN DEPTH: 4.383604418942005 m
MAXIMUM SKIN DEPTH: 80.89810021132169 m
</span></code></pre></div></div></div><div id="w1wE9v6F5A" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">depth_min = 0.5  # top layer thickness
depth_max = 200.0  # depth to lowest layer
geometric_factor = 1.1  # rate of thickness increase</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MHp9yYvot01Rz4IiEPakb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qIrtHmnNCO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Increase subsequent layer thicknesses by the geometric factors until
# it reaches the maximum layer depth.
layer_thicknesses = [depth_min]
while np.sum(layer_thicknesses) &lt; depth_max:
    layer_thicknesses.append(geometric_factor * layer_thicknesses[-1])

n_layers = len(layer_thicknesses) + 1  # Number of layers</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mvrro8AiYlig5SiSPHFlV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EZG0gvoxKm" class="relative group/block"><h3 id="model-and-mapping-to-layer-conductivities" class="relative group"><span class="heading-text">Model and Mapping to Layer Conductivities</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#model-and-mapping-to-layer-conductivities" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Recall from the <a class="" href="/user-tutorials/fwd-fdem-1d">1D Forward Simulation of Frequency-Domain EM Data for a Single Sounding</a> tutorial that the ‘model’ is not necessarily synonymous with physical property values. And that we need to define a mapping from the model to the set of input parameters required by the forward simulation. When inverting to recover electrical conductivities (or resistivities), it is best to use the log-value, as electrical conductivities of rocks span many order of magnitude.</p><p>Here, the model defines the log-conductivity values for a defined set of subsurface layers. And we use the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.ExpMap.html#simpeg.maps.expmap" class="">simpeg.maps.ExpMap</a> to map from the model parameters to the conductivity values required by the forward simulation.</p></div><div id="nSzGROikpw" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">log_conductivity_map = maps.ExpMap(nP=n_layers)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7nb4IHEdGWqx5GcOpV1SV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LqTNFDxIsx" class="relative group/block"><h3 id="starting-reference-models" class="relative group"><span class="heading-text">Starting/Reference Models</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#starting-reference-models" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The <strong>starting model</strong> defines a reasonable starting point for the inversion. Because electromagnetic problems are non-linear, your choice in starting model does have an impact on the recovered model. For DC resistivity inversion, we generally choose our starting model based on apparent resistivities. For the tutorial example, the apparent resistivities were near 1000 <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">\Omega m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Ω</span><span class="mord mathnormal">m</span></span></span></span></span>. It should be noted that the starting model <strong>cannot be vector of zeros,</strong> otherwise the inversion will be unable to compute a gradient direction at the first iteration.</p><p>The <strong>reference model</strong> is used to include a-priori information. The impact of the reference model on the inversion will be discussed in another tutorial. The reference model for basic inversion approaches is either zero or equal to the starting model.</p><p>Notice that the length of the starting and reference models is equal to the number of model parameters!!!</p></div><div id="BkYpJByBT9" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Starting model is log-conductivity values (S/m)
starting_conductivity_model = np.log(1e-1 * np.ones(n_layers))

# Reference model is also log-resistivity values (S/m)
reference_conductivity_model = starting_conductivity_model.copy()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vNSAm3-wI-3is-9DYAG06" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="b8RYBtxC2h" class="relative group/block"><h3 id="define-the-forward-simulation" class="relative group"><span class="heading-text">Define the Forward Simulation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-the-forward-simulation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>A simulation object defining the forward problem is required in order to predict data and calculate misfits for recovered models. A comprehensive description of the simulation object for 1D DC resistivity was discussed in the <a class="" href="/user-tutorials/fwd-fdem-1d">1D Forward Simulation of Frequency-Domain EM Data for a Single Sounding</a> tutorial. Here, we use the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.Simulation1DLayered.html#simpeg.electromagnetics.frequency_domain.simulation1dlayered" class="">Simulation1DLayered</a> which simulates the data according to a 1D Hankel transform solution.</p><p>The layer thicknesses are a static property of the simulation, and we set them using the <code>thicknessess</code> keyword argument. Since our model consists of log-conductivities, we use <code>sigmaMap</code> to set the mapping from the model to the layer conductivities.</p></div><div id="lvFFKPQc87" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">simulation_L2 = fdem.Simulation1DLayered(
    survey=survey, thicknesses=layer_thicknesses, sigmaMap=log_conductivity_map
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="XhhGwy6a-xJ7oMiu8z5u4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Xfncp0B0CK" class="relative group/block"><h3 id="data-misfit" class="relative group"><span class="heading-text">Data Misfit</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-misfit" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>To understand the role of the data misfit in the inversion, please visit <a target="_blank" rel="noreferrer" href="https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/Uncertainties.html" class="">this online resource</a>.
Here, we use the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.data_misfit.L2DataMisfit.html#simpeg.data_misfit.l2datamisfit" class="">L2DataMisfit</a> class to define the data misfit. In this case, the data misfit is the L2 norm of the weighted residual between the observed data and the data predicted for a given model. When instantiating the data misfit object within SimPEG, we must assign an appropriate <em>data object</em> and <em>simulation object</em> as properties.</p></div><div id="wEfRBm5il3" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">dmis_L2 = data_misfit.L2DataMisfit(simulation=simulation_L2, data=data_object)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Hr8_Y6kROJ_4y-D5B8Pk1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="n3Yl9J5CMo" class="relative group/block"><h3 id="regularization" class="relative group"><span class="heading-text">Regularization</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#regularization" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>To understand the role of the regularization in the inversion, please visit <a target="_blank" rel="noreferrer" href="https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/ObjectiveFunction.html" class="">this online resource</a>.</p><p>To define the regularization within SimPEG, we must define a 1D <a target="_blank" rel="noreferrer" href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.tensormesh" class="">tensor mesh</a>. Meshes are designed using the <a target="_blank" rel="noreferrer" href="https://discretize.simpeg.xyz" class="">discretize package</a>. Whereas layer <em>thicknesses</em> and our <em>model</em> are defined from our top-layer down, tensor meshes are defined from the bottom up. So to define a 1D tensor mesh for the regularization, we:</p><ul><li><p>add an extra layer to the end of our thicknesses so that the number of cells in the 1D mesh equals the number of model parameters</p></li><li><p>reverse the order so that the model parameters in the regularization match up with the appropriate cell</p></li><li><p>define the tensor mesh from the cell widths</p></li></ul></div><div id="rmuimHP9Qv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Define 1D cell widths
h = np.r_[layer_thicknesses, layer_thicknesses[-1]]
h = np.flipud(h)

# Create regularization mesh
regularization_mesh = TensorMesh([h], &quot;N&quot;)
print(regularization_mesh)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dssqmFgT3H8U8vVZtv1wd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
  TensorMesh: 40 cells

                      MESH EXTENT             CELL WIDTH      FACTOR
  dir    nC        min           max         min       max      max
  ---   ---  ---------------------------  ------------------  ------
   x     40       -219.43         -0.00      0.50     18.70    1.10


</span></code></pre></div></div></div><div id="mijaTOvgQn" class="relative group/block"><p>By default, the regularization acts on the model parameters. In this case, the model parameters are the log-resistivities, not the electric resistivities!!! Here, we use the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.regularization.WeightedLeastSquares.html#simpeg.regularization.weightedleastsquares" class="">WeightedLeastSquares</a> regularization class to constrain the inversion result. Here, length scale along x are used to balance the smallness and smoothness terms; yes, x is smoothness along the vertical direction. And the reference model is only applied to the smallness term. If we wanted to apply the regularization to a function of the model parameters, we would need to set an approprate mapping object using the <code>mapping</code> keyword argument.</p></div><div id="gFDmJaN8zU" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">reg_L2 = regularization.WeightedLeastSquares(
    regularization_mesh,
    length_scale_x=10.0,
    reference_model=reference_conductivity_model,
    reference_model_in_smooth=False,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8-xu5op3r8otqrDN6hm_b" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="SLO6Aiy1mk" class="relative group/block"><h3 id="optimization" class="relative group"><span class="heading-text">Optimization</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#optimization" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Here, we use the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.optimization.InexactGaussNewton.html#simpeg.optimization.inexactgaussnewton" class="">InexactGaussNewton</a> class to solve the optimization problem using the inexact Gauss Newton with conjugate gradient solver. Reasonable default values have generally been set for the properties of each optimization class. However, the user may choose to set custom values; e.g. the accuracy tolerance for the conjugate gradient solver or the number of line searches.</p></div><div id="gebW0eFmIQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">opt_L2 = optimization.InexactGaussNewton(
    maxIter=100, maxIterLS=20, maxIterCG=20, tolCG=1e-3
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="RdV5BtA1uRAOeBW5BOmEh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hzKlG3p3cY" class="relative group/block"><h3 id="inverse-problem" class="relative group"><span class="heading-text">Inverse Problem</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inverse-problem" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We use the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.inverse_problem.BaseInvProblem.html#simpeg.inverse_problem.baseinvproblem" class="">BaseInvProblem</a> class to fully define the inverse problem that is solved at each beta (trade-off parameter) iteration. The inverse problem requires appropriate <em>data misfit</em>, <em>regularization</em> and <em>optimization</em> objects.</p></div><div id="NTEVASqO4D" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">inv_prob_L2 = inverse_problem.BaseInvProblem(dmis_L2, reg_L2, opt_L2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="K1d1W8w__Tq0qtyf8QsKS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ZCgTjVOgS0" class="relative group/block"><h3 id="inversion-directives" class="relative group"><span class="heading-text">Inversion Directives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inversion-directives" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>To understand the role of directives in the inversion, please visit this online resource. Here, we apply common directives for weighted least-squares inversion of gravity data and describe their roles. These are:</p><ul><li><p><a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdatePreconditioner.html#simpeg.directives.updatepreconditioner" class="">UpdatePreconditioner</a>: Apply Jacobi preconditioner when solving optimization problem to reduce the number of conjugate gradient iterations. We set <code>update_every_iteration=True</code> because the ideal preconditioner is model-dependent.</p></li><li><p><a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.BetaEstimate_ByEig.html#simpeg.directives.betaestimate_byeig" class="">BetaEstimate_ByEig</a>: Compute and set starting trade-off parameter (beta) based on largest eigenvalues.</p></li><li><p><a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.BetaSchedule.html#simpeg.directives.betaschedule" class="">BetaSchedule</a>: Size reduction of the trade-off parameter at every beta iteration, and the number of Gauss-Newton iterations for each beta. In general, a <code>coolingFactor</code> between 1.5 and 2.5, and <code>coolingRate</code> of 3 works well for FDEM inversion. Cooling beta too quickly will result in portions of the model getting trapped in local minima. And we will not be finding the solution that minimizes the optimization problem if the cooling rate is too small.</p></li><li><p><a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.TargetMisfit.html#simpeg.directives.targetmisfit" class="">TargetMisfit</a>: Terminates the inversion when the data misfit equals the target misfit. A <code>chifact=1</code> terminates the inversion when the data misfit equals the number of data.</p></li></ul><p>The directive objects are organized in a <code>list</code>. Upon starting the inversion or updating the recovered model at each iteration, the inversion will call each directive within the list <strong>in order</strong>. The order of the directives matters, and SimPEG will throw an error if directives are organized into an improper order. Some directives, like the <code>BetaEstimate_ByEig</code> are only used when starting the inversion. Other directives, like <code>UpdatePreconditionner</code>, are used whenever the model is updated.</p></div><div id="erkTPATtVh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">update_jacobi = directives.UpdatePreconditioner(update_every_iteration=True)
starting_beta = directives.BetaEstimate_ByEig(beta0_ratio=5)
beta_schedule = directives.BetaSchedule(coolingFactor=2.0, coolingRate=3)
target_misfit = directives.TargetMisfit(chifact=1.0)

directives_list_L2 = [update_jacobi, starting_beta, beta_schedule, target_misfit]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VE0H6xNw3whGYDUlLgzdp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="a9eGuHSkax" class="relative group/block"><h3 id="define-and-run-the-inversion" class="relative group"><span class="heading-text">Define and Run the Inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-and-run-the-inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We define the inversion using the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.inversion.BaseInversion.html#simpeg.inversion.baseinversion" class="">BaseInversion</a> class. The inversion class must be instantiated with an appropriate <em>inverse problem</em> object and <em>directives list</em>. The <code>run</code> method, along with a starting model, is respondible for running the inversion. The output is a 1D numpy.ndarray containing the recovered model parameters</p></div><div id="Hd0Kz2kPJU" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Here we combine the inverse problem and the set of directives
inv_L2 = inversion.BaseInversion(inv_prob_L2, directives_list_L2)

# Run the inversion
recovered_model_L2 = inv_L2.run(starting_conductivity_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6TsndKUDjBy2VRJ-Lrrku" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
Running inversion with SimPEG v0.24.0

                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                    ***Done using the default solver Pardiso and no solver_opts.***
                    
model has any nan: 0
============================ Inexact Gauss Newton ============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   
-----------------------------------------------------------------------------
x0 has any nan: 0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   0  1.23e+00  2.86e+02  0.00e+00  2.86e+02    5.81e+01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   1  1.23e+00  1.03e+02  4.36e+01  1.57e+02    2.14e+01      0              
   2  1.23e+00  6.81e+01  5.98e+01  1.41e+02    9.04e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   3  6.14e-01  5.82e+01  6.56e+01  9.84e+01    2.21e+01      0   Skip BFGS  
   4  6.14e-01  2.49e+01  9.96e+01  8.60e+01    4.76e+00      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   5  6.14e-01  2.21e+01  1.02e+02  8.49e+01    2.30e+00      0   Skip BFGS  
   6  3.07e-01  2.13e+01  1.03e+02  5.30e+01    1.30e+01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   7  3.07e-01  1.10e+01  1.25e+02  4.95e+01    1.34e+00      0              
   8  3.07e-01  1.06e+01  1.26e+02  4.93e+01    5.09e-01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   9  1.53e-01  1.06e+01  1.26e+02  2.99e+01    6.96e+00      0   Skip BFGS  
------------------------- STOP! -------------------------
1 : |fc-fOld| = 0.0000e+00 &lt;= tolF*(1+|f0|) = 2.8679e+01
1 : |xc-x_last| = 4.6904e-01 &lt;= tolX*(1+|x0|) = 1.5563e+00
0 : |proj(x-g)-x|    = 6.9584e+00 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 6.9584e+00 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =     100    &lt;= iter          =     10
------------------------- DONE! -------------------------
</span></code></pre></div></div></div><div id="yIewXteqks" class="relative group/block"><h2 id="inversion-outputs" class="relative group"><span class="heading-text">Inversion Outputs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inversion-outputs" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="f3REsKVawf" class="relative group/block"><h3 id="data-misfit-1" class="relative group"><span class="heading-text">Data Misfit</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-misfit-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="NQ7AbILEHj" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">dpred_L2 = simulation_L2.dpred(recovered_model_L2)

fig = plt.figure(figsize=(10, 5))
ax = [fig.add_axes([0.1 + ii * 0.5, 0.1, 0.37, 0.85]) for ii in range(2)]
for ii in range(2):
    ax[ii].loglog(frequencies, np.abs(dobs[ii::2]), &quot;k-o&quot;, lw=2)
    ax[ii].loglog(frequencies, np.abs(dpred_L2[ii::2]), &quot;b-o&quot;, lw=2)
    ax[ii].grid(which=&quot;both&quot;)
    ax[ii].set_xlabel(&quot;Frequency (Hz)&quot;)
    ax[ii].set_ylabel(&quot;|Hs/Hp| (ppm)&quot;)
    ax[ii].legend([&quot;Observed&quot;, &quot;L2 Inversion&quot;])
    if ii == 1:
        ax[ii].set_ylabel(&quot;&quot;)

ax[0].set_title(&quot;Real Component&quot;)
ax[1].set_title(&quot;Imaginary Component&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="nN7zjY9R_s7sJeqNJWc1w" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/655632233294c1641dcc2adf4fd42a71.png" alt="&lt;Figure size 1000x500 with 2 Axes&gt;"/></div></div><div id="fLkAsKjbo1" class="relative group/block"><h3 id="recovered-model" class="relative group"><span class="heading-text">Recovered Model</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#recovered-model" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="lsyWxXsZdv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># true conductivities and layer thicknesses
true_conductivities = np.array([0.1, 1.0, 0.1])
true_layers = np.r_[20.0, 40.0, 160.0]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="M4CO2Z8mDh4Nr9DgA3HRn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="NQv2JtNurw" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Plot true model and recovered model
fig = plt.figure(figsize=(6, 6))

ax1 = fig.add_axes([0.2, 0.15, 0.7, 0.7])
plot_1d_layer_model(true_layers, true_conductivities, ax=ax1, color=&quot;k&quot;)
plot_1d_layer_model(
    layer_thicknesses, log_conductivity_map * recovered_model_L2, ax=ax1, color=&quot;b&quot;
)
ax1.grid()
ax1.set_xlabel(r&quot;Resistivity ($\Omega m$)&quot;)
x_min, x_max = true_conductivities.min(), true_conductivities.max()
ax1.set_xlim(0.9 * x_min, 1.5 * x_max)
ax1.legend([&quot;True Model&quot;, &quot;L2-Model&quot;])
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="LbDI3lYpLyIK8KEI7W3KV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/9d3fe4941ff9281b5d397c44c274e034.png" alt="&lt;Figure size 600x600 with 1 Axes&gt;"/></div></div><div id="i279xVGjXw" class="relative group/block"><h2 id="iteratively-re-weighted-least-squares-inversion" class="relative group"><span class="heading-text">Iteratively Re-weighted Least-Squares Inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#iteratively-re-weighted-least-squares-inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we use the iteratively reweighted least-squares (IRLS) inversion approach to recover sparse and/or blocky models on the set layers.</p></div><div id="A93kckD8u3" class="relative group/block"><h3 id="define-the-forward-simulation-1" class="relative group"><span class="heading-text">Define the Forward Simulation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-the-forward-simulation-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="SteeRmLuLf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">simulation_irls = fdem.simulation_1d.Simulation1DLayered(
    survey=survey,
    sigmaMap=log_conductivity_map,
    thicknesses=layer_thicknesses,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="W5TRRykyV34nF4dMhY7cx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="n0lwqqcILF" class="relative group/block"><h3 id="define-the-data-misfit" class="relative group"><span class="heading-text">Define the Data Misfit</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-the-data-misfit" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="PQKbrl8WYe" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">dmis_irls = data_misfit.L2DataMisfit(simulation=simulation_irls, data=data_object)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Uo8csNtwkekwBCE-su2x7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Jz9qwviqQa" class="relative group/block"><h3 id="regularization-1" class="relative group"><span class="heading-text">Regularization</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#regularization-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Here, we use the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.regularization.Sparse.html#simpeg.regularization.sparse" class="">Sparse</a> regularization class to constrain the inversion result using an IRLS approach. Here, the scaling constants that balance the smallness and smoothness terms are set directly. Equal emphasis on smallness and smoothness is generally applied by using the inverse square of the smallest cell dimension. The reference model is only applied to the smallness term; which is redundant for the tutorial example since we have set the reference model to an array of zeros. Here, we apply a 1-norm to the smallness term and a 1-norm to first-order smoothness along the x (vertical direction).</p></div><div id="f8xomTEe7n" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">reg_irls = regularization.Sparse(
    regularization_mesh,
    alpha_s=0.01,
    alpha_x=1,
    reference_model_in_smooth=False,
    norms=[1.0, 1.0],
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-EUm5r5Box5EuL8PCNA5D" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ipPhSvtZwu" class="relative group/block"><h3 id="optimization-1" class="relative group"><span class="heading-text">Optimization</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#optimization-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="m2hSKPIm95" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">opt_irls = optimization.InexactGaussNewton(
    maxIter=100, maxIterLS=20, maxIterCG=30, tolCG=1e-3
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bzi3Pw8z9kb9l3bTooUL5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BWrOA22SQk" class="relative group/block"><h3 id="inverse-problem-1" class="relative group"><span class="heading-text">Inverse Problem</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inverse-problem-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="JwZEHRO01I" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">inv_prob_irls = inverse_problem.BaseInvProblem(dmis_irls, reg_irls, opt_irls)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lRX87WO1MIRNlPCEd9aAe" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="jSpZxkz5TN" class="relative group/block"><h3 id="directives" class="relative group"><span class="heading-text">Directives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#directives" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Here, we create common directives for IRLS inversion of total magnetic intensity data and describe their roles. In additon to the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdateSensitivityWeights.html#simpeg.directives.updatesensitivityweights" class="">UpdateSensitivityWeights</a>, <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdatePreconditioner.html#simpeg.directives.updatepreconditioner" class="">UpdatePreconditioner</a> and <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.BetaEstimate_ByEig.html#simpeg.directives.betaestimate_byeig" class="">BetaEstimate_ByEig</a>  (described before), inversion with sparse-norms requires the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdateIRLS.html#simpeg.directives.updateirls" class=""><code>UpdateIRLS</code></a> directive.</p><p>You will notice that we don’t use the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.BetaSchedule.html#simpeg.directives.betaschedule" class="">BetaSchedule</a> and <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.TargetMisfit.html#simpeg.directives.targetmisfit" class="">TargetMisfit</a> directives. Here, the beta cooling schedule is set in the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdateIRLS.html#simpeg.directives.updateirls" class=""><code>UpdateIRLS</code></a> directive using the <code>coolingFactor</code> and <code>coolingRate</code> properties. The target misfit for the L2 portion of the IRLS approach is set with the <code>chifact_start</code> property.</p></div><div id="ybi95RyXmF" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">starting_beta_irls = directives.BetaEstimate_ByEig(beta0_ratio=5)
update_jacobi_irls = directives.UpdatePreconditioner(update_every_iteration=True)
update_irls = directives.UpdateIRLS(
    cooling_factor=2,
    cooling_rate=3,
    f_min_change=1e-4,
    max_irls_iterations=30,
    chifact_start=1.0,
)

directives_list_irls = [update_irls, starting_beta_irls, update_jacobi_irls]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TXZSBckPuZCGxADS9miJ3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="iUEnvSpdse" class="relative group/block"><h3 id="define-and-run-the-inversion-1" class="relative group"><span class="heading-text">Define and Run the Inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-and-run-the-inversion-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="vaOKyc0GzJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Here we combine the inverse problem and the set of directives
inv_irls = inversion.BaseInversion(inv_prob_irls, directives_list_irls)

# Run the inversion
recovered_model_irls = inv_irls.run(starting_conductivity_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-dIzbND9HbvtkxUGSdpVy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
Running inversion with SimPEG v0.24.0
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.

                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                    ***Done using the default solver Pardiso and no solver_opts.***
                    
model has any nan: 0
============================ Inexact Gauss Newton ============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   
-----------------------------------------------------------------------------
x0 has any nan: 0
   0  3.27e+01  2.86e+02  0.00e+00  2.86e+02    5.81e+01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   1  3.27e+01  3.07e+01  1.62e+00  8.36e+01    2.22e+01      0              
   2  3.27e+01  1.81e+01  1.40e+00  6.38e+01    5.61e+00      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   3  1.63e+01  1.48e+01  1.47e+00  3.89e+01    9.32e+00      0   Skip BFGS  
Reached starting chifact with l2-norm regularization: Start IRLS steps...
irls_threshold 2.5064368466543883
   4  1.63e+01  8.25e+00  1.93e+00  3.98e+01    1.64e+00      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   5  1.63e+01  8.72e+00  1.87e+00  3.93e+01    6.67e-01      0              
   6  2.04e+01  8.52e+00  1.88e+00  4.69e+01    2.49e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   7  2.04e+01  9.94e+00  1.87e+00  4.81e+01    6.15e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   8  2.04e+01  1.03e+01  1.85e+00  4.80e+01    1.90e-01      0              
   9  2.55e+01  1.02e+01  1.85e+00  5.74e+01    3.22e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  10  2.55e+01  1.23e+01  1.80e+00  5.82e+01    6.03e-01      0              
  11  2.55e+01  1.27e+01  1.79e+00  5.82e+01    1.22e-01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  12  1.56e+01  1.26e+01  1.79e+00  4.06e+01    6.30e+00      0   Skip BFGS  
  13  1.56e+01  8.70e+00  2.03e+00  4.05e+01    7.25e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  14  1.56e+01  8.81e+00  2.02e+00  4.04e+01    2.45e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  15  1.92e+01  8.76e+00  2.03e+00  4.77e+01    2.43e+00      0   Skip BFGS  
  16  1.92e+01  1.01e+01  2.01e+00  4.86e+01    6.82e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  17  1.92e+01  1.04e+01  1.99e+00  4.86e+01    1.73e-01      0              
  18  2.36e+01  1.04e+01  1.99e+00  5.74e+01    3.04e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  19  2.36e+01  1.22e+01  1.95e+00  5.82e+01    7.76e-01      0              
  20  2.36e+01  1.26e+01  1.93e+00  5.82e+01    1.61e-01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  21  1.45e+01  1.26e+01  1.93e+00  4.06e+01    6.34e+00      0   Skip BFGS  
  22  1.45e+01  8.85e+00  2.17e+00  4.03e+01    7.82e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  23  1.45e+01  8.92e+00  2.16e+00  4.03e+01    1.93e-01      0              
  24  1.77e+01  8.89e+00  2.16e+00  4.72e+01    2.33e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  25  1.77e+01  1.01e+01  2.14e+00  4.80e+01    7.84e-01      0              
  26  1.77e+01  1.04e+01  2.12e+00  4.79e+01    1.69e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  27  2.16e+01  1.04e+01  2.12e+00  5.62e+01    2.87e+00      0   Skip BFGS  
  28  2.16e+01  1.20e+01  2.08e+00  5.69e+01    8.86e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  29  2.16e+01  1.24e+01  2.06e+00  5.68e+01    1.61e-01      0              
  30  1.34e+01  1.23e+01  2.06e+00  3.99e+01    6.14e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  31  1.34e+01  8.99e+00  2.28e+00  3.94e+01    7.83e-01      0              
  32  1.34e+01  9.00e+00  2.27e+00  3.94e+01    1.23e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  33  1.62e+01  8.98e+00  2.28e+00  4.59e+01    2.22e+00      0   Skip BFGS  
  34  1.62e+01  1.00e+01  2.25e+00  4.65e+01    7.95e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  35  1.62e+01  1.03e+01  2.23e+00  4.64e+01    1.26e-01      0              
  36  1.97e+01  1.03e+01  2.23e+00  5.42e+01    2.70e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  37  1.97e+01  1.17e+01  2.18e+00  5.47e+01    9.16e-01      0              
  38  1.97e+01  1.20e+01  2.17e+00  5.47e+01    1.28e-01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  39  1.23e+01  1.20e+01  2.17e+00  3.87e+01    5.80e+00      0   Skip BFGS  
  40  1.23e+01  9.06e+00  2.37e+00  3.82e+01    7.66e-01      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  41  1.23e+01  9.01e+00  2.37e+00  3.82e+01    7.88e-02      0              
------------------------- STOP! -------------------------
1 : |fc-fOld| = 2.0111e-02 &lt;= tolF*(1+|f0|) = 2.8679e+01
1 : |xc-x_last| = 7.9559e-02 &lt;= tolX*(1+|x0|) = 1.5563e+00
1 : |proj(x-g)-x|    = 7.8837e-02 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 7.8837e-02 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =     100    &lt;= iter          =     41
------------------------- DONE! -------------------------
</span></code></pre></div></div></div><div id="wmFQeXWXZc" class="relative group/block"><h3 id="data-misfit-and-recovered-model" class="relative group"><span class="heading-text">Data Misfit and Recovered Model</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-misfit-and-recovered-model" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="NEb8D5xaMQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">dpred_irls = simulation_irls.dpred(recovered_model_irls)

fig = plt.figure(figsize=(10, 5))
ax = [fig.add_axes([0.1 + ii * 0.5, 0.1, 0.37, 0.85]) for ii in range(2)]
for ii in range(2):
    ax[ii].loglog(frequencies, np.abs(dobs[ii::2]), &quot;k-o&quot;, lw=2)
    ax[ii].loglog(frequencies, np.abs(dpred_L2[ii::2]), &quot;b-o&quot;, lw=2)
    ax[ii].loglog(frequencies, np.abs(dpred_irls[ii::2]), &quot;r-o&quot;, lw=2)
    ax[ii].grid(which=&quot;both&quot;)
    ax[ii].set_xlabel(&quot;Frequency (Hz)&quot;)
    ax[ii].set_ylabel(&quot;|Hs/Hp| (ppm)&quot;)
    ax[ii].legend([&quot;True Sounding&quot;, &quot;Predicted (L2-model)&quot;, &quot;Predicted (IRLS)&quot;])
    if ii == 1:
        ax[ii].set_ylabel(&quot;&quot;)

ax[0].set_title(&quot;Real Component&quot;)
ax[1].set_title(&quot;Imaginary Component&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vYe_2BQ-QHwLhhypT_DgM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/9d5b753d7a3da90ebc0dbed34119b857.png" alt="&lt;Figure size 1000x500 with 2 Axes&gt;"/></div></div><div id="ZDURFZjiFD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Plot true model and recovered model
fig = plt.figure(figsize=(6, 6))

ax1 = fig.add_axes([0.2, 0.15, 0.7, 0.7])
plot_1d_layer_model(true_layers, true_conductivities, ax=ax1, color=&quot;k&quot;)
plot_1d_layer_model(
    layer_thicknesses, log_conductivity_map * recovered_model_L2, ax=ax1, color=&quot;b&quot;
)
plot_1d_layer_model(
    layer_thicknesses, log_conductivity_map * recovered_model_irls, ax=ax1, color=&quot;r&quot;
)
ax1.grid()
ax1.set_xlabel(r&quot;Conductivity ($S/m$)&quot;)
x_min, x_max = true_conductivities.min(), true_conductivities.max()
ax1.set_xlim(0.8 * x_min, 2 * x_max)
ax1.legend([&quot;True Model&quot;, &quot;L2 Model&quot;, &quot;IRLS Model&quot;])
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bNcPLaxQ1MznqdUrEmemG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/88f5dac6671bcb95fe22d58aed7c2e13.png" alt="&lt;Figure size 600x600 with 1 Axes&gt;"/></div></div><div id="gIvdSCklTy" class="relative group/block"><h2 id="parametric-inversion" class="relative group"><span class="heading-text">Parametric Inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#parametric-inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we assume the subsurface is defined by a 3-layered Earth. However, the electrical properties and thicknesses of the layers are unknown. Here, we define our model to include log-conductivities and log-thicknesses. When including quantities that span different scales, it is frequently best to define the model in terms of log values so that each quantity influences the predicted data evenly.</p></div><div id="fEUwHaDZQQ" class="relative group/block"><h3 id="model-and-mapping" class="relative group"><span class="heading-text">Model and Mapping</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#model-and-mapping" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>For a 3-layered Earth model, the model consists of 2 log-thicknesses and 3 log-conductivities. Similar to the <a class="" href="/user-tutorials/fwd-fdem-1d">1D Forward Simulation of Frequency Domain EM Data for a Single Sounding</a> tutorial, need a mapping that extract log-thicknesses and log-resistivities from the model, and mappings that convert log-values to property values. For this, we require the <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.Wires.html#simpeg.maps.wires" class="">simpeg.maps.Wires</a> mapping and <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.ExpMap.html#simpeg.maps.expmap" class="">simpeg.maps.ExpMap</a> mapping classes. Note that successive mappings can be chained together using the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord">∗</span></span></span></span></span> operator.</p></div><div id="jaP7Xm8LVE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Wire maps to extract log-thicknesses and log-conductivities
wire_map = maps.Wires((&quot;log_thicknesses&quot;, 2), (&quot;log_resistivity&quot;, 3))

# Maping for layer thicknesses
log_thicknesses_map = maps.ExpMap() * wire_map.log_thicknesses

# Mapping for conductivities
log_resistivity_map = maps.ExpMap() * wire_map.log_resistivity</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="i8Z45EEgtDGxQDCRSjyF_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="pahPWrJ1Bo" class="relative group/block"><h3 id="starting-and-reference-model" class="relative group"><span class="heading-text">Starting and Reference Model</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#starting-and-reference-model" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>This problem is highly non-linear so it is important to have a reasonable estimate of the true model.</p></div><div id="mCENa7HlnM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">starting_parametric_model = np.log(np.r_[30.0, 20.0, 20, 0.5, 5])

reference_parametric_model = starting_parametric_model.copy()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Z2aaBWVt69rMyNN9VNPEu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="MwiQytGRPE" class="relative group/block"><h3 id="forward-simulation" class="relative group"><span class="heading-text">Forward Simulation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#forward-simulation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Because the layer thicknesses are part of the model, we define the <code>thicknessesMap</code>. Because we are working in terms of electrical resistivity, we must define the <code>rhoMap</code>.</p></div><div id="F70w7gzGYj" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">simulation_parametric = fdem.simulation_1d.Simulation1DLayered(
    survey=survey,
    rhoMap=log_resistivity_map,
    thicknessesMap=log_thicknesses_map,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="49anflqo-PXf3NKVZ8Bbq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="PKxebOlH9X" class="relative group/block"><h3 id="data-misfit-2" class="relative group"><span class="heading-text">Data Misfit</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-misfit-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="b8oKUCXION" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">dmis_parametric = data_misfit.L2DataMisfit(
    simulation=simulation_parametric, data=data_object
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5wrM--WAWREk9NaZ16Wsc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OH9eadATrg" class="relative group/block"><h3 id="id-combo-regularization" class="relative group"><span class="heading-text">(Combo) Regularization</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-combo-regularization" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We need to define a regularization for each model parameter type. In this case, we have log-thicknesses and log-conductivities. For each model parameter type, we create a 1D <a target="_blank" rel="noreferrer" href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.tensormesh" class="">tensor mesh</a> with length equal to the number of parameters. In the <code>mapping</code> keyword argument, we used the wire map that extracts the specific model parameters from the model.</p><p>Using the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord">∗</span></span></span></span></span> operator, separate regularizations can be summed to form a regularization that is also a <a target="_blank" rel="noreferrer" href="https://docs.simpeg.xyz/latest/content/api/generated/simpeg.objective_function.ComboObjectiveFunction.html#simpeg.objective_function.comboobjectivefunction" class="">ComboObjectiveFunction</a>. By setting the <code>multipliers</code> property, we can emphasize the relative contributions of the log-thicknesses and log-conductivities regularizations.</p></div><div id="q0qqc0bvfp" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">reg_1 = regularization.Smallness(
    TensorMesh([(np.ones(2))], &quot;0&quot;),
    mapping=wire_map.log_thicknesses,
    reference_model=reference_parametric_model,
)

reg_2 = regularization.Smallness(
    TensorMesh([(np.ones(3))], &quot;0&quot;),
    mapping=wire_map.log_resistivity,
    reference_model=reference_parametric_model,
)

reg_parametric = reg_1 + reg_2
reg_parametric.multipliers = [1.0, 0.1]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9IHgxeeQsCQmXxjfeXs2b" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="mj6XQclz97" class="relative group/block"><h3 id="optimization-2" class="relative group"><span class="heading-text">Optimization</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#optimization-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="z2q6SkQ0HA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">opt_parametric = optimization.InexactGaussNewton(
    maxIter=100, maxIterLS=20, maxIterCG=20, tolCG=1e-3
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mxgXpzwTavfEVYN4uLD82" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="McAdE1Pt5t" class="relative group/block"><h3 id="inverse-problem-2" class="relative group"><span class="heading-text">Inverse Problem</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#inverse-problem-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="mFC8dLjKmt" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">inv_prob_parametric = inverse_problem.BaseInvProblem(
    dmis_parametric, reg_parametric, opt_parametric
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="58JZq7NA8FA-86B-QxA4p" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="YPUgbGaos0" class="relative group/block"><h3 id="directives-1" class="relative group"><span class="heading-text">Directives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#directives-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="vqriiyNL7J" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">update_jacobi = directives.UpdatePreconditioner(update_every_iteration=True)
starting_beta = directives.BetaEstimate_ByEig(beta0_ratio=5)
beta_schedule = directives.BetaSchedule(coolingFactor=2.0, coolingRate=3)
target_misfit = directives.TargetMisfit(chifact=1.0)

directives_list_parametric = [
    update_jacobi,
    starting_beta,
    beta_schedule,
    target_misfit,
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_ECUts1zRmrLWBAObeNwX" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VqydCzxcIT" class="relative group/block"><h3 id="define-and-run-inversion" class="relative group"><span class="heading-text">Define and Run Inversion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-and-run-inversion" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="KBuUkFbHAc" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">inv_parametric = inversion.BaseInversion(
    inv_prob_parametric, directives_list_parametric
)
recovered_model_parametric = inv_parametric.run(starting_parametric_model)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="acMtk5HJQ6CsJnFmiBiwZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>
Running inversion with SimPEG v0.24.0

                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                    ***Done using the default solver Pardiso and no solver_opts.***
                    
model has any nan: 0
============================ Inexact Gauss Newton ============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   
-----------------------------------------------------------------------------
x0 has any nan: 0
   0  3.19e+03  2.87e+02  0.00e+00  2.87e+02    6.58e+02      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   1  3.19e+03  1.07e+02  1.82e-02  1.65e+02    7.93e+01      0              
   2  3.19e+03  9.91e+01  2.03e-02  1.64e+02    1.47e+01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   3  1.60e+03  9.80e+01  2.07e-02  1.31e+02    2.05e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   4  1.60e+03  6.08e+01  3.67e-02  1.19e+02    1.42e+01      0              
   5  1.60e+03  5.92e+01  3.77e-02  1.19e+02    3.11e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   6  7.99e+02  5.90e+01  3.78e-02  8.92e+01    1.57e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   7  7.99e+02  3.60e+01  5.77e-02  8.21e+01    6.20e+00      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   8  7.99e+02  3.53e+01  5.86e-02  8.21e+01    3.86e-01      0   Skip BFGS  
   9  3.99e+02  3.52e+01  5.86e-02  5.86e+01    1.16e+02      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  10  3.99e+02  2.14e+01  8.25e-02  5.44e+01    8.18e+00      0              
  11  3.99e+02  2.10e+01  8.35e-02  5.44e+01    1.18e+00      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  12  2.00e+02  2.10e+01  8.36e-02  3.77e+01    8.00e+01      0   Skip BFGS  
  13  2.00e+02  1.33e+01  1.10e-01  3.52e+01    7.79e+00      0              
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  14  2.00e+02  1.31e+01  1.11e-01  3.52e+01    1.00e+00      0   Skip BFGS  
  15  9.98e+01  1.30e+01  1.11e-01  2.41e+01    5.05e+01      0   Skip BFGS  
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>------------------------- STOP! -------------------------
1 : |fc-fOld| = 0.0000e+00 &lt;= tolF*(1+|f0|) = 2.8794e+01
1 : |xc-x_last| = 8.4882e-02 &lt;= tolX*(1+|x0|) = 6.7086e-01
0 : |proj(x-g)-x|    = 5.0545e+01 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 5.0545e+01 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =     100    &lt;= iter          =     16
------------------------- DONE! -------------------------
</span></code></pre></div></div></div><div id="ppLWym38uo" class="relative group/block"><h3 id="data-misfit-and-recovered-model-1" class="relative group"><span class="heading-text">Data Misfit and Recovered Model</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#data-misfit-and-recovered-model-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="M4SqXrTasf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">dpred_parametric = simulation_parametric.dpred(recovered_model_parametric)

fig = plt.figure(figsize=(10, 5))
ax = [fig.add_axes([0.1 + ii * 0.5, 0.1, 0.37, 0.85]) for ii in range(2)]
for ii in range(2):
    ax[ii].loglog(frequencies, np.abs(dobs[ii::2]), &quot;k-o&quot;, lw=2)
    ax[ii].loglog(frequencies, np.abs(dpred_L2[ii::2]), &quot;b-o&quot;, lw=2)
    ax[ii].loglog(frequencies, np.abs(dpred_irls[ii::2]), &quot;r-o&quot;, lw=2)
    ax[ii].loglog(frequencies, np.abs(dpred_parametric[ii::2]), &quot;g-o&quot;, lw=2)
    ax[ii].grid(which=&quot;both&quot;)
    ax[ii].set_xlabel(&quot;Frequency (Hz)&quot;)
    ax[ii].set_ylabel(&quot;|Hs/Hp| (ppm)&quot;)
    ax[ii].legend(
        [
            &quot;True Sounding&quot;,
            &quot;Predicted (L2-model)&quot;,
            &quot;Predicted (IRLS)&quot;,
            &quot;Predicted (Parametric)&quot;,
        ]
    )
    if ii == 1:
        ax[ii].set_ylabel(&quot;&quot;)

ax[0].set_title(&quot;Real Component&quot;)
ax[1].set_title(&quot;Imaginary Component&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Kv0W-p77qfRqGc6GZI0m_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/e878dd00b45d89c0bcc877ad2da01b98.png" alt="&lt;Figure size 1000x500 with 2 Axes&gt;"/></div></div><div id="U4v0jr6Jct" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(6, 6))

ax1 = fig.add_axes([0.2, 0.15, 0.7, 0.7])
plot_1d_layer_model(true_layers, true_conductivities, ax=ax1, color=&quot;k&quot;)
plot_1d_layer_model(
    layer_thicknesses, log_conductivity_map * recovered_model_L2, ax=ax1, color=&quot;b&quot;
)
plot_1d_layer_model(
    layer_thicknesses, log_conductivity_map * recovered_model_irls, ax=ax1, color=&quot;r&quot;
)
plot_1d_layer_model(
    log_thicknesses_map * recovered_model_parametric,
    1 / (log_resistivity_map * recovered_model_parametric),
    ax=ax1,
    color=&quot;g&quot;,
)
ax1.grid()
ax1.set_xlabel(r&quot;Resistivity ($\Omega m$)&quot;)
x_min, x_max = true_conductivities.min(), true_conductivities.max()
ax1.set_xlim(0.9 * x_min, 2 * x_max)
ax1.set_ylim([np.sum(layer_thicknesses), 0])
ax1.legend([&quot;True Model&quot;, &quot;L2 Model&quot;, &quot;IRLS Model&quot;, &quot;Parametric Model&quot;])
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="I-euQakADQVKKXKk94L2Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/user-tutorials/build/2fcdf8d50de2e03b318b2dec6ad6be45.png" alt="&lt;Figure size 600x600 with 1 Axes&gt;"/></div></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/fwd-fdem-1d"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">SimPEG User Tutorials</div>1D Forward Simulation of Frequency Domain EM Data for a Single Sounding</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/user-tutorials/tdem-index"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">SimPEG User Tutorials</div>Time-Domain Electromagnetics</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/user-tutorials/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/user-tutorials/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/user-tutorials/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/user-tutorials/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/inv-fdem-1d","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.3","title":"SimPEG User Tutorials","options":{"logo":"/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png","logo_text":"User Tutorials","analytics_plausible":"simpeg.xyz"},"nav":[{"title":"SimPEG","children":[{"title":"Project website","url":"https://simpeg.xyz"},{"title":"Documentation","url":"https://docs.simpeg.xyz"}]}],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide","internal":false,"static":false}],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/user-tutorials"},"routes/$":{"config":{"version":2,"myst":"1.6.3","title":"SimPEG User Tutorials","options":{"logo":"/user-tutorials/build/simpeg-logo-e179c062ed3171e44e6ccf2f9e5ca3de.png","logo_text":"User Tutorials","analytics_plausible":"simpeg.xyz"},"nav":[{"title":"SimPEG","children":[{"title":"Project website","url":"https://simpeg.xyz"},{"title":"Documentation","url":"https://docs.simpeg.xyz"}]}],"actions":[{"title":"Learn More","url":"https://mystmd.org/guide","internal":false,"static":false}],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"6a7213ed4e84875c3adc88ba270ab44ea5fd2fa76e09fd46518994d9df0d6854","slug":"inv-fdem-1d","location":"/notebooks/07-fdem/inv_fdem_1d.ipynb","dependencies":[],"frontmatter":{"title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]}],"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/simpeg/user-tutorials","subject":"SimPEG User Tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/simpeg/user-tutorials/blob/main/notebooks/07-fdem/inv_fdem_1d.ipynb","edit_url":"https://github.com/simpeg/user-tutorials/edit/main/notebooks/07-fdem/inv_fdem_1d.ipynb","exports":[{"format":"ipynb","filename":"inv_fdem_1d.ipynb","url":"/user-tutorials/build/inv_fdem_1d-c2e55246e943569665a4bef8b17623a2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Intermediate notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cViIFzGf0S"}],"key":"AJEQaRsAAh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial focusses on intermediate level functionality within SimPEG. Basic functionality within SimPEG is not discussed in detail, as we assume the user is already familiar.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sk0IzYvIXE"}],"key":"WyzT7jzye8"}],"class":"caution","key":"tL68RccT1x"}],"key":"xg7tjT6kAz"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Light-weight notebook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XSyx1e4t5F"}],"key":"oiGcfkJh4s"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This tutorial requires minimal computational resources and can be executed quickly in the background while other computer processes are running.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NozXaO8CHE"}],"key":"hiafXWOHt6"}],"class":"hint","key":"h676YZK5L3"}],"key":"ZsNvRuh37u"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Keywords:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nUOtD5nmWQ"}],"key":"SVsRNETgRQ"},{"type":"text","value":" frequency-domain EM, 1D sounding, inversion, parametric, sparse norm, wires mapping","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M75w22V33c"}],"key":"o6n9SUZr4M"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Summary:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"H9j8MbdJhk"}],"key":"ghFMbCd52X"},{"type":"text","value":" Here, we invert secondary magnetic field data for a single 1D FDEM sounding. We demonstrate 3 approaches for inverting the data:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yN40zlHczS"}],"key":"VIqdZtRo5r"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A weighted least-squares inversion where the number of layers and their thicknesses are fixed","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"T69Qp0AdSp"}],"key":"EFVAXpFkPS"}],"key":"hrO5BhiV7X"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"An iteratively re-weighted least-squares (IRLS) inversion to recover sparse and/or blocky structures","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cq7YTSjRMp"}],"key":"rON27oIjic"}],"key":"yuFThpRvCb"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A parametric inversion where we invert for the layer thicknesses and electrical properties assuming a 3-layered Earth","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"YORd7A9iC5"}],"key":"TPc8f47q0c"}],"key":"McfvK9B1qO"}],"key":"SqRzHzY5Nb"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"n58FBdBwru"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"weighted least-squares","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QJ9vuKhsMt"}],"key":"Zmw4lknrLF"},{"type":"text","value":" approach is a great introduction to geophysical inversion with SimPEG. One drawback however, is that it recovers smooth structures which may not be representative of the true model. To recover sparse and/or blocky 1D structures, we demonstrate an ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"M9mVGzfS81"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"iteratively re-weighted least-squares","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Ohj1swXPoV"}],"key":"e6qlKQCZXq"},{"type":"text","value":" approach. If the number of layers is known, but their depths, thicknesses and conductivities are not, we can use a ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RKmuVfZwNd"},{"type":"emphasis","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"parametric inversion","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XKR0GcfHce"}],"key":"YfwCoPVHPV"},{"type":"text","value":" approach.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UaigypmAlN"}],"key":"SgXoFwGC6a"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Learning Objectives:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Yq4gI9B7lb"}],"key":"o9SMhQpE0r"},{"type":"text","value":" Because this tutorial focusses primarily on inversion-related functionality, we urge the reader to become familiar with functionality explained in the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tJFRN5Hw6o"},{"type":"link","url":"/fwd-fdem-1d","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"1D Forward Simulation of Frequency-Domain EM Data for a Single Sounding","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yNdEcHeZGP"}],"urlSource":"fwd_fdem_1d.ipynb","dataUrl":"/fwd-fdem-1d.json","internal":true,"protocol":"file","key":"F4xTTDKHt9"},{"type":"text","value":" tutorial before working through this one. For this tutorial, we focus on:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KKOfmx8SWW"}],"key":"iNMPBspAZ6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How to carry out 1D geophysical inversion with SimPEG.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"bo8Eie4dmC"}],"key":"hoZsrs35fN"}],"key":"GAEhxvQ1Od"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"How to assign appropriate uncertainties to FDEM data.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"rPr8AXx8Rm"}],"key":"AaXZHfLshn"}],"key":"LpRRicuBAk"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Choosing suitable parameters for the inversion.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"yWqYsyxvqF"}],"key":"B9CmyQs6Vv"}],"key":"nEIyLDHArl"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Specifying directives that are applied throughout the inversion.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"SgE8HjWwn4"}],"key":"CUSoe7EjwI"}],"key":"cGSvKygC2x"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Weighted least-squares, sparse-norm and parametric inversion.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"qLundwmxy9"}],"key":"bP38DLKkGt"}],"key":"WaYOtjOgAD"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Analyzing inversion outputs.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"OlPZM8aA4I"}],"key":"SwVYQDgPTF"}],"key":"AJKOyIQSrH"}],"key":"M37OuFoqI8"}],"key":"WmGc4cBcQ6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Importing Modules","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TKkCbr4cjH"}],"identifier":"importing-modules","label":"Importing Modules","html_id":"importing-modules","implicit":true,"key":"RDkq3l5HFE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here, we import all of the functionality required to run the notebook for the tutorial exercise.\nAll of the functionality specific to the forward simulation of 1D frequency domain EM data are imported from the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uRO8u260HK"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.electromagnetics.frequency_domain.html#module-simpeg.electromagnetics.frequency_domain","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simpeg​.electromagnetics​.frequency​_domain","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TAX5Ug7GFV"}],"urlSource":"xref:simpeg#simpeg.electromagnetics.frequency_domain","internal":false,"protocol":"xref:sphinx","key":"dgVu0DZjgV"},{"type":"text","value":" module. Classes required to define the data misfit, regularization, optimization, etc... are imported from elsewhere within SimPEG. We also import some useful utility functions from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EKSKUlGus8"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/simpeg.utils.html#module-simpeg.utils","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simpeg.utils","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MvWH8nZaIg"}],"urlSource":"xref:simpeg#simpeg.utils","internal":false,"protocol":"xref:sphinx","key":"K0pJw8WSIc"},{"type":"text","value":". To generate the mesh used for the inversion, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LWOZydyZ6d"},{"type":"link","url":"https://discretize.simpeg.xyz/en/main","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"discretize","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Oo3KQ3ZHdw"}],"urlSource":"https://discretize.simpeg.xyz/en/main","key":"TwnotxOnkM"},{"type":"text","value":" package.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rxw9xGUTer"}],"key":"ARgc0aYGnD"}],"key":"mqc0tsyd50"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:37.310284Z","iopub.status.busy":"2025-05-23T17:19:37.309828Z","iopub.status.idle":"2025-05-23T17:19:38.989850Z","shell.execute_reply":"2025-05-23T17:19:38.989189Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# SimPEG functionality\nimport simpeg.electromagnetics.frequency_domain as fdem\nfrom simpeg.utils import plot_1d_layer_model, download, mkvc\nfrom simpeg import (\n    maps,\n    data,\n    data_misfit,\n    regularization,\n    optimization,\n    inverse_problem,\n    inversion,\n    directives,\n)\n\n# discretize functionality\nfrom discretize import TensorMesh\n\n# Basic Python functionality\nimport os\nimport numpy as np\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nimport tarfile\n\nmpl.rcParams.update({\"font.size\": 14})","key":"CBKJmeRLCz"},{"type":"output","id":"EwE1HppYxIjgJ_ZD2_DdP","data":[],"key":"frYMtpsfDQ"}],"key":"aK76ck2H9Q"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Download and Extract the Tutorial Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fe50Aowt7i"}],"identifier":"download-and-extract-the-tutorial-data","label":"Download and Extract the Tutorial Data","html_id":"download-and-extract-the-tutorial-data","implicit":true,"key":"Bg5fnOn78v"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this tutorial, the frequencies and observed data for 1D sounding are stored within a tar-file. Here, we download and extract the data file.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h3vW056xw6"}],"key":"GqYNrGW147"}],"key":"qugdxzo9kD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:38.993582Z","iopub.status.busy":"2025-05-23T17:19:38.993238Z","iopub.status.idle":"2025-05-23T17:19:39.457468Z","shell.execute_reply":"2025-05-23T17:19:39.456228Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# URL to assets\ndata_source = \"https://github.com/simpeg/user-tutorials/raw/main/assets/07-fdem/inv_fdem_1d_files.tar.gz\"\n\n# download the data\ndownloaded_data = download(data_source, overwrite=True)\n\n# unzip the tarfile\ntar = tarfile.open(downloaded_data, \"r\")\ntar.extractall()\ntar.close()\n\n# path to the directory containing our data\ndir_path = downloaded_data.split(\".\")[0] + os.path.sep\n\n# files to work with\ndata_filename = dir_path + \"em1dfm_data.txt\"","key":"js2bRYZBAl"},{"type":"output","id":"JjgJ2O27E67Yg80tuS5a4","data":[{"name":"stdout","output_type":"stream","text":"Downloading https://github.com/simpeg/user-tutorials/raw/main/assets/07-fdem/inv_fdem_1d_files.tar.gz\n"},{"name":"stdout","output_type":"stream","text":"   saved to: /home/ssoler/git/user-tutorials/notebooks/07-fdem/inv_fdem_1d_files.tar.gz\nDownload completed!\n"},{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_983900/1849335314.py:9: DeprecationWarning: Python 3.14 will, by default, filter extracted tar archives and reject files or modify their metadata. Use the filter argument to control this behavior.\n  tar.extractall()\n"}],"key":"CkvdfvD1lM"}],"key":"cEqpFmu5rN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load and Plot the Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BGmsKUtUEq"}],"identifier":"load-and-plot-the-data","label":"Load and Plot the Data","html_id":"load-and-plot-the-data","implicit":true,"key":"U1wSQl0oHn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here we load and plot the 1D sounding data. In this case, we have the\nsecondary field response in ppm for a set of frequencies. The columns of the data file are: frequency (Hz), real component (ppm) and imaginary component (ppm).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"emNLuCrn76"}],"key":"RY2MEWz8Tf"}],"key":"fwFfi5WRfg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:39.461595Z","iopub.status.busy":"2025-05-23T17:19:39.461193Z","iopub.status.idle":"2025-05-23T17:19:39.467160Z","shell.execute_reply":"2025-05-23T17:19:39.466003Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Load data\ndobs = np.loadtxt(str(data_filename), skiprows=1)","key":"DY4Pcoo52U"},{"type":"output","id":"RS6aYMH7gtGeZG7S1Fd5L","data":[],"key":"YJkw5AUWMr"}],"key":"ACsrHHquSa"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:39.470541Z","iopub.status.busy":"2025-05-23T17:19:39.470144Z","iopub.status.idle":"2025-05-23T17:19:39.475013Z","shell.execute_reply":"2025-05-23T17:19:39.474161Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Extract frequency and observed data columns\nfrequencies = dobs[:, 0]\ndobs = mkvc(dobs[:, 1:].T)","key":"VmTkXg8hH3"},{"type":"output","id":"lY8ievKXHxC96SexUfbcE","data":[],"key":"blUIR3d6po"}],"key":"V2M85l3pPL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:39.478089Z","iopub.status.busy":"2025-05-23T17:19:39.477706Z","iopub.status.idle":"2025-05-23T17:19:39.998381Z","shell.execute_reply":"2025-05-23T17:19:39.997709Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot data\nfig, ax = plt.subplots(1, 1, figsize=(5, 5))\nax.loglog(frequencies, np.abs(dobs[0::2]), \"k-o\", lw=2)\nax.loglog(frequencies, np.abs(dobs[1::2]), \"k:o\", lw=2)\nax.grid(which=\"both\")\nax.set_xlabel(\"Frequency (Hz)\")\nax.set_ylabel(\"|Hs/Hp| (ppm)\")\nax.set_title(\"Sounding Data\")\nax.legend([\"Real\", \"Imaginary\"])\nplt.show()","key":"Tr16mx3E6W"},{"type":"output","id":"KGx0NzkENm0Ckyrmq0qQ6","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7f4511de6b36ddfb59a48a5d276cb1c4","path":"/user-tutorials/build/7f4511de6b36ddfb59a48a5d276cb1c4.png"},"text/plain":{"content":"\u003cFigure size 500x500 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"qG6ZIvV5CF"}],"key":"WsXtrXT07M"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining the Survey","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Im2uUgRXx9"}],"identifier":"defining-the-survey","label":"Defining the Survey","html_id":"defining-the-survey","implicit":true,"key":"gjqj2e6Dp8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we define the survey geometry. For a comprehensive description of constructing FDEM surveys in SimPEG, see the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"daa2u9k2o0"},{"type":"link","url":"/fwd-fdem-1d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1D Forward Simulation of Frequency-Domain EM Data for a Single Sounding","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"er7DM8mYxI"}],"urlSource":"fwd_fdem_1d.ipynb","dataUrl":"/fwd-fdem-1d.json","internal":true,"protocol":"file","key":"ZnCw0WdGlo"},{"type":"text","value":" tutorial.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O1Kc8gpJ1g"}],"key":"GPk8kVOu4s"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here, the survey consisted of a vertical magnetic dipole source located 30 m above the surface. The receiver measured the vertical component of the secondary field at a 10 m offset from the source in ppm.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LuMeI7eHdz"}],"key":"XQoO2SPs5p"}],"key":"jZVazsEIHt"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.001839Z","iopub.status.busy":"2025-05-23T17:19:40.001601Z","iopub.status.idle":"2025-05-23T17:19:40.007557Z","shell.execute_reply":"2025-05-23T17:19:40.007030Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"source_location = np.array([0.0, 0.0, 30.0])\nsource_orientation = \"z\"\nmoment = 1.0\n\nreceiver_location = np.array([10.0, 0.0, 30.0])\nreceiver_orientation = \"z\"\ndata_type = \"ppm\"\n\n# Receiver list\nreceiver_list = []\nreceiver_list.append(\n    fdem.receivers.PointMagneticFieldSecondary(\n        receiver_location,\n        orientation=receiver_orientation,\n        data_type=data_type,\n        component=\"real\",\n    )\n)\nreceiver_list.append(\n    fdem.receivers.PointMagneticFieldSecondary(\n        receiver_location,\n        orientation=receiver_orientation,\n        data_type=data_type,\n        component=\"imag\",\n    )\n)\n\n# Define source list\nsource_list = []\nfor freq in frequencies:\n    source_list.append(\n        fdem.sources.MagDipole(\n            receiver_list=receiver_list,\n            frequency=freq,\n            location=source_location,\n            orientation=source_orientation,\n            moment=moment,\n        )\n    )\n\n# Survey\nsurvey = fdem.survey.Survey(source_list)","key":"G2UjPv0ubh"},{"type":"output","id":"ysgObCaPEYQ5Fg22vv84s","data":[],"key":"U7HSmQ55cN"}],"key":"H8IsuCMAVL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Assign Uncertainties","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NG5sjuLpNE"}],"identifier":"assign-uncertainties","label":"Assign Uncertainties","html_id":"assign-uncertainties","implicit":true,"key":"JytbOj7qrE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Inversion with SimPEG requires that we define the uncertainties on our data; that is, an estimate of the standard deviation of the noise on our data assuming it is uncorrelated Gaussian with zero mean. An online resource explaining uncertainties and their role in the inversion can be found ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r6h4EYuHip"},{"type":"link","url":"https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/Uncertainties.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qf5vLBO2UU"}],"urlSource":"https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/Uncertainties.html","key":"y2BeQVkBPh"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xTXso09abR"}],"key":"OnftyZljB0"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For secondary field and ppm data:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"knoAfGULn8"}],"key":"bHNNqrE9zl"},{"type":"text","value":" In this case, we generally apply a percent uncertainty. Depending on many factors, a percent uncertainty between 5% and 20% may be applied. For systems where multiple field directions are measured for the same source, we may not want to apply a uniform percent uncertainty to all data. Doing so may cause the inversion to overfit weaker signals. In this case, the uncertainty may be a percent of the amplitude of the secondary field. If the data contain very small values, a small floor value should be added to ensure stability of the inversion.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QG0L09oV8t"}],"key":"JTuZX1fqJs"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"For total field data:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FRN1iyu2LD"}],"key":"sgOG7uDuaW"},{"type":"text","value":" In this case, the real component contains both the primary and secondary fields, whereas the imaginary component contains only secondary fields. Because the primary field is orders of magnitude larger than the secondary field, applying a simple percent uncertainty to the real component data may result in us underfitting the real component of the EM response. Ideally, we would have defined the survey to perfectly simulate the primary fields, and assign uncertainties based on the secondary fields.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"irengBzefl"}],"key":"vpHYHTAsnq"}],"key":"QPPr3tfhzr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.010836Z","iopub.status.busy":"2025-05-23T17:19:40.010535Z","iopub.status.idle":"2025-05-23T17:19:40.013938Z","shell.execute_reply":"2025-05-23T17:19:40.013355Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# 5% of the absolute value\nuncertainties = 0.05 * np.abs(dobs) * np.ones(np.shape(dobs))","key":"vEC3GMjoyX"},{"type":"output","id":"ve7gZEb2aa2TpXlqovDid","data":[],"key":"xBNj75J0Oi"}],"key":"jXc0gRF814"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining the Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SvxKs5XBK8"}],"identifier":"defining-the-data","label":"Defining the Data","html_id":"defining-the-data","implicit":true,"key":"U8MKzUwKMg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The SimPEG ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"c9bgpxwxuM"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.data.Data.html#simpeg.data.data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lZkAG1Ho9H"}],"urlSource":"xref:simpeg#simpeg.data.Data","internal":false,"protocol":"xref:sphinx","key":"zzChtEoXGy"},{"type":"text","value":" class is required for inversion and connects the observed data, uncertainties and survey geometry.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jgNuOCEUPO"}],"key":"fW0XhZL4Uq"}],"key":"pR9NiSND9B"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.016677Z","iopub.status.busy":"2025-05-23T17:19:40.016361Z","iopub.status.idle":"2025-05-23T17:19:40.019960Z","shell.execute_reply":"2025-05-23T17:19:40.019373Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"data_object = data.Data(survey, dobs=dobs, noise_floor=uncertainties)","key":"fAg4uijjKX"},{"type":"output","id":"KIeWVwvba1hoeZH5n9xbE","data":[],"key":"W88JJWdVZQ"}],"key":"lsyx0fScQD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Weighted Least-Squares Inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"peiM8H6XEZ"}],"identifier":"weighted-least-squares-inversion","label":"Weighted Least-Squares Inversion","html_id":"weighted-least-squares-inversion","implicit":true,"key":"R9nydejvAB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we use the weighted least-squares inversion approach to recover the log-conductivities on a 1D layered Earth. We impose no a-priori information about the number of layers (geological units) or their thicknesses. Instead, we define a large number of layers with exponentially increasing thicknesses. And the depth, thickness and electrical properties of the Earth are inferred from the recovered model.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"astlV4H80K"}],"key":"Ioyd51zURD"}],"key":"YcaTnkdNGq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining a 1D Layered Earth","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nKqQgmaFoO"}],"identifier":"defining-a-1d-layered-earth","label":"Defining a 1D Layered Earth","html_id":"defining-a-1d-layered-earth","implicit":true,"key":"NXpDfLvLOV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let us assume we have a reasonable estimate of the regional conductivity within our area of interest. For the highest frequency and the estimated conductivity, we compute the minimum skin depth:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bUYPPvHxx0"}],"key":"n6hD19S9b2"},{"type":"math","value":"d_{min} \\approx 500 \\sqrt{\\dfrac{1}{\\sigma \\, f_{max}}}","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e≈\u003c/mo\u003e\u003cmn\u003e500\u003c/mn\u003e\u003cmsqrt\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmrow\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmtext\u003e \u003c/mtext\u003e\u003cmsub\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/msqrt\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ed_{min} \\approx 500 \\sqrt{\\dfrac{1}{\\sigma \\, f_{max}}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003emin\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.44em;vertical-align:-0.8856em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e500\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.5544em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-4.4em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.4em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:1em;\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ema\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8804em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.5144em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.4em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8856em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"djioRdq33d"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The minimum layer thickness is some fraction of the minimum skin depth. Next, we use the minimum frequency and the estimated conductivity to compute the maximum skin depth:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UPNOpeHbef"}],"key":"lzDwj9ubab"},{"type":"math","value":"d_{max} \\approx 500 \\sqrt{\\dfrac{1}{\\sigma \\, f_{min}}}","position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e≈\u003c/mo\u003e\u003cmn\u003e500\u003c/mn\u003e\u003cmsqrt\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmrow\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmtext\u003e \u003c/mtext\u003e\u003cmsub\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmrow\u003e\u003cmi\u003em\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/msqrt\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ed_{max} \\approx 500 \\sqrt{\\dfrac{1}{\\sigma \\, f_{min}}}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ema\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.44em;vertical-align:-0.8856em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e500\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.5544em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-4.4em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.4em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:1em;\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003emin\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8804em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.5144em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:4.4em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='2.48em' viewBox='0 0 400000 2592' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8856em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"DrrEhrYpyu"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Starting from our minimum layer thickness, we continue to add layers with exponentially increasing thicknesses. We do so until the layers extend to some multiple of the maximum skin depth.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"GII9Lu3ag0"}],"key":"cIGCRzboji"}],"key":"K16NAhB9CG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.022732Z","iopub.status.busy":"2025-05-23T17:19:40.022421Z","iopub.status.idle":"2025-05-23T17:19:40.027343Z","shell.execute_reply":"2025-05-23T17:19:40.026635Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# estimated host conductivity (S/m)\nestimated_conductivity = 0.1\n\n# minimum skin depth\nd_min = 500.0 / np.sqrt(estimated_conductivity * frequencies.max())\nprint(\"MINIMUM SKIN DEPTH: {} m\".format(d_min))\n\n# maximum skin depth\nd_max = 500.0 / np.sqrt(estimated_conductivity * frequencies.min())\nprint(\"MAXIMUM SKIN DEPTH: {} m\".format(d_max))","key":"SYZuyoBWLP"},{"type":"output","id":"HP0rCx3qZGbcvYA6oyKOL","data":[{"name":"stdout","output_type":"stream","text":"MINIMUM SKIN DEPTH: 4.383604418942005 m\nMAXIMUM SKIN DEPTH: 80.89810021132169 m\n"}],"key":"V7svxWMaoX"}],"key":"gKb2CvWV5o"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.030162Z","iopub.status.busy":"2025-05-23T17:19:40.029812Z","iopub.status.idle":"2025-05-23T17:19:40.033430Z","shell.execute_reply":"2025-05-23T17:19:40.032828Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"depth_min = 0.5  # top layer thickness\ndepth_max = 200.0  # depth to lowest layer\ngeometric_factor = 1.1  # rate of thickness increase","key":"Z16XExSb6u"},{"type":"output","id":"MHp9yYvot01Rz4IiEPakb","data":[],"key":"uFFAi8FOoS"}],"key":"w1wE9v6F5A"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.036385Z","iopub.status.busy":"2025-05-23T17:19:40.036010Z","iopub.status.idle":"2025-05-23T17:19:40.040989Z","shell.execute_reply":"2025-05-23T17:19:40.040144Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Increase subsequent layer thicknesses by the geometric factors until\n# it reaches the maximum layer depth.\nlayer_thicknesses = [depth_min]\nwhile np.sum(layer_thicknesses) \u003c depth_max:\n    layer_thicknesses.append(geometric_factor * layer_thicknesses[-1])\n\nn_layers = len(layer_thicknesses) + 1  # Number of layers","key":"qWgaDPX3ne"},{"type":"output","id":"mvrro8AiYlig5SiSPHFlV","data":[],"key":"r40rXf0hEJ"}],"key":"qIrtHmnNCO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Model and Mapping to Layer Conductivities","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HhrTziDuRn"}],"identifier":"model-and-mapping-to-layer-conductivities","label":"Model and Mapping to Layer Conductivities","html_id":"model-and-mapping-to-layer-conductivities","implicit":true,"key":"VkzUSwD6j1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Recall from the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oQQcrLkwWg"},{"type":"link","url":"/fwd-fdem-1d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1D Forward Simulation of Frequency-Domain EM Data for a Single Sounding","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SnQZufI0v5"}],"urlSource":"fwd_fdem_1d.ipynb","dataUrl":"/fwd-fdem-1d.json","internal":true,"protocol":"file","key":"VuRFQFFlXf"},{"type":"text","value":" tutorial that the ‘model’ is not necessarily synonymous with physical property values. And that we need to define a mapping from the model to the set of input parameters required by the forward simulation. When inverting to recover electrical conductivities (or resistivities), it is best to use the log-value, as electrical conductivities of rocks span many order of magnitude.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ja0NPq4q6N"}],"key":"KRDq29FExd"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here, the model defines the log-conductivity values for a defined set of subsurface layers. And we use the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ulFBDr00SH"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.ExpMap.html#simpeg.maps.expmap","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"simpeg.maps.ExpMap","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"frBXnyouWr"}],"urlSource":"xref:simpeg#simpeg.maps.ExpMap","internal":false,"protocol":"xref:sphinx","key":"PggqdMxXY9"},{"type":"text","value":" to map from the model parameters to the conductivity values required by the forward simulation.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DxRzbw0lXz"}],"key":"JuZFCOaJzB"}],"key":"EZG0gvoxKm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.044274Z","iopub.status.busy":"2025-05-23T17:19:40.043858Z","iopub.status.idle":"2025-05-23T17:19:40.047956Z","shell.execute_reply":"2025-05-23T17:19:40.047317Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"log_conductivity_map = maps.ExpMap(nP=n_layers)","key":"DoB70oF66y"},{"type":"output","id":"7nb4IHEdGWqx5GcOpV1SV","data":[],"key":"sji0W7N0T6"}],"key":"nSzGROikpw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Starting/Reference Models","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aQpGwYdAdt"}],"identifier":"starting-reference-models","label":"Starting/Reference Models","html_id":"starting-reference-models","implicit":true,"key":"FmfZqvHBO8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oRVt2XHmId"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"starting model","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uGZkLDrGT3"}],"key":"skTxxVYQ7o"},{"type":"text","value":" defines a reasonable starting point for the inversion. Because electromagnetic problems are non-linear, your choice in starting model does have an impact on the recovered model. For DC resistivity inversion, we generally choose our starting model based on apparent resistivities. For the tutorial example, the apparent resistivities were near 1000 ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rumc23iaTN"},{"type":"inlineMath","value":"\\Omega m","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003eΩ\u003c/mi\u003e\u003cmi\u003em\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\Omega m\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003eΩ\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003em\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"LAGPECj11v"},{"type":"text","value":". It should be noted that the starting model ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OuBybrpCuA"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"cannot be vector of zeros,","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ywJHnrbys6"}],"key":"e8kGvSFyMJ"},{"type":"text","value":" otherwise the inversion will be unable to compute a gradient direction at the first iteration.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q6wiKcHWJm"}],"key":"O1ETCZzoLN"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dCOH0JVe1a"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"reference model","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KxW728SwVq"}],"key":"ZgLVqHNa3m"},{"type":"text","value":" is used to include a-priori information. The impact of the reference model on the inversion will be discussed in another tutorial. The reference model for basic inversion approaches is either zero or equal to the starting model.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GQL3nlJjjB"}],"key":"X3Bi5NprQC"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Notice that the length of the starting and reference models is equal to the number of model parameters!!!","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nC3E10DpH7"}],"key":"d1tWDzqV1L"}],"key":"LqTNFDxIsx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.050791Z","iopub.status.busy":"2025-05-23T17:19:40.050507Z","iopub.status.idle":"2025-05-23T17:19:40.054323Z","shell.execute_reply":"2025-05-23T17:19:40.053719Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Starting model is log-conductivity values (S/m)\nstarting_conductivity_model = np.log(1e-1 * np.ones(n_layers))\n\n# Reference model is also log-resistivity values (S/m)\nreference_conductivity_model = starting_conductivity_model.copy()","key":"pPGmgI1gui"},{"type":"output","id":"vNSAm3-wI-3is-9DYAG06","data":[],"key":"E5mTULf6ts"}],"key":"BkYpJByBT9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Forward Simulation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E59cx0oFs3"}],"identifier":"define-the-forward-simulation","label":"Define the Forward Simulation","html_id":"define-the-forward-simulation","implicit":true,"key":"DM1k3hKatX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A simulation object defining the forward problem is required in order to predict data and calculate misfits for recovered models. A comprehensive description of the simulation object for 1D DC resistivity was discussed in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rOPDiVuzau"},{"type":"link","url":"/fwd-fdem-1d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1D Forward Simulation of Frequency-Domain EM Data for a Single Sounding","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KICa7McSZg"}],"urlSource":"fwd_fdem_1d.ipynb","dataUrl":"/fwd-fdem-1d.json","internal":true,"protocol":"file","key":"PCHY175vTO"},{"type":"text","value":" tutorial. Here, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GcFF3WxDYT"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.electromagnetics.frequency_domain.Simulation1DLayered.html#simpeg.electromagnetics.frequency_domain.simulation1dlayered","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Simulation1DLayered","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yOy23BVpil"}],"urlSource":"xref:simpeg#simpeg.electromagnetics.frequency_domain.Simulation1DLayered","internal":false,"protocol":"xref:sphinx","key":"RKLQhvPblx"},{"type":"text","value":" which simulates the data according to a 1D Hankel transform solution.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ENRHuhO7iq"}],"key":"s6jqNo2k8I"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The layer thicknesses are a static property of the simulation, and we set them using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jNnXKoMrBt"},{"type":"inlineCode","value":"thicknessess","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fZKItSxXk5"},{"type":"text","value":" keyword argument. Since our model consists of log-conductivities, we use ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mc90W9HGZs"},{"type":"inlineCode","value":"sigmaMap","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xR2Fgv2aVq"},{"type":"text","value":" to set the mapping from the model to the layer conductivities.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Q4o4wTb5np"}],"key":"feXopG3glD"}],"key":"b8RYBtxC2h"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.057484Z","iopub.status.busy":"2025-05-23T17:19:40.057147Z","iopub.status.idle":"2025-05-23T17:19:40.063444Z","shell.execute_reply":"2025-05-23T17:19:40.062648Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation_L2 = fdem.Simulation1DLayered(\n    survey=survey, thicknesses=layer_thicknesses, sigmaMap=log_conductivity_map\n)","key":"enC9MhnUqU"},{"type":"output","id":"XhhGwy6a-xJ7oMiu8z5u4","data":[],"key":"W4F6O8PKpU"}],"key":"lvFFKPQc87"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Misfit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vMnUj3xMP0"}],"identifier":"data-misfit","label":"Data Misfit","html_id":"data-misfit","implicit":true,"key":"SXpEkwUaQb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To understand the role of the data misfit in the inversion, please visit ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CZvvXnrc9u"},{"type":"link","url":"https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/Uncertainties.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"this online resource","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dd4qHJZILA"}],"urlSource":"https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/Uncertainties.html","key":"hUQ0l0Gk7U"},{"type":"text","value":".\nHere, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yBZVQAvXMH"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.data_misfit.L2DataMisfit.html#simpeg.data_misfit.l2datamisfit","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"L2DataMisfit","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jnnNbxA3ln"}],"urlSource":"xref:simpeg#simpeg.data_misfit.L2DataMisfit","internal":false,"protocol":"xref:sphinx","key":"Bb7HE3Oggx"},{"type":"text","value":" class to define the data misfit. In this case, the data misfit is the L2 norm of the weighted residual between the observed data and the data predicted for a given model. When instantiating the data misfit object within SimPEG, we must assign an appropriate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sB4846nKNX"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"data object","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"plPODFOHGP"}],"key":"ri17qRtuSo"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xQbIcWsrak"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simulation object","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N5wUdhEiqQ"}],"key":"yEDmMgQCXB"},{"type":"text","value":" as properties.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NvFJuXeV3j"}],"key":"Gv2sTnIDnx"}],"key":"Xfncp0B0CK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.066505Z","iopub.status.busy":"2025-05-23T17:19:40.066160Z","iopub.status.idle":"2025-05-23T17:19:40.070381Z","shell.execute_reply":"2025-05-23T17:19:40.069574Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dmis_L2 = data_misfit.L2DataMisfit(simulation=simulation_L2, data=data_object)","key":"SZiTTmG3a9"},{"type":"output","id":"Hr8_Y6kROJ_4y-D5B8Pk1","data":[],"key":"V0QDRivBQ2"}],"key":"wEfRBm5il3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Regularization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RVNMHspdPz"}],"identifier":"regularization","label":"Regularization","html_id":"regularization","implicit":true,"key":"qFtoOCgRYj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To understand the role of the regularization in the inversion, please visit ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LG3G3bO8i1"},{"type":"link","url":"https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/ObjectiveFunction.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"this online resource","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o7mrdDhHdR"}],"urlSource":"https://giftoolscookbook.readthedocs.io/en/latest/content/fundamentals/ObjectiveFunction.html","key":"DvaeqqQvOJ"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qd4bPyARU9"}],"key":"jdmC1eUpZ0"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To define the regularization within SimPEG, we must define a 1D ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"g29iw97Nw5"},{"type":"link","url":"https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.tensormesh","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"tensor mesh","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FrdvtC4eYr"}],"urlSource":"xref:discretize#discretize.TensorMesh","internal":false,"protocol":"xref:sphinx","key":"p3CZXpoQaw"},{"type":"text","value":". Meshes are designed using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"orlHG8wYiH"},{"type":"link","url":"https://discretize.simpeg.xyz","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"discretize package","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DXMzKDoyT1"}],"urlSource":"https://discretize.simpeg.xyz","key":"JEFdT0H67K"},{"type":"text","value":". Whereas layer ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uveEiYzbTh"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"thicknesses","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O8sYuEsyyY"}],"key":"iU4tY9ukwd"},{"type":"text","value":" and our ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GsOvGQsMpp"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"model","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EO2o5rHIwg"}],"key":"tQKtbSuX8k"},{"type":"text","value":" are defined from our top-layer down, tensor meshes are defined from the bottom up. So to define a 1D tensor mesh for the regularization, we:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XpKYk6hYGY"}],"key":"rQFUVvsuVE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"add an extra layer to the end of our thicknesses so that the number of cells in the 1D mesh equals the number of model parameters","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qUJIQYgzys"}],"key":"ZNKSEIa6AP"}],"key":"ht0z7O6fUr"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"reverse the order so that the model parameters in the regularization match up with the appropriate cell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"D9hKlAj0xV"}],"key":"uuyfYBCPwE"}],"key":"rhPL663Ej9"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"define the tensor mesh from the cell widths","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"DnBZeT5ttB"}],"key":"KKxeeeMBXT"}],"key":"YOkukRtf9f"}],"key":"grdrd7FRys"}],"key":"n3Yl9J5CMo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.073366Z","iopub.status.busy":"2025-05-23T17:19:40.073048Z","iopub.status.idle":"2025-05-23T17:19:40.078990Z","shell.execute_reply":"2025-05-23T17:19:40.078330Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define 1D cell widths\nh = np.r_[layer_thicknesses, layer_thicknesses[-1]]\nh = np.flipud(h)\n\n# Create regularization mesh\nregularization_mesh = TensorMesh([h], \"N\")\nprint(regularization_mesh)","key":"XDmJuHkRjw"},{"type":"output","id":"dssqmFgT3H8U8vVZtv1wd","data":[{"name":"stdout","output_type":"stream","text":"\n  TensorMesh: 40 cells\n\n                      MESH EXTENT             CELL WIDTH      FACTOR\n  dir    nC        min           max         min       max      max\n  ---   ---  ---------------------------  ------------------  ------\n   x     40       -219.43         -0.00      0.50     18.70    1.10\n\n\n"}],"key":"No7zq2JBaJ"}],"key":"rmuimHP9Qv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"By default, the regularization acts on the model parameters. In this case, the model parameters are the log-resistivities, not the electric resistivities!!! Here, we use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W5FVFtvcPO"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.regularization.WeightedLeastSquares.html#simpeg.regularization.weightedleastsquares","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"WeightedLeastSquares","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pq5V6WnU63"}],"urlSource":"xref:simpeg#simpeg.regularization.WeightedLeastSquares","internal":false,"protocol":"xref:sphinx","key":"iPUPUT20Zl"},{"type":"text","value":" regularization class to constrain the inversion result. Here, length scale along x are used to balance the smallness and smoothness terms; yes, x is smoothness along the vertical direction. And the reference model is only applied to the smallness term. If we wanted to apply the regularization to a function of the model parameters, we would need to set an approprate mapping object using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D02lOyoUN4"},{"type":"inlineCode","value":"mapping","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HgLgHHOAYz"},{"type":"text","value":" keyword argument.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xxAKjHGyJg"}],"key":"RqmUUTmUUM"}],"key":"mijaTOvgQn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.082062Z","iopub.status.busy":"2025-05-23T17:19:40.081758Z","iopub.status.idle":"2025-05-23T17:19:40.089711Z","shell.execute_reply":"2025-05-23T17:19:40.089074Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"reg_L2 = regularization.WeightedLeastSquares(\n    regularization_mesh,\n    length_scale_x=10.0,\n    reference_model=reference_conductivity_model,\n    reference_model_in_smooth=False,\n)","key":"iiQbde9gSb"},{"type":"output","id":"8-xu5op3r8otqrDN6hm_b","data":[],"key":"ZwCDbz0aW2"}],"key":"gFDmJaN8zU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Optimization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vz9sduawsa"}],"identifier":"optimization","label":"Optimization","html_id":"optimization","implicit":true,"key":"vnGE2lGKyR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"P2yowC8ock"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.optimization.InexactGaussNewton.html#simpeg.optimization.inexactgaussnewton","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"InexactGaussNewton","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Lz2S06dxVZ"}],"urlSource":"xref:simpeg#simpeg.optimization.InexactGaussNewton","internal":false,"protocol":"xref:sphinx","key":"EZUCFf3eDt"},{"type":"text","value":" class to solve the optimization problem using the inexact Gauss Newton with conjugate gradient solver. Reasonable default values have generally been set for the properties of each optimization class. However, the user may choose to set custom values; e.g. the accuracy tolerance for the conjugate gradient solver or the number of line searches.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Cr91WmaGkt"}],"key":"HOeKNTfnYK"}],"key":"SLO6Aiy1mk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.092836Z","iopub.status.busy":"2025-05-23T17:19:40.092554Z","iopub.status.idle":"2025-05-23T17:19:40.096367Z","shell.execute_reply":"2025-05-23T17:19:40.095743Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"opt_L2 = optimization.InexactGaussNewton(\n    maxIter=100, maxIterLS=20, maxIterCG=20, tolCG=1e-3\n)","key":"Y37uyngzMb"},{"type":"output","id":"RdV5BtA1uRAOeBW5BOmEh","data":[],"key":"OXvkjsCv0a"}],"key":"gebW0eFmIQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inverse Problem","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b4MivMFqj8"}],"identifier":"inverse-problem","label":"Inverse Problem","html_id":"inverse-problem","implicit":true,"key":"H08gnL7Op0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dKKtXHHQd0"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.inverse_problem.BaseInvProblem.html#simpeg.inverse_problem.baseinvproblem","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"BaseInvProblem","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IBbffcwwLW"}],"urlSource":"xref:simpeg#simpeg.inverse_problem.BaseInvProblem","internal":false,"protocol":"xref:sphinx","key":"tvN0jTkeWS"},{"type":"text","value":" class to fully define the inverse problem that is solved at each beta (trade-off parameter) iteration. The inverse problem requires appropriate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nNOwGjP6p4"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"data misfit","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FW28cEoJPo"}],"key":"yEAbxzB83i"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d4Cf5U5vID"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"regularization","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lAXH0CCPEP"}],"key":"qvqx5DhbrQ"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gtc00Xn2Tj"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"optimization","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FNtcCFOaUE"}],"key":"wGvB8ERiUV"},{"type":"text","value":" objects.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lfYfCrrnS5"}],"key":"KTFteWCPYj"}],"key":"hzKlG3p3cY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.099593Z","iopub.status.busy":"2025-05-23T17:19:40.099249Z","iopub.status.idle":"2025-05-23T17:19:40.103016Z","shell.execute_reply":"2025-05-23T17:19:40.102227Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"inv_prob_L2 = inverse_problem.BaseInvProblem(dmis_L2, reg_L2, opt_L2)","key":"t4q318RF07"},{"type":"output","id":"K1d1W8w__Tq0qtyf8QsKS","data":[],"key":"Gcx76B04H1"}],"key":"NTEVASqO4D"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion Directives","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UUVeW0eU6r"}],"identifier":"inversion-directives","label":"Inversion Directives","html_id":"inversion-directives","implicit":true,"key":"P0F8mxJ5lA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To understand the role of directives in the inversion, please visit this online resource. Here, we apply common directives for weighted least-squares inversion of gravity data and describe their roles. These are:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M6nk1ejTca"}],"key":"qlSDkVswJx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdatePreconditioner.html#simpeg.directives.updatepreconditioner","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"UpdatePreconditioner","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B3OX1VxxJY"}],"urlSource":"xref:simpeg#simpeg.directives.UpdatePreconditioner","internal":false,"protocol":"xref:sphinx","key":"jUwh4LriTw"},{"type":"text","value":": Apply Jacobi preconditioner when solving optimization problem to reduce the number of conjugate gradient iterations. We set ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"laXyRblLSn"},{"type":"inlineCode","value":"update_every_iteration=True","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"K5ZoUmhWH6"},{"type":"text","value":" because the ideal preconditioner is model-dependent.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mT4k9pdh88"}],"key":"zlQYJGfIe9"}],"key":"JdysgJIrl2"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.BetaEstimate_ByEig.html#simpeg.directives.betaestimate_byeig","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"BetaEstimate_ByEig","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"pdyfOWbOeC"}],"urlSource":"xref:simpeg#simpeg.directives.BetaEstimate_ByEig","internal":false,"protocol":"xref:sphinx","key":"DS6Ux5n9p9"},{"type":"text","value":": Compute and set starting trade-off parameter (beta) based on largest eigenvalues.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"e23WDJ2yKK"}],"key":"sMo6ElZcR6"}],"key":"tF0aONERbA"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.BetaSchedule.html#simpeg.directives.betaschedule","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"BetaSchedule","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"PkNNZ87mnO"}],"urlSource":"xref:simpeg#simpeg.directives.BetaSchedule","internal":false,"protocol":"xref:sphinx","key":"viOJyvoRBk"},{"type":"text","value":": Size reduction of the trade-off parameter at every beta iteration, and the number of Gauss-Newton iterations for each beta. In general, a ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ao9pWiF8pJ"},{"type":"inlineCode","value":"coolingFactor","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"k0ZoOeDDm9"},{"type":"text","value":" between 1.5 and 2.5, and ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rocfj7hiwl"},{"type":"inlineCode","value":"coolingRate","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EJOnot5Hkw"},{"type":"text","value":" of 3 works well for FDEM inversion. Cooling beta too quickly will result in portions of the model getting trapped in local minima. And we will not be finding the solution that minimizes the optimization problem if the cooling rate is too small.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"o00y34YGdw"}],"key":"nKB8fs3Dml"}],"key":"MkW8JCcCKZ"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.TargetMisfit.html#simpeg.directives.targetmisfit","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"TargetMisfit","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"IhoK1xSTW4"}],"urlSource":"xref:simpeg#simpeg.directives.TargetMisfit","internal":false,"protocol":"xref:sphinx","key":"cJ91y7WXLJ"},{"type":"text","value":": Terminates the inversion when the data misfit equals the target misfit. A ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rQrV390ULI"},{"type":"inlineCode","value":"chifact=1","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"JQngT4f3Tq"},{"type":"text","value":" terminates the inversion when the data misfit equals the number of data.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MTsaGAZszc"}],"key":"sjAfawbK1M"}],"key":"vGv8vTeqKn"}],"key":"isr3F1ehfG"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"The directive objects are organized in a ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"zBGlXovXzp"},{"type":"inlineCode","value":"list","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"dd84uyyEgp"},{"type":"text","value":". Upon starting the inversion or updating the recovered model at each iteration, the inversion will call each directive within the list ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"jsdO72bhFS"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"in order","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"GGwKqgEh1O"}],"key":"rMx1hTvlDV"},{"type":"text","value":". The order of the directives matters, and SimPEG will throw an error if directives are organized into an improper order. Some directives, like the ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ppXVJXj828"},{"type":"inlineCode","value":"BetaEstimate_ByEig","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CUoswPzGjK"},{"type":"text","value":" are only used when starting the inversion. Other directives, like ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"LeSf6w5U93"},{"type":"inlineCode","value":"UpdatePreconditionner","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"E1B92FcpiA"},{"type":"text","value":", are used whenever the model is updated.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"A3X7pwEO6s"}],"key":"P9Ri61tscB"}],"key":"ZCgTjVOgS0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.106049Z","iopub.status.busy":"2025-05-23T17:19:40.105744Z","iopub.status.idle":"2025-05-23T17:19:40.111175Z","shell.execute_reply":"2025-05-23T17:19:40.110351Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"update_jacobi = directives.UpdatePreconditioner(update_every_iteration=True)\nstarting_beta = directives.BetaEstimate_ByEig(beta0_ratio=5)\nbeta_schedule = directives.BetaSchedule(coolingFactor=2.0, coolingRate=3)\ntarget_misfit = directives.TargetMisfit(chifact=1.0)\n\ndirectives_list_L2 = [update_jacobi, starting_beta, beta_schedule, target_misfit]","key":"seTwNyWfnr"},{"type":"output","id":"VE0H6xNw3whGYDUlLgzdp","data":[],"key":"msqlmparJw"}],"key":"erkTPATtVh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define and Run the Inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cFGl4CzIbh"}],"identifier":"define-and-run-the-inversion","label":"Define and Run the Inversion","html_id":"define-and-run-the-inversion","implicit":true,"key":"hH5ddQuWzO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We define the inversion using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Nkmp2LYLOu"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.inversion.BaseInversion.html#simpeg.inversion.baseinversion","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"BaseInversion","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ztltHYUDCx"}],"urlSource":"xref:simpeg#simpeg.inversion.BaseInversion","internal":false,"protocol":"xref:sphinx","key":"zwgWcBrQD0"},{"type":"text","value":" class. The inversion class must be instantiated with an appropriate ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q501tcXaOV"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"inverse problem","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y27teUUr2p"}],"key":"FVulZj4xlH"},{"type":"text","value":" object and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lO2hr0bjAl"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"directives list","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vn0pHIWKR6"}],"key":"og2oMgWwMM"},{"type":"text","value":". The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qkFE3ItAJF"},{"type":"inlineCode","value":"run","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JBI2YoUHwu"},{"type":"text","value":" method, along with a starting model, is respondible for running the inversion. The output is a 1D numpy.ndarray containing the recovered model parameters","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a3hOu5aW8C"}],"key":"P1MDaDocv0"}],"key":"a9eGuHSkax"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:40.114157Z","iopub.status.busy":"2025-05-23T17:19:40.113784Z","iopub.status.idle":"2025-05-23T17:19:42.051135Z","shell.execute_reply":"2025-05-23T17:19:42.050461Z"},"scrolled":false},"children":[{"type":"code","lang":"python","executable":true,"value":"# Here we combine the inverse problem and the set of directives\ninv_L2 = inversion.BaseInversion(inv_prob_L2, directives_list_L2)\n\n# Run the inversion\nrecovered_model_L2 = inv_L2.run(starting_conductivity_model)","key":"YiKY7BmFbW"},{"type":"output","id":"6TsndKUDjBy2VRJ-Lrrku","data":[{"name":"stdout","output_type":"stream","text":"\nRunning inversion with SimPEG v0.24.0\n\n                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.\n                    ***Done using the default solver Pardiso and no solver_opts.***\n                    \nmodel has any nan: 0\n============================ Inexact Gauss Newton ============================\n  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   \n-----------------------------------------------------------------------------\nx0 has any nan: 0\n"},{"name":"stdout","output_type":"stream","text":"   0  1.23e+00  2.86e+02  0.00e+00  2.86e+02    5.81e+01      0              \n"},{"name":"stdout","output_type":"stream","text":"   1  1.23e+00  1.03e+02  4.36e+01  1.57e+02    2.14e+01      0              \n   2  1.23e+00  6.81e+01  5.98e+01  1.41e+02    9.04e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   3  6.14e-01  5.82e+01  6.56e+01  9.84e+01    2.21e+01      0   Skip BFGS  \n   4  6.14e-01  2.49e+01  9.96e+01  8.60e+01    4.76e+00      0              \n"},{"name":"stdout","output_type":"stream","text":"   5  6.14e-01  2.21e+01  1.02e+02  8.49e+01    2.30e+00      0   Skip BFGS  \n   6  3.07e-01  2.13e+01  1.03e+02  5.30e+01    1.30e+01      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   7  3.07e-01  1.10e+01  1.25e+02  4.95e+01    1.34e+00      0              \n   8  3.07e-01  1.06e+01  1.26e+02  4.93e+01    5.09e-01      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   9  1.53e-01  1.06e+01  1.26e+02  2.99e+01    6.96e+00      0   Skip BFGS  \n------------------------- STOP! -------------------------\n1 : |fc-fOld| = 0.0000e+00 \u003c= tolF*(1+|f0|) = 2.8679e+01\n1 : |xc-x_last| = 4.6904e-01 \u003c= tolX*(1+|x0|) = 1.5563e+00\n0 : |proj(x-g)-x|    = 6.9584e+00 \u003c= tolG          = 1.0000e-01\n0 : |proj(x-g)-x|    = 6.9584e+00 \u003c= 1e3*eps       = 1.0000e-02\n0 : maxIter   =     100    \u003c= iter          =     10\n------------------------- DONE! -------------------------\n"}],"key":"pGgy3RN4qj"}],"key":"Hd0Kz2kPJU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inversion Outputs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IN8QC6YWVt"}],"identifier":"inversion-outputs","label":"Inversion Outputs","html_id":"inversion-outputs","implicit":true,"key":"WcYpOWigX3"}],"key":"yIewXteqks"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Misfit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jtBDGIeRp1"}],"identifier":"data-misfit","label":"Data Misfit","html_id":"data-misfit-1","implicit":true,"key":"YgTI0qqcVW"}],"key":"f3REsKVawf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.054748Z","iopub.status.busy":"2025-05-23T17:19:42.054428Z","iopub.status.idle":"2025-05-23T17:19:42.696646Z","shell.execute_reply":"2025-05-23T17:19:42.695226Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dpred_L2 = simulation_L2.dpred(recovered_model_L2)\n\nfig = plt.figure(figsize=(10, 5))\nax = [fig.add_axes([0.1 + ii * 0.5, 0.1, 0.37, 0.85]) for ii in range(2)]\nfor ii in range(2):\n    ax[ii].loglog(frequencies, np.abs(dobs[ii::2]), \"k-o\", lw=2)\n    ax[ii].loglog(frequencies, np.abs(dpred_L2[ii::2]), \"b-o\", lw=2)\n    ax[ii].grid(which=\"both\")\n    ax[ii].set_xlabel(\"Frequency (Hz)\")\n    ax[ii].set_ylabel(\"|Hs/Hp| (ppm)\")\n    ax[ii].legend([\"Observed\", \"L2 Inversion\"])\n    if ii == 1:\n        ax[ii].set_ylabel(\"\")\n\nax[0].set_title(\"Real Component\")\nax[1].set_title(\"Imaginary Component\")\nplt.show()","key":"Vi8W2rY9n5"},{"type":"output","id":"nN7zjY9R_s7sJeqNJWc1w","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"655632233294c1641dcc2adf4fd42a71","path":"/user-tutorials/build/655632233294c1641dcc2adf4fd42a71.png"},"text/plain":{"content":"\u003cFigure size 1000x500 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"t9yjRr6VQA"}],"key":"NQ7AbILEHj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Recovered Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZOMkD5IcHc"}],"identifier":"recovered-model","label":"Recovered Model","html_id":"recovered-model","implicit":true,"key":"WwJuvJKHU2"}],"key":"fLkAsKjbo1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.699787Z","iopub.status.busy":"2025-05-23T17:19:42.699556Z","iopub.status.idle":"2025-05-23T17:19:42.702970Z","shell.execute_reply":"2025-05-23T17:19:42.702406Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# true conductivities and layer thicknesses\ntrue_conductivities = np.array([0.1, 1.0, 0.1])\ntrue_layers = np.r_[20.0, 40.0, 160.0]","key":"Zg7POw2RY1"},{"type":"output","id":"M4CO2Z8mDh4Nr9DgA3HRn","data":[],"key":"DjhrSeRLRS"}],"key":"lsyWxXsZdv"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.705915Z","iopub.status.busy":"2025-05-23T17:19:42.705631Z","iopub.status.idle":"2025-05-23T17:19:42.921152Z","shell.execute_reply":"2025-05-23T17:19:42.920519Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot true model and recovered model\nfig = plt.figure(figsize=(6, 6))\n\nax1 = fig.add_axes([0.2, 0.15, 0.7, 0.7])\nplot_1d_layer_model(true_layers, true_conductivities, ax=ax1, color=\"k\")\nplot_1d_layer_model(\n    layer_thicknesses, log_conductivity_map * recovered_model_L2, ax=ax1, color=\"b\"\n)\nax1.grid()\nax1.set_xlabel(r\"Resistivity ($\\Omega m$)\")\nx_min, x_max = true_conductivities.min(), true_conductivities.max()\nax1.set_xlim(0.9 * x_min, 1.5 * x_max)\nax1.legend([\"True Model\", \"L2-Model\"])\nplt.show()","key":"Mu4esQ2wlj"},{"type":"output","id":"LbDI3lYpLyIK8KEI7W3KV","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9d3fe4941ff9281b5d397c44c274e034","path":"/user-tutorials/build/9d3fe4941ff9281b5d397c44c274e034.png"},"text/plain":{"content":"\u003cFigure size 600x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"KlkC1mzrvK"}],"key":"NQv2JtNurw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Iteratively Re-weighted Least-Squares Inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t6qKnDw6JI"}],"identifier":"iteratively-re-weighted-least-squares-inversion","label":"Iteratively Re-weighted Least-Squares Inversion","html_id":"iteratively-re-weighted-least-squares-inversion","implicit":true,"key":"AYpMIYyvA2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we use the iteratively reweighted least-squares (IRLS) inversion approach to recover sparse and/or blocky models on the set layers.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SnSe0iDwyW"}],"key":"bc1EUuI6co"}],"key":"i279xVGjXw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Forward Simulation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NRUAnJ2NPp"}],"identifier":"define-the-forward-simulation","label":"Define the Forward Simulation","html_id":"define-the-forward-simulation-1","implicit":true,"key":"fv3MqoI8ah"}],"key":"A93kckD8u3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.924396Z","iopub.status.busy":"2025-05-23T17:19:42.924149Z","iopub.status.idle":"2025-05-23T17:19:42.927780Z","shell.execute_reply":"2025-05-23T17:19:42.927253Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation_irls = fdem.simulation_1d.Simulation1DLayered(\n    survey=survey,\n    sigmaMap=log_conductivity_map,\n    thicknesses=layer_thicknesses,\n)","key":"TdR6P5o9rK"},{"type":"output","id":"W5TRRykyV34nF4dMhY7cx","data":[],"key":"bIoIMUOMhx"}],"key":"SteeRmLuLf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Data Misfit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wrn65Q4CXj"}],"identifier":"define-the-data-misfit","label":"Define the Data Misfit","html_id":"define-the-data-misfit","implicit":true,"key":"nvePamllFn"}],"key":"n0lwqqcILF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.930920Z","iopub.status.busy":"2025-05-23T17:19:42.930707Z","iopub.status.idle":"2025-05-23T17:19:42.933871Z","shell.execute_reply":"2025-05-23T17:19:42.933277Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dmis_irls = data_misfit.L2DataMisfit(simulation=simulation_irls, data=data_object)","key":"usVb5Na6uw"},{"type":"output","id":"Uo8csNtwkekwBCE-su2x7","data":[],"key":"RTxlkdCLgh"}],"key":"PQKbrl8WYe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Regularization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bLK6wmiFLi"}],"identifier":"regularization","label":"Regularization","html_id":"regularization-1","implicit":true,"key":"PUzVzNkEL1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BIRyDDxrOb"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.regularization.Sparse.html#simpeg.regularization.sparse","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Sparse","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ThaQCsi79Q"}],"urlSource":"xref:simpeg#simpeg.regularization.Sparse","internal":false,"protocol":"xref:sphinx","key":"NEYMgPpJqm"},{"type":"text","value":" regularization class to constrain the inversion result using an IRLS approach. Here, the scaling constants that balance the smallness and smoothness terms are set directly. Equal emphasis on smallness and smoothness is generally applied by using the inverse square of the smallest cell dimension. The reference model is only applied to the smallness term; which is redundant for the tutorial example since we have set the reference model to an array of zeros. Here, we apply a 1-norm to the smallness term and a 1-norm to first-order smoothness along the x (vertical direction).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DsdEjvSl1a"}],"key":"zkMRcCYNuR"}],"key":"Jz9qwviqQa"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.936014Z","iopub.status.busy":"2025-05-23T17:19:42.935761Z","iopub.status.idle":"2025-05-23T17:19:42.941702Z","shell.execute_reply":"2025-05-23T17:19:42.941134Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"reg_irls = regularization.Sparse(\n    regularization_mesh,\n    alpha_s=0.01,\n    alpha_x=1,\n    reference_model_in_smooth=False,\n    norms=[1.0, 1.0],\n)","key":"xjuzq7hJwK"},{"type":"output","id":"-EUm5r5Box5EuL8PCNA5D","data":[],"key":"q37zTJ15MF"}],"key":"f8xomTEe7n"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Optimization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OEnMR30TuG"}],"identifier":"optimization","label":"Optimization","html_id":"optimization-1","implicit":true,"key":"Uie5pzp0yv"}],"key":"ipPhSvtZwu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.944094Z","iopub.status.busy":"2025-05-23T17:19:42.943809Z","iopub.status.idle":"2025-05-23T17:19:42.947546Z","shell.execute_reply":"2025-05-23T17:19:42.946984Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"opt_irls = optimization.InexactGaussNewton(\n    maxIter=100, maxIterLS=20, maxIterCG=30, tolCG=1e-3\n)","key":"oAukIejkV9"},{"type":"output","id":"bzi3Pw8z9kb9l3bTooUL5","data":[],"key":"Q5aybATI6r"}],"key":"m2hSKPIm95"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inverse Problem","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YpXMybL142"}],"identifier":"inverse-problem","label":"Inverse Problem","html_id":"inverse-problem-1","implicit":true,"key":"r0Xseqk0lw"}],"key":"BWrOA22SQk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.950421Z","iopub.status.busy":"2025-05-23T17:19:42.950149Z","iopub.status.idle":"2025-05-23T17:19:42.953944Z","shell.execute_reply":"2025-05-23T17:19:42.953372Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"inv_prob_irls = inverse_problem.BaseInvProblem(dmis_irls, reg_irls, opt_irls)","key":"ve0TRWA133"},{"type":"output","id":"lRX87WO1MIRNlPCEd9aAe","data":[],"key":"gsDRN7JtOS"}],"key":"JwZEHRO01I"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Directives","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vawP63LcWY"}],"identifier":"directives","label":"Directives","html_id":"directives","implicit":true,"key":"G1XmQ6B4MF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we create common directives for IRLS inversion of total magnetic intensity data and describe their roles. In additon to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eJhhR70fkV"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdateSensitivityWeights.html#simpeg.directives.updatesensitivityweights","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"UpdateSensitivityWeights","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gfmU0fAQ4S"}],"urlSource":"xref:simpeg#simpeg.directives.UpdateSensitivityWeights","internal":false,"protocol":"xref:sphinx","key":"XeZPVnAmsT"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ylQN0ba2iG"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdatePreconditioner.html#simpeg.directives.updatepreconditioner","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"UpdatePreconditioner","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DxXQBdRsgZ"}],"urlSource":"xref:simpeg#simpeg.directives.UpdatePreconditioner","internal":false,"protocol":"xref:sphinx","key":"ABXFt2lzrs"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ouKR9RbFIt"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.BetaEstimate_ByEig.html#simpeg.directives.betaestimate_byeig","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"BetaEstimate_ByEig","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u2xuNm0Nhj"}],"urlSource":"xref:simpeg#simpeg.directives.BetaEstimate_ByEig","internal":false,"protocol":"xref:sphinx","key":"Vqkh4QdnWt"},{"type":"text","value":"  (described before), inversion with sparse-norms requires the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BWFmEihsa6"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdateIRLS.html#simpeg.directives.updateirls","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"UpdateIRLS","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r1t8vVxFW0"}],"urlSource":"xref:simpeg#simpeg.directives.UpdateIRLS","internal":false,"protocol":"xref:sphinx","key":"EmBgnFmbJY"},{"type":"text","value":" directive.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QwUUHnwhJA"}],"key":"ndKjmQ9cbk"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"You will notice that we don’t use the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sEalU9RNvZ"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.BetaSchedule.html#simpeg.directives.betaschedule","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"BetaSchedule","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tDgVTkF2sc"}],"urlSource":"xref:simpeg#simpeg.directives.BetaSchedule","internal":false,"protocol":"xref:sphinx","key":"q3E75P1Zxa"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IFDIfWwoDz"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.TargetMisfit.html#simpeg.directives.targetmisfit","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"TargetMisfit","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KXbnbUxqEA"}],"urlSource":"xref:simpeg#simpeg.directives.TargetMisfit","internal":false,"protocol":"xref:sphinx","key":"qa3GWeAGHm"},{"type":"text","value":" directives. Here, the beta cooling schedule is set in the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TfRNV2IKC1"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.directives.UpdateIRLS.html#simpeg.directives.updateirls","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"UpdateIRLS","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XRXLFuI1GY"}],"urlSource":"xref:simpeg#simpeg.directives.UpdateIRLS","internal":false,"protocol":"xref:sphinx","key":"IYtjfSbzMo"},{"type":"text","value":" directive using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SPMyJuwTUY"},{"type":"inlineCode","value":"coolingFactor","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HRM6OMEH4k"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"v79T1GZ30H"},{"type":"inlineCode","value":"coolingRate","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zfLKgoyhB7"},{"type":"text","value":" properties. The target misfit for the L2 portion of the IRLS approach is set with the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XkGgdXdc0d"},{"type":"inlineCode","value":"chifact_start","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WMmznix45G"},{"type":"text","value":" property.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MUGjsYILAi"}],"key":"vvKn75MNdO"}],"key":"jSpZxkz5TN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.956769Z","iopub.status.busy":"2025-05-23T17:19:42.956494Z","iopub.status.idle":"2025-05-23T17:19:42.961301Z","shell.execute_reply":"2025-05-23T17:19:42.960673Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"starting_beta_irls = directives.BetaEstimate_ByEig(beta0_ratio=5)\nupdate_jacobi_irls = directives.UpdatePreconditioner(update_every_iteration=True)\nupdate_irls = directives.UpdateIRLS(\n    cooling_factor=2,\n    cooling_rate=3,\n    f_min_change=1e-4,\n    max_irls_iterations=30,\n    chifact_start=1.0,\n)\n\ndirectives_list_irls = [update_irls, starting_beta_irls, update_jacobi_irls]","key":"SqdYq3vbG7"},{"type":"output","id":"TXZSBckPuZCGxADS9miJ3","data":[],"key":"IbENInrlHl"}],"key":"ybi95RyXmF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define and Run the Inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AkforJoOYQ"}],"identifier":"define-and-run-the-inversion","label":"Define and Run the Inversion","html_id":"define-and-run-the-inversion-1","implicit":true,"key":"rHahugmdme"}],"key":"iUEnvSpdse"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:42.964124Z","iopub.status.busy":"2025-05-23T17:19:42.963827Z","iopub.status.idle":"2025-05-23T17:19:50.871262Z","shell.execute_reply":"2025-05-23T17:19:50.870552Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Here we combine the inverse problem and the set of directives\ninv_irls = inversion.BaseInversion(inv_prob_irls, directives_list_irls)\n\n# Run the inversion\nrecovered_model_irls = inv_irls.run(starting_conductivity_model)","key":"zbeAFgbEo1"},{"type":"output","id":"-dIzbND9HbvtkxUGSdpVy","data":[{"name":"stdout","output_type":"stream","text":"\nRunning inversion with SimPEG v0.24.0\nsimpeg.InvProblem will set Regularization.reference_model to m0.\nsimpeg.InvProblem will set Regularization.reference_model to m0.\n\n                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.\n                    ***Done using the default solver Pardiso and no solver_opts.***\n                    \nmodel has any nan: 0\n============================ Inexact Gauss Newton ============================\n  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   \n-----------------------------------------------------------------------------\nx0 has any nan: 0\n   0  3.27e+01  2.86e+02  0.00e+00  2.86e+02    5.81e+01      0              \n"},{"name":"stdout","output_type":"stream","text":"   1  3.27e+01  3.07e+01  1.62e+00  8.36e+01    2.22e+01      0              \n   2  3.27e+01  1.81e+01  1.40e+00  6.38e+01    5.61e+00      0              \n"},{"name":"stdout","output_type":"stream","text":"   3  1.63e+01  1.48e+01  1.47e+00  3.89e+01    9.32e+00      0   Skip BFGS  \nReached starting chifact with l2-norm regularization: Start IRLS steps...\nirls_threshold 2.5064368466543883\n   4  1.63e+01  8.25e+00  1.93e+00  3.98e+01    1.64e+00      0              \n"},{"name":"stdout","output_type":"stream","text":"   5  1.63e+01  8.72e+00  1.87e+00  3.93e+01    6.67e-01      0              \n   6  2.04e+01  8.52e+00  1.88e+00  4.69e+01    2.49e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   7  2.04e+01  9.94e+00  1.87e+00  4.81e+01    6.15e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"   8  2.04e+01  1.03e+01  1.85e+00  4.80e+01    1.90e-01      0              \n   9  2.55e+01  1.02e+01  1.85e+00  5.74e+01    3.22e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  10  2.55e+01  1.23e+01  1.80e+00  5.82e+01    6.03e-01      0              \n  11  2.55e+01  1.27e+01  1.79e+00  5.82e+01    1.22e-01      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  12  1.56e+01  1.26e+01  1.79e+00  4.06e+01    6.30e+00      0   Skip BFGS  \n  13  1.56e+01  8.70e+00  2.03e+00  4.05e+01    7.25e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  14  1.56e+01  8.81e+00  2.02e+00  4.04e+01    2.45e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  15  1.92e+01  8.76e+00  2.03e+00  4.77e+01    2.43e+00      0   Skip BFGS  \n  16  1.92e+01  1.01e+01  2.01e+00  4.86e+01    6.82e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  17  1.92e+01  1.04e+01  1.99e+00  4.86e+01    1.73e-01      0              \n  18  2.36e+01  1.04e+01  1.99e+00  5.74e+01    3.04e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  19  2.36e+01  1.22e+01  1.95e+00  5.82e+01    7.76e-01      0              \n  20  2.36e+01  1.26e+01  1.93e+00  5.82e+01    1.61e-01      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  21  1.45e+01  1.26e+01  1.93e+00  4.06e+01    6.34e+00      0   Skip BFGS  \n  22  1.45e+01  8.85e+00  2.17e+00  4.03e+01    7.82e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  23  1.45e+01  8.92e+00  2.16e+00  4.03e+01    1.93e-01      0              \n  24  1.77e+01  8.89e+00  2.16e+00  4.72e+01    2.33e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  25  1.77e+01  1.01e+01  2.14e+00  4.80e+01    7.84e-01      0              \n  26  1.77e+01  1.04e+01  2.12e+00  4.79e+01    1.69e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  27  2.16e+01  1.04e+01  2.12e+00  5.62e+01    2.87e+00      0   Skip BFGS  \n  28  2.16e+01  1.20e+01  2.08e+00  5.69e+01    8.86e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  29  2.16e+01  1.24e+01  2.06e+00  5.68e+01    1.61e-01      0              \n  30  1.34e+01  1.23e+01  2.06e+00  3.99e+01    6.14e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  31  1.34e+01  8.99e+00  2.28e+00  3.94e+01    7.83e-01      0              \n  32  1.34e+01  9.00e+00  2.27e+00  3.94e+01    1.23e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  33  1.62e+01  8.98e+00  2.28e+00  4.59e+01    2.22e+00      0   Skip BFGS  \n  34  1.62e+01  1.00e+01  2.25e+00  4.65e+01    7.95e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  35  1.62e+01  1.03e+01  2.23e+00  4.64e+01    1.26e-01      0              \n  36  1.97e+01  1.03e+01  2.23e+00  5.42e+01    2.70e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  37  1.97e+01  1.17e+01  2.18e+00  5.47e+01    9.16e-01      0              \n  38  1.97e+01  1.20e+01  2.17e+00  5.47e+01    1.28e-01      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  39  1.23e+01  1.20e+01  2.17e+00  3.87e+01    5.80e+00      0   Skip BFGS  \n  40  1.23e+01  9.06e+00  2.37e+00  3.82e+01    7.66e-01      0              \n"},{"name":"stdout","output_type":"stream","text":"  41  1.23e+01  9.01e+00  2.37e+00  3.82e+01    7.88e-02      0              \n------------------------- STOP! -------------------------\n1 : |fc-fOld| = 2.0111e-02 \u003c= tolF*(1+|f0|) = 2.8679e+01\n1 : |xc-x_last| = 7.9559e-02 \u003c= tolX*(1+|x0|) = 1.5563e+00\n1 : |proj(x-g)-x|    = 7.8837e-02 \u003c= tolG          = 1.0000e-01\n0 : |proj(x-g)-x|    = 7.8837e-02 \u003c= 1e3*eps       = 1.0000e-02\n0 : maxIter   =     100    \u003c= iter          =     41\n------------------------- DONE! -------------------------\n"}],"key":"mvO7ancFgA"}],"key":"vaOKyc0GzJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Misfit and Recovered Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kBXIsY8raE"}],"identifier":"data-misfit-and-recovered-model","label":"Data Misfit and Recovered Model","html_id":"data-misfit-and-recovered-model","implicit":true,"key":"CYzDBRAgmg"}],"key":"wmFQeXWXZc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:50.874607Z","iopub.status.busy":"2025-05-23T17:19:50.874373Z","iopub.status.idle":"2025-05-23T17:19:51.532756Z","shell.execute_reply":"2025-05-23T17:19:51.532075Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dpred_irls = simulation_irls.dpred(recovered_model_irls)\n\nfig = plt.figure(figsize=(10, 5))\nax = [fig.add_axes([0.1 + ii * 0.5, 0.1, 0.37, 0.85]) for ii in range(2)]\nfor ii in range(2):\n    ax[ii].loglog(frequencies, np.abs(dobs[ii::2]), \"k-o\", lw=2)\n    ax[ii].loglog(frequencies, np.abs(dpred_L2[ii::2]), \"b-o\", lw=2)\n    ax[ii].loglog(frequencies, np.abs(dpred_irls[ii::2]), \"r-o\", lw=2)\n    ax[ii].grid(which=\"both\")\n    ax[ii].set_xlabel(\"Frequency (Hz)\")\n    ax[ii].set_ylabel(\"|Hs/Hp| (ppm)\")\n    ax[ii].legend([\"True Sounding\", \"Predicted (L2-model)\", \"Predicted (IRLS)\"])\n    if ii == 1:\n        ax[ii].set_ylabel(\"\")\n\nax[0].set_title(\"Real Component\")\nax[1].set_title(\"Imaginary Component\")\nplt.show()","key":"Y4X0NDURM8"},{"type":"output","id":"vYe_2BQ-QHwLhhypT_DgM","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9d5b753d7a3da90ebc0dbed34119b857","path":"/user-tutorials/build/9d5b753d7a3da90ebc0dbed34119b857.png"},"text/plain":{"content":"\u003cFigure size 1000x500 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"F1hPbvzCi7"}],"key":"NEb8D5xaMQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.535915Z","iopub.status.busy":"2025-05-23T17:19:51.535686Z","iopub.status.idle":"2025-05-23T17:19:51.759428Z","shell.execute_reply":"2025-05-23T17:19:51.758789Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Plot true model and recovered model\nfig = plt.figure(figsize=(6, 6))\n\nax1 = fig.add_axes([0.2, 0.15, 0.7, 0.7])\nplot_1d_layer_model(true_layers, true_conductivities, ax=ax1, color=\"k\")\nplot_1d_layer_model(\n    layer_thicknesses, log_conductivity_map * recovered_model_L2, ax=ax1, color=\"b\"\n)\nplot_1d_layer_model(\n    layer_thicknesses, log_conductivity_map * recovered_model_irls, ax=ax1, color=\"r\"\n)\nax1.grid()\nax1.set_xlabel(r\"Conductivity ($S/m$)\")\nx_min, x_max = true_conductivities.min(), true_conductivities.max()\nax1.set_xlim(0.8 * x_min, 2 * x_max)\nax1.legend([\"True Model\", \"L2 Model\", \"IRLS Model\"])\nplt.show()","key":"g8yZW0c0ht"},{"type":"output","id":"bNcPLaxQ1MznqdUrEmemG","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"88f5dac6671bcb95fe22d58aed7c2e13","path":"/user-tutorials/build/88f5dac6671bcb95fe22d58aed7c2e13.png"},"text/plain":{"content":"\u003cFigure size 600x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"RAXX1eigFX"}],"key":"ZDURFZjiFD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Parametric Inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OjWsDPLCur"}],"identifier":"parametric-inversion","label":"Parametric Inversion","html_id":"parametric-inversion","implicit":true,"key":"dBC0j9zYDq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we assume the subsurface is defined by a 3-layered Earth. However, the electrical properties and thicknesses of the layers are unknown. Here, we define our model to include log-conductivities and log-thicknesses. When including quantities that span different scales, it is frequently best to define the model in terms of log values so that each quantity influences the predicted data evenly.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aF0TYPpWhR"}],"key":"Mn7nlucVm0"}],"key":"gIvdSCklTy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Model and Mapping","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Glkb0FiN1u"}],"identifier":"model-and-mapping","label":"Model and Mapping","html_id":"model-and-mapping","implicit":true,"key":"OxIf0HIjIO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For a 3-layered Earth model, the model consists of 2 log-thicknesses and 3 log-conductivities. Similar to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZUIjXoxEcu"},{"type":"link","url":"/fwd-fdem-1d","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"idwVWYfme6"}],"urlSource":"fwd_fdem_1d.ipynb","dataUrl":"/fwd-fdem-1d.json","internal":true,"protocol":"file","key":"sZECCcDKAN"},{"type":"text","value":" tutorial, need a mapping that extract log-thicknesses and log-resistivities from the model, and mappings that convert log-values to property values. For this, we require the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"amMVJ6clCY"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.Wires.html#simpeg.maps.wires","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simpeg.maps.Wires","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K4WcjlUvc1"}],"urlSource":"xref:simpeg#simpeg.maps.Wires","internal":false,"protocol":"xref:sphinx","key":"fZZ8k1rGEt"},{"type":"text","value":" mapping and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qo6IMVH0BF"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.maps.ExpMap.html#simpeg.maps.expmap","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"simpeg.maps.ExpMap","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EI0t0pJ1mz"}],"urlSource":"xref:simpeg#simpeg.maps.ExpMap","internal":false,"protocol":"xref:sphinx","key":"z2lcCuczj9"},{"type":"text","value":" mapping classes. Note that successive mappings can be chained together using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DaeCPxDcD7"},{"type":"inlineMath","value":"*","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e*\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4653em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wEYeh0u0K4"},{"type":"text","value":" operator.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M6mWlbYNRE"}],"key":"V5Tg5DiPte"}],"key":"fEUwHaDZQQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.762776Z","iopub.status.busy":"2025-05-23T17:19:51.762465Z","iopub.status.idle":"2025-05-23T17:19:51.767133Z","shell.execute_reply":"2025-05-23T17:19:51.766628Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Wire maps to extract log-thicknesses and log-conductivities\nwire_map = maps.Wires((\"log_thicknesses\", 2), (\"log_resistivity\", 3))\n\n# Maping for layer thicknesses\nlog_thicknesses_map = maps.ExpMap() * wire_map.log_thicknesses\n\n# Mapping for conductivities\nlog_resistivity_map = maps.ExpMap() * wire_map.log_resistivity","key":"Kkzlbjnbor"},{"type":"output","id":"i8Z45EEgtDGxQDCRSjyF_","data":[],"key":"blns02POP4"}],"key":"jaP7Xm8LVE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Starting and Reference Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HZclmAOVy8"}],"identifier":"starting-and-reference-model","label":"Starting and Reference Model","html_id":"starting-and-reference-model","implicit":true,"key":"twej5Xvt04"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This problem is highly non-linear so it is important to have a reasonable estimate of the true model.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PJT042Jxy4"}],"key":"DZrWQNNxHN"}],"key":"pahPWrJ1Bo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.770346Z","iopub.status.busy":"2025-05-23T17:19:51.770063Z","iopub.status.idle":"2025-05-23T17:19:51.773167Z","shell.execute_reply":"2025-05-23T17:19:51.772678Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"starting_parametric_model = np.log(np.r_[30.0, 20.0, 20, 0.5, 5])\n\nreference_parametric_model = starting_parametric_model.copy()","key":"e5H8b4DHma"},{"type":"output","id":"Z2aaBWVt69rMyNN9VNPEu","data":[],"key":"Br3JvzoyYX"}],"key":"mCENa7HlnM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Forward Simulation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LJRQXRic6J"}],"identifier":"forward-simulation","label":"Forward Simulation","html_id":"forward-simulation","implicit":true,"key":"BPNYHOsBq6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Because the layer thicknesses are part of the model, we define the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OoIL3LxHRF"},{"type":"inlineCode","value":"thicknessesMap","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G0VWMaaZrz"},{"type":"text","value":". Because we are working in terms of electrical resistivity, we must define the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PdGX1MFQyi"},{"type":"inlineCode","value":"rhoMap","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Mu2XHrSAjT"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VjGpDYNJyv"}],"key":"X0njKu7X2n"}],"key":"MwiQytGRPE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.775616Z","iopub.status.busy":"2025-05-23T17:19:51.775336Z","iopub.status.idle":"2025-05-23T17:19:51.779471Z","shell.execute_reply":"2025-05-23T17:19:51.778796Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"simulation_parametric = fdem.simulation_1d.Simulation1DLayered(\n    survey=survey,\n    rhoMap=log_resistivity_map,\n    thicknessesMap=log_thicknesses_map,\n)","key":"KpiGTIFwwU"},{"type":"output","id":"49anflqo-PXf3NKVZ8Bbq","data":[],"key":"Vlwg4qzLzb"}],"key":"F70w7gzGYj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Misfit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"koKgfLMqZs"}],"identifier":"data-misfit","label":"Data Misfit","html_id":"data-misfit-2","implicit":true,"key":"NkcVe4IsQe"}],"key":"PKxebOlH9X"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.781797Z","iopub.status.busy":"2025-05-23T17:19:51.781527Z","iopub.status.idle":"2025-05-23T17:19:51.784937Z","shell.execute_reply":"2025-05-23T17:19:51.784355Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dmis_parametric = data_misfit.L2DataMisfit(\n    simulation=simulation_parametric, data=data_object\n)","key":"Shlj3qCz5w"},{"type":"output","id":"5wrM--WAWREk9NaZ16Wsc","data":[],"key":"yyqsPVGxnF"}],"key":"b8oKUCXION"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"(Combo) Regularization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TB1X8osV7f"}],"identifier":"id-combo-regularization","label":"(Combo) Regularization","html_id":"id-combo-regularization","implicit":true,"key":"FFqAMXlIJo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We need to define a regularization for each model parameter type. In this case, we have log-thicknesses and log-conductivities. For each model parameter type, we create a 1D ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ElsGfwLV0M"},{"type":"link","url":"https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.tensormesh","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"tensor mesh","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DcbwtBikUu"}],"urlSource":"xref:discretize#discretize.TensorMesh","internal":false,"protocol":"xref:sphinx","key":"tBaLiGFVJq"},{"type":"text","value":" with length equal to the number of parameters. In the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aNwwUN1gAt"},{"type":"inlineCode","value":"mapping","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YsxQpKr7bV"},{"type":"text","value":" keyword argument, we used the wire map that extracts the specific model parameters from the model.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lAxUS0As5Y"}],"key":"qitz8PCeQI"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GP7j5Ra8T4"},{"type":"inlineMath","value":"*","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo\u003e∗\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e*\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4653em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∗\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"TAHZHr6For"},{"type":"text","value":" operator, separate regularizations can be summed to form a regularization that is also a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ObJkLE47uc"},{"type":"link","url":"https://docs.simpeg.xyz/latest/content/api/generated/simpeg.objective_function.ComboObjectiveFunction.html#simpeg.objective_function.comboobjectivefunction","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"ComboObjectiveFunction","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"czTf3VQTQS"}],"urlSource":"xref:simpeg#simpeg.objective_function.ComboObjectiveFunction","internal":false,"protocol":"xref:sphinx","key":"A3wsZZyl6B"},{"type":"text","value":". By setting the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"otl63h689q"},{"type":"inlineCode","value":"multipliers","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"i3uFlM5mfJ"},{"type":"text","value":" property, we can emphasize the relative contributions of the log-thicknesses and log-conductivities regularizations.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"feOy6QZvHW"}],"key":"IuM61eoRZs"}],"key":"OH9eadATrg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.787720Z","iopub.status.busy":"2025-05-23T17:19:51.787452Z","iopub.status.idle":"2025-05-23T17:19:51.792517Z","shell.execute_reply":"2025-05-23T17:19:51.791904Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"reg_1 = regularization.Smallness(\n    TensorMesh([(np.ones(2))], \"0\"),\n    mapping=wire_map.log_thicknesses,\n    reference_model=reference_parametric_model,\n)\n\nreg_2 = regularization.Smallness(\n    TensorMesh([(np.ones(3))], \"0\"),\n    mapping=wire_map.log_resistivity,\n    reference_model=reference_parametric_model,\n)\n\nreg_parametric = reg_1 + reg_2\nreg_parametric.multipliers = [1.0, 0.1]","key":"aYop6KRWvN"},{"type":"output","id":"9IHgxeeQsCQmXxjfeXs2b","data":[],"key":"EmuGuTVws0"}],"key":"q0qqc0bvfp"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Optimization","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O2spM35rTU"}],"identifier":"optimization","label":"Optimization","html_id":"optimization-2","implicit":true,"key":"OMI0X07Awc"}],"key":"mj6XQclz97"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.795352Z","iopub.status.busy":"2025-05-23T17:19:51.795093Z","iopub.status.idle":"2025-05-23T17:19:51.798770Z","shell.execute_reply":"2025-05-23T17:19:51.798176Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"opt_parametric = optimization.InexactGaussNewton(\n    maxIter=100, maxIterLS=20, maxIterCG=20, tolCG=1e-3\n)","key":"b5ztEfspNz"},{"type":"output","id":"mxgXpzwTavfEVYN4uLD82","data":[],"key":"BxxIGxL48U"}],"key":"z2q6SkQ0HA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inverse Problem","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NJ8kIzmD0c"}],"identifier":"inverse-problem","label":"Inverse Problem","html_id":"inverse-problem-2","implicit":true,"key":"zlHw89kI4K"}],"key":"McAdE1Pt5t"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.801706Z","iopub.status.busy":"2025-05-23T17:19:51.801445Z","iopub.status.idle":"2025-05-23T17:19:51.805532Z","shell.execute_reply":"2025-05-23T17:19:51.804701Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"inv_prob_parametric = inverse_problem.BaseInvProblem(\n    dmis_parametric, reg_parametric, opt_parametric\n)","key":"kVYt3PcGBt"},{"type":"output","id":"58JZq7NA8FA-86B-QxA4p","data":[],"key":"jEw2kAlVer"}],"key":"mFC8dLjKmt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Directives","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OGI80wKIl7"}],"identifier":"directives","label":"Directives","html_id":"directives-1","implicit":true,"key":"fzTxhMZwVO"}],"key":"YPUgbGaos0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.808453Z","iopub.status.busy":"2025-05-23T17:19:51.808140Z","iopub.status.idle":"2025-05-23T17:19:51.813522Z","shell.execute_reply":"2025-05-23T17:19:51.812716Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"update_jacobi = directives.UpdatePreconditioner(update_every_iteration=True)\nstarting_beta = directives.BetaEstimate_ByEig(beta0_ratio=5)\nbeta_schedule = directives.BetaSchedule(coolingFactor=2.0, coolingRate=3)\ntarget_misfit = directives.TargetMisfit(chifact=1.0)\n\ndirectives_list_parametric = [\n    update_jacobi,\n    starting_beta,\n    beta_schedule,\n    target_misfit,\n]","key":"WnvQGF8FTo"},{"type":"output","id":"_ECUts1zRmrLWBAObeNwX","data":[],"key":"Zp1nHUelSA"}],"key":"vqriiyNL7J"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define and Run Inversion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eOBZlwCzMW"}],"identifier":"define-and-run-inversion","label":"Define and Run Inversion","html_id":"define-and-run-inversion","implicit":true,"key":"Mn3WMQk0Qi"}],"key":"VqydCzxcIT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:51.816356Z","iopub.status.busy":"2025-05-23T17:19:51.815980Z","iopub.status.idle":"2025-05-23T17:19:55.788158Z","shell.execute_reply":"2025-05-23T17:19:55.787512Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"inv_parametric = inversion.BaseInversion(\n    inv_prob_parametric, directives_list_parametric\n)\nrecovered_model_parametric = inv_parametric.run(starting_parametric_model)","key":"xaCcdLtVG7"},{"type":"output","id":"acMtk5HJQ6CsJnFmiBiwZ","data":[{"name":"stdout","output_type":"stream","text":"\nRunning inversion with SimPEG v0.24.0\n\n                    simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.\n                    ***Done using the default solver Pardiso and no solver_opts.***\n                    \nmodel has any nan: 0\n============================ Inexact Gauss Newton ============================\n  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment   \n-----------------------------------------------------------------------------\nx0 has any nan: 0\n   0  3.19e+03  2.87e+02  0.00e+00  2.87e+02    6.58e+02      0              \n"},{"name":"stdout","output_type":"stream","text":"   1  3.19e+03  1.07e+02  1.82e-02  1.65e+02    7.93e+01      0              \n   2  3.19e+03  9.91e+01  2.03e-02  1.64e+02    1.47e+01      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   3  1.60e+03  9.80e+01  2.07e-02  1.31e+02    2.05e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   4  1.60e+03  6.08e+01  3.67e-02  1.19e+02    1.42e+01      0              \n   5  1.60e+03  5.92e+01  3.77e-02  1.19e+02    3.11e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   6  7.99e+02  5.90e+01  3.78e-02  8.92e+01    1.57e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"   7  7.99e+02  3.60e+01  5.77e-02  8.21e+01    6.20e+00      0              \n"},{"name":"stdout","output_type":"stream","text":"   8  7.99e+02  3.53e+01  5.86e-02  8.21e+01    3.86e-01      0   Skip BFGS  \n   9  3.99e+02  3.52e+01  5.86e-02  5.86e+01    1.16e+02      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  10  3.99e+02  2.14e+01  8.25e-02  5.44e+01    8.18e+00      0              \n  11  3.99e+02  2.10e+01  8.35e-02  5.44e+01    1.18e+00      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"  12  2.00e+02  2.10e+01  8.36e-02  3.77e+01    8.00e+01      0   Skip BFGS  \n  13  2.00e+02  1.33e+01  1.10e-01  3.52e+01    7.79e+00      0              \n"},{"name":"stdout","output_type":"stream","text":"  14  2.00e+02  1.31e+01  1.11e-01  3.52e+01    1.00e+00      0   Skip BFGS  \n  15  9.98e+01  1.30e+01  1.11e-01  2.41e+01    5.05e+01      0   Skip BFGS  \n"},{"name":"stdout","output_type":"stream","text":"------------------------- STOP! -------------------------\n1 : |fc-fOld| = 0.0000e+00 \u003c= tolF*(1+|f0|) = 2.8794e+01\n1 : |xc-x_last| = 8.4882e-02 \u003c= tolX*(1+|x0|) = 6.7086e-01\n0 : |proj(x-g)-x|    = 5.0545e+01 \u003c= tolG          = 1.0000e-01\n0 : |proj(x-g)-x|    = 5.0545e+01 \u003c= 1e3*eps       = 1.0000e-02\n0 : maxIter   =     100    \u003c= iter          =     16\n------------------------- DONE! -------------------------\n"}],"key":"ntEPCDMJXv"}],"key":"KBuUkFbHAc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Misfit and Recovered Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pZnxF6tXaM"}],"identifier":"data-misfit-and-recovered-model","label":"Data Misfit and Recovered Model","html_id":"data-misfit-and-recovered-model-1","implicit":true,"key":"pwf7CILubo"}],"key":"ppLWym38uo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:55.791741Z","iopub.status.busy":"2025-05-23T17:19:55.791487Z","iopub.status.idle":"2025-05-23T17:19:56.500406Z","shell.execute_reply":"2025-05-23T17:19:56.499456Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"dpred_parametric = simulation_parametric.dpred(recovered_model_parametric)\n\nfig = plt.figure(figsize=(10, 5))\nax = [fig.add_axes([0.1 + ii * 0.5, 0.1, 0.37, 0.85]) for ii in range(2)]\nfor ii in range(2):\n    ax[ii].loglog(frequencies, np.abs(dobs[ii::2]), \"k-o\", lw=2)\n    ax[ii].loglog(frequencies, np.abs(dpred_L2[ii::2]), \"b-o\", lw=2)\n    ax[ii].loglog(frequencies, np.abs(dpred_irls[ii::2]), \"r-o\", lw=2)\n    ax[ii].loglog(frequencies, np.abs(dpred_parametric[ii::2]), \"g-o\", lw=2)\n    ax[ii].grid(which=\"both\")\n    ax[ii].set_xlabel(\"Frequency (Hz)\")\n    ax[ii].set_ylabel(\"|Hs/Hp| (ppm)\")\n    ax[ii].legend(\n        [\n            \"True Sounding\",\n            \"Predicted (L2-model)\",\n            \"Predicted (IRLS)\",\n            \"Predicted (Parametric)\",\n        ]\n    )\n    if ii == 1:\n        ax[ii].set_ylabel(\"\")\n\nax[0].set_title(\"Real Component\")\nax[1].set_title(\"Imaginary Component\")\nplt.show()","key":"EBNjMhzlIy"},{"type":"output","id":"Kv0W-p77qfRqGc6GZI0m_","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e878dd00b45d89c0bcc877ad2da01b98","path":"/user-tutorials/build/e878dd00b45d89c0bcc877ad2da01b98.png"},"text/plain":{"content":"\u003cFigure size 1000x500 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"C0HZraPWDO"}],"key":"M4SqXrTasf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-05-23T17:19:56.504366Z","iopub.status.busy":"2025-05-23T17:19:56.503941Z","iopub.status.idle":"2025-05-23T17:19:56.764099Z","shell.execute_reply":"2025-05-23T17:19:56.763392Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(6, 6))\n\nax1 = fig.add_axes([0.2, 0.15, 0.7, 0.7])\nplot_1d_layer_model(true_layers, true_conductivities, ax=ax1, color=\"k\")\nplot_1d_layer_model(\n    layer_thicknesses, log_conductivity_map * recovered_model_L2, ax=ax1, color=\"b\"\n)\nplot_1d_layer_model(\n    layer_thicknesses, log_conductivity_map * recovered_model_irls, ax=ax1, color=\"r\"\n)\nplot_1d_layer_model(\n    log_thicknesses_map * recovered_model_parametric,\n    1 / (log_resistivity_map * recovered_model_parametric),\n    ax=ax1,\n    color=\"g\",\n)\nax1.grid()\nax1.set_xlabel(r\"Resistivity ($\\Omega m$)\")\nx_min, x_max = true_conductivities.min(), true_conductivities.max()\nax1.set_xlim(0.9 * x_min, 2 * x_max)\nax1.set_ylim([np.sum(layer_thicknesses), 0])\nax1.legend([\"True Model\", \"L2 Model\", \"IRLS Model\", \"Parametric Model\"])\nplt.show()","key":"tITSoC0AIJ"},{"type":"output","id":"I-euQakADQVKKXKk94L2Y","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2fcdf8d50de2e03b318b2dec6ad6be45","path":"/user-tutorials/build/2fcdf8d50de2e03b318b2dec6ad6be45.png"},"text/plain":{"content":"\u003cFigure size 600x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"ySR8Pgjq4q"}],"key":"U4v0jr6Jct"}],"key":"Wdf5ixOxeb"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","url":"/fwd-fdem-1d","group":"SimPEG User Tutorials"},"next":{"title":"Time-Domain Electromagnetics","url":"/tdem-index","group":"SimPEG User Tutorials"}}},"domain":"http://localhost:3000"},"project":{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"SimPEG User Tutorials","title":"SimPEG User Tutorials","description":"SimPEG user tutorials","authors":[{"id":"devincowan","nameParsed":{"literal":"Devin Cowan","given":"Devin","family":"Cowan"},"name":"Devin Cowan","orcid":"0000-0002-0089-402X","roles":["Writing – original draft","Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"lindseyheagy","nameParsed":{"literal":"Lindsey Heagy","given":"Lindsey","family":"Heagy"},"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","roles":["Supervision","Project administration","Software"],"affiliations":["ubc"]},{"id":"santisoler","nameParsed":{"literal":"Santiago Soler","given":"Santiago","family":"Soler"},"name":"Santiago Soler","orcid":"0000-0001-9202-5317","roles":["Writing – review \u0026 editing","Software"],"affiliations":["ubc"]},{"id":"thibautastic","nameParsed":{"literal":"Thibaut Astic","given":"Thibaut","family":"Astic"},"name":"Thibaut Astic","roles":["Writing – original draft"],"affiliations":["kobold"]}],"github":"https://github.com/simpeg/user-tutorials","keywords":["geophysics","inversions","python","open-source"],"affiliations":[{"id":"ubc","name":"University of British Columbia","department":"Department of Earth, Ocean and Atmospheric Sciences","address":"2020 – 2207 Main Mall","city":"Vancouver","state":"British Columbia","postal_code":"V6T 1Z4","country":"Canada","isni":"0000 0001 2288 9830","ror":"https://ror.org/03rmrcq20","phone":"604 822 2449"},{"id":"kobold","name":"Kobold Metals"}],"references":{"python":{"url":"https://docs.python.org/3"},"numpy":{"url":"https://numpy.org/doc/stable"},"scipy":{"url":"https://docs.scipy.org/doc/scipy"},"matplotlib":{"url":"https://matplotlib.org/stable"},"discretize":{"url":"https://discretize.simpeg.xyz/en/main"},"simpeg":{"url":"https://docs.simpeg.xyz/latest"},"geoana":{"url":"https://geoana.simpeg.xyz"},"sphinx":{"url":"https://www.sphinx-doc.org/en/master"}},"toc":[{"file":"index.md"},{"children":[{"file":"notebooks/03-gravity/fwd_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/fwd_gravity_gradiometry_3d.ipynb"},{"file":"notebooks/03-gravity/inv_gravity_anomaly_3d.ipynb"},{"file":"notebooks/03-gravity/weighting_strategies.ipynb"}],"file":"notebooks/gravity_index.md"},{"children":[{"file":"notebooks/04-magnetics/fwd_magnetics_induced_3d.ipynb"},{"file":"notebooks/04-magnetics/fwd_magnetics_mvi_3d.ipynb"},{"file":"notebooks/04-magnetics/inv_magnetics_induced_3d.ipynb"}],"file":"notebooks/magnetics_index.md"},{"children":[{"file":"notebooks/05-dcr/fwd_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/fwd_dcr_3d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_1d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_2d.ipynb"},{"file":"notebooks/05-dcr/inv_dcr_3d.ipynb"}],"file":"notebooks/dcr_index.md"},{"children":[{"file":"notebooks/06-ip/fwd_ip_2d.ipynb"},{"file":"notebooks/06-ip/fwd_ip_3d.ipynb"},{"file":"notebooks/06-ip/inv_ip_2d.ipynb"},{"file":"notebooks/06-ip/inv_ip_3d.ipynb"}],"file":"notebooks/ip_index.md"},{"children":[{"file":"notebooks/07-fdem/fwd_fdem_1d.ipynb"},{"file":"notebooks/07-fdem/inv_fdem_1d.ipynb"}],"file":"notebooks/fdem_index.md"},{"children":[{"file":"notebooks/08-tdem/fwd_tdem_1d.ipynb"},{"file":"notebooks/08-tdem/fwd_tdem_fundamentals.ipynb"},{"file":"notebooks/08-tdem/fwd_utem_3d.ipynb"},{"file":"notebooks/08-tdem/inv_tdem_1d.ipynb"}],"file":"notebooks/tdem_index.md"},{"children":[{"file":"notebooks/11-joint-inversion/plot_inv_3_cross_gradient_pf.ipynb"}],"title":"Joint Inversion"},{"children":[{"file":"notebooks/12-pgi-inversion/plot_inv_1_joint_pf_pgi_full_info_tutorial.ipynb"},{"file":"notebooks/12-pgi-inversion/plot_inv_2_joint_pf_pgi_no_info_tutorial.ipynb"}],"title":"PGI Inversion"},{"children":[{"file":"notebooks/contributing/build_website.md"},{"file":"notebooks/contributing/formatting.md"},{"file":"notebooks/contributing/pull_request.md"}],"file":"notebooks/contributing_index.md"}],"thumbnail":"/user-tutorials/build/title_image-68886f325ddc8358e9d024a164a1ff32.png","exports":[],"bibliography":[],"index":"index","pages":[{"slug":"gravity-index","title":"Gravity","description":"","date":"","thumbnail":"/user-tutorials/build/ae6c6ed278992f609070dbcd57643aba.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-gravity-anomaly-3d","title":"3D Forward Simulation of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-gravity-gradiometry-3d","title":"3D Forward Simulation of Gravity Gradiometry Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-gravity-anomaly-3d","title":"3D Inversion of Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"weighting-strategies","title":"Compare weighting strategy with Inversion of surface Gravity Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"magnetics-index","title":"Magnetics","description":"","date":"","thumbnail":"/user-tutorials/build/7a8cefd4894c78a7681713eac224fec3.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-magnetics-induced-3d","title":"3D Forward Simulation of TMI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-magnetics-mvi-3d","title":"3D Forward Simulation of Magnetic Gradiometry Data for Magnetic Vector Models","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-magnetics-induced-3d","title":"3D Inversion of TMI Data to Recover a Susceptibility Model","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dcr-index","title":"Direct Current Resistivity","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-dcr-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-2d","title":"2.5D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-dcr-3d","title":"3D Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-2d","title":"2.5D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-dcr-3d","title":"3D DC Resistivity Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ip-index","title":"Induced Polarization","description":"","date":"","thumbnail":"/user-tutorials/build/dcip_physics-8d4559b672433e1601bc66172392707a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-ip-2d","title":"2.5D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-ip-3d","title":"3D IP Forward Simulation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-2d","title":"2.5D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-ip-3d","title":"3D IP Inversion","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fdem-index","title":"Frequency-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/fem_physics-b20a8415e4b91320ef4ad7428618dc8e.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-fdem-1d","title":"1D Forward Simulation of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-fdem-1d","title":"1D Inversion of Frequency Domain EM Data for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"tdem-index","title":"Time-Domain Electromagnetics","description":"","date":"","thumbnail":"/user-tutorials/build/tem_physics-c2ca121d6f61dfddffd0774055d97fd1.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fwd-tdem-1d","title":"1D Forward Simulation for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-tdem-fundamentals","title":"Fundamentals of Finite Volume for TDEM Simulations","description":"","date":"","thumbnail":"/user-tutorials/build/diffusion_distance-e02475ecc0ce663d7f94212913476ba8.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fwd-utem-3d","title":"3D Forward Simulation for On-Time Large-Loop Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inv-tdem-1d","title":"1D Inversion for a Single Sounding","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Joint Inversion"},{"slug":"plot-inv-3-cross-gradient-pf","title":"Cross-gradient Joint Inversion of Gravity and Magnetic Anomaly Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"PGI Inversion"},{"slug":"plot-inv-1-joint-pf-pgi-full-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh using full petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"plot-inv-2-joint-pf-pgi-no-info-tutorial","title":"Joint PGI of Gravity + Magnetic on an Octree mesh without petrophysical information","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"contributing-index","title":"Contributing to User Tutorials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"build-website","title":"Building the User Tutorials Website Locally","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"formatting","title":"Tutorial Structure and Formatting Requirements","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pull-request","title":"Review Process and GitHub Pull Requests","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/user-tutorials/build/manifest-ED236704.js";
import * as route0 from "/user-tutorials/build/root-ZJOPFBMV.js";
import * as route1 from "/user-tutorials/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/user-tutorials/build/entry.client-UNPC4GT3.js");</script></body></html>